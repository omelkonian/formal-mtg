<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Types</title><link rel="stylesheet" href="css/Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="Types.html" class="Module">Types</a> <a id="14" class="Keyword">where</a>

<a id="21" class="Keyword">open</a> <a id="26" class="Keyword">import</a> <a id="33" href="Prelude.Init.html" class="Module">Prelude.Init</a>
<a id="46" class="Keyword">open</a> <a id="51" href="Prelude.Init.html#35" class="Module">SetAsType</a>
<a id="61" class="Keyword">open</a> <a id="66" class="Keyword">import</a> <a id="73" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="87" class="Keyword">open</a> <a id="92" class="Keyword">import</a> <a id="99" href="Prelude.Semigroup.html" class="Module">Prelude.Semigroup</a>
<a id="117" class="Keyword">open</a> <a id="122" class="Keyword">import</a> <a id="129" href="Prelude.Maps.Concrete.html" class="Module">Prelude.Maps.Concrete</a>
<a id="151" class="Keyword">import</a> <a id="158" href="Prelude.Sets.Concrete.html" class="Module">Prelude.Sets.Concrete</a> <a id="180" class="Symbol">as</a> <a id="183" class="Module">S</a>
<a id="185" class="Keyword">open</a> <a id="190" class="Keyword">import</a> <a id="197" href="Prelude.DecLists.html" class="Module">Prelude.DecLists</a>
<a id="214" class="Keyword">open</a> <a id="219" class="Keyword">import</a> <a id="226" href="Prelude.FromList.html" class="Module">Prelude.FromList</a>
<a id="243" class="Keyword">open</a> <a id="248" class="Keyword">import</a> <a id="255" href="Prelude.ToList.html" class="Module">Prelude.ToList</a>
<a id="270" class="Keyword">open</a> <a id="275" class="Keyword">import</a> <a id="282" href="Prelude.Nary.html" class="Module">Prelude.Nary</a>
<a id="295" class="Keyword">open</a> <a id="300" class="Keyword">import</a> <a id="307" href="Prelude.Functor.html" class="Module">Prelude.Functor</a>
<a id="323" class="Keyword">open</a> <a id="328" class="Keyword">import</a> <a id="335" href="Prelude.Decidable.html" class="Module">Prelude.Decidable</a>
<a id="353" class="Keyword">open</a> <a id="358" class="Keyword">import</a> <a id="365" href="Prelude.Ord.html" class="Module">Prelude.Ord</a>
<a id="377" class="Keyword">open</a> <a id="382" class="Keyword">import</a> <a id="389" href="Prelude.Monoid.html" class="Module">Prelude.Monoid</a>
<a id="404" class="Keyword">open</a> <a id="409" class="Keyword">import</a> <a id="416" href="Prelude.InferenceRules.html" class="Module">Prelude.InferenceRules</a>
<a id="439" class="Keyword">open</a> <a id="444" class="Keyword">import</a> <a id="451" href="Prelude.Closures.html" class="Module">Prelude.Closures</a>
<a id="468" class="Keyword">open</a> <a id="473" class="Keyword">import</a> <a id="480" href="Prelude.Lenses.html" class="Module">Prelude.Lenses</a>
<a id="495" class="Keyword">open</a> <a id="500" class="Keyword">import</a> <a id="507" href="Prelude.Default.html" class="Module">Prelude.Default</a> <a id="523" class="Keyword">hiding</a> <a id="530" class="Symbol">(</a><a id="531" href="Prelude.Default.html#1424" class="Function">Default-→</a><a id="540" class="Symbol">)</a>
<a id="542" class="Keyword">open</a> <a id="547" class="Keyword">import</a> <a id="554" href="Prelude.Lists.html" class="Module">Prelude.Lists</a> <a id="568" class="Keyword">hiding</a> <a id="575" class="Symbol">(</a><a id="576" href="Prelude.Lists.Mappings.html#650" class="Function Operator">_↦_</a><a id="579" class="Symbol">)</a>
<a id="581" class="Keyword">open</a> <a id="586" class="Keyword">import</a> <a id="593" href="Prelude.Membership.html" class="Module">Prelude.Membership</a>
<a id="612" class="Keyword">open</a> <a id="617" class="Keyword">import</a> <a id="624" href="Prelude.Show.html" class="Module">Prelude.Show</a>


<a id="639" class="Keyword">data</a> <a id="Colour"></a><a id="644" href="Types.html#644" class="Datatype">Colour</a> <a id="651" class="Symbol">:</a> <a id="653" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="658" class="Keyword">where</a>
  <a id="Colour.Red"></a><a id="666" href="Types.html#666" class="InductiveConstructor">Red</a> <a id="Colour.Green"></a><a id="670" href="Types.html#670" class="InductiveConstructor">Green</a> <a id="Colour.White"></a><a id="676" href="Types.html#676" class="InductiveConstructor">White</a> <a id="Colour.Blue"></a><a id="682" href="Types.html#682" class="InductiveConstructor">Blue</a> <a id="Colour.Black"></a><a id="687" href="Types.html#687" class="InductiveConstructor">Black</a> <a id="693" class="Symbol">:</a> <a id="695" href="Types.html#644" class="Datatype">Colour</a>
<a id="702" class="Keyword">unquoteDecl</a> <a id="DecEq-Colour"></a><a id="714" href="Types.html#714" class="Function">DecEq-Colour</a> <a id="727" class="Symbol">=</a> <a id="729" href="Prelude.Generics.html#9852" class="Function">DERIVE</a> <a id="736" href="Prelude.DecEq.Core.html#97" class="Record">DecEq</a> <a id="742" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="744" class="Keyword">quote</a> <a id="750" href="Types.html#644" class="Datatype">Colour</a> <a id="757" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="759" href="Types.html#714" class="Function">DecEq-Colour</a> <a id="772" href="Data.List.Base.html#5025" class="Function Operator">]</a>

<a id="Colour⁇"></a><a id="775" href="Types.html#775" class="Function">Colour⁇</a> <a id="783" class="Symbol">=</a> <a id="785" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="791" href="Types.html#644" class="Datatype">Colour</a>

<a id="799" class="Keyword">pattern</a> <a id="colorless"></a><a id="807" href="Types.html#807" class="InductiveConstructor">colorless</a> <a id="817" class="Symbol">=</a> <a id="819" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
<a id="827" class="Keyword">pattern</a> <a id="colored"></a><a id="835" href="Types.html#835" class="InductiveConstructor">colored</a> <a id="843" href="Types.html#852" class="Bound">x</a> <a id="845" class="Symbol">=</a> <a id="847" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="852" href="Types.html#852" class="Bound">x</a>
<a id="854" class="Keyword">pattern</a> <a id="R"></a><a id="862" href="Types.html#862" class="InductiveConstructor">R</a> <a id="864" class="Symbol">=</a> <a id="866" href="Types.html#835" class="InductiveConstructor">colored</a> <a id="874" href="Types.html#666" class="InductiveConstructor">Red</a>
<a id="878" class="Keyword">pattern</a> <a id="G"></a><a id="886" href="Types.html#886" class="InductiveConstructor">G</a> <a id="888" class="Symbol">=</a> <a id="890" href="Types.html#835" class="InductiveConstructor">colored</a> <a id="898" href="Types.html#670" class="InductiveConstructor">Green</a>
<a id="904" class="Keyword">pattern</a> <a id="W"></a><a id="912" href="Types.html#912" class="InductiveConstructor">W</a> <a id="914" class="Symbol">=</a> <a id="916" href="Types.html#835" class="InductiveConstructor">colored</a> <a id="924" href="Types.html#676" class="InductiveConstructor">White</a>
<a id="930" class="Keyword">pattern</a> <a id="U"></a><a id="938" href="Types.html#938" class="InductiveConstructor">U</a> <a id="940" class="Symbol">=</a> <a id="942" href="Types.html#835" class="InductiveConstructor">colored</a> <a id="950" href="Types.html#682" class="InductiveConstructor">Blue</a>
<a id="955" class="Keyword">pattern</a> <a id="B"></a><a id="963" href="Types.html#963" class="InductiveConstructor">B</a> <a id="965" class="Symbol">=</a> <a id="967" href="Types.html#835" class="InductiveConstructor">colored</a> <a id="975" href="Types.html#687" class="InductiveConstructor">Black</a>
<a id="981" class="Keyword">pattern</a> <a id="C"></a><a id="989" href="Types.html#989" class="InductiveConstructor">C</a> <a id="991" class="Symbol">=</a> <a id="993" href="Types.html#807" class="InductiveConstructor">colorless</a>

<a id="Mana"></a><a id="1004" href="Types.html#1004" class="Function">Mana</a> <a id="1009" class="Symbol">=</a> <a id="1011" href="Prelude.Maps.Concrete.html#517" class="Record">Map⟨</a> <a id="1016" href="Types.html#775" class="Function">Colour⁇</a> <a id="1024" href="Prelude.Maps.Concrete.html#517" class="Record">↦</a> <a id="1026" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1028" href="Prelude.Maps.Concrete.html#517" class="Record">⟩</a>
<a id="ManaPool"></a><a id="1030" href="Types.html#1030" class="Function">ManaPool</a> <a id="1039" class="Symbol">=</a> <a id="1041" href="Types.html#1004" class="Function">Mana</a>
<a id="ManaCost"></a><a id="1046" href="Types.html#1046" class="Function">ManaCost</a> <a id="1055" class="Symbol">=</a> <a id="1057" href="Types.html#1004" class="Function">Mana</a>
<a id="CardCost"></a><a id="1062" href="Types.html#1062" class="Function">CardCost</a> <a id="1071" class="Symbol">=</a> <a id="1073" href="Prelude.Sets.Concrete.html#933" class="Record">S.Set⟨</a> <a id="1080" href="Types.html#1046" class="Function">ManaCost</a> <a id="1089" href="Prelude.Sets.Concrete.html#933" class="Record">⟩</a>
<a id="ManaCostChoices"></a><a id="1091" href="Types.html#1091" class="Function">ManaCostChoices</a> <a id="1107" class="Symbol">=</a> <a id="1109" href="Prelude.Maps.Concrete.html#517" class="Record">Map⟨</a> <a id="1114" href="Prelude.Sets.Concrete.html#7514" class="Record">S.Set⁺⟨</a> <a id="1122" href="Types.html#775" class="Function">Colour⁇</a> <a id="1130" href="Prelude.Sets.Concrete.html#7514" class="Record">⟩</a> <a id="1132" href="Prelude.Maps.Concrete.html#517" class="Record">↦</a> <a id="1134" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1136" href="Prelude.Maps.Concrete.html#517" class="Record">⟩</a>

<a id="1139" class="Keyword">instance</a> <a id="1148" href="Types.html#1148" class="Function">_</a> <a id="1150" class="Symbol">=</a> <a id="1152" href="Prelude.Semigroup.html#2075" class="Function">Semigroup-ℕ-+</a>
<a id="1166" class="Keyword">instance</a> <a id="1175" href="Types.html#1175" class="Function">_</a> <a id="1177" class="Symbol">=</a> <a id="1179" href="Prelude.Monoid.html#1313" class="Function">Monoid-ℕ-+</a>

<a id="1191" class="Keyword">infix</a> <a id="1197" class="Number">10</a> <a id="1200" href="Types.html#1204" class="Function Operator">_↦_</a>
<a id="_↦_"></a><a id="1204" href="Types.html#1204" class="Function Operator">_↦_</a> <a id="1208" class="Symbol">=</a> <a id="1210" class="Symbol">(</a><a id="1211" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="1217" href="Types.html#644" class="Datatype">Colour</a> <a id="1224" class="Symbol">→</a> <a id="1226" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1228" class="Symbol">→</a> <a id="1230" href="Types.html#1004" class="Function">Mana</a><a id="1234" class="Symbol">)</a> <a id="1236" href="Function.Base.html#4562" class="Function Operator">∋</a> <a id="1238" href="Prelude.Maps.Concrete.html#930" class="Function">singleton</a> <a id="1248" href="Function.Base.html#1219" class="Function Operator">∘₂</a> <a id="1251" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a>

<a id="calculateCost"></a><a id="1256" href="Types.html#1256" class="Function">calculateCost</a> <a id="1270" class="Symbol">:</a> <a id="1272" href="Types.html#1091" class="Function">ManaCostChoices</a> <a id="1288" class="Symbol">→</a> <a id="1290" href="Types.html#1062" class="Function">CardCost</a>
<a id="1299" href="Types.html#1256" class="Function">calculateCost</a> <a id="1313" class="Symbol">=</a> <a id="1315" href="Types.html#1503" class="Function">go∗</a> <a id="1319" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1321" href="Prelude.ToList.html#173" class="Function Operator">_∙toList</a>
  <a id="1332" class="Keyword">where</a>
    <a id="1342" href="Types.html#1342" class="Function">go</a> <a id="1345" class="Symbol">:</a> <a id="1347" href="Data.List.NonEmpty.Base.html#1079" class="Record">List⁺</a> <a id="1353" href="Types.html#775" class="Function">Colour⁇</a> <a id="1361" class="Symbol">→</a> <a id="1363" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1365" class="Symbol">→</a> <a id="1367" href="Types.html#1062" class="Function">CardCost</a>
    <a id="1380" href="Types.html#1342" class="Function">go</a> <a id="1383" class="Symbol">(</a><a id="1384" href="Types.html#1384" class="Bound">x</a> <a id="1386" href="Data.List.NonEmpty.Base.html#1125" class="InductiveConstructor Operator">∷</a> <a id="1388" href="Types.html#1388" class="Bound">xs</a><a id="1390" class="Symbol">)</a> <a id="1392" href="Types.html#1392" class="Bound">n</a> <a id="1394" class="Keyword">with</a> <a id="1399" href="Types.html#1388" class="Bound">xs</a>
    <a id="1406" class="Symbol">...</a> <a id="1410" class="Symbol">|</a> <a id="1412" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>     <a id="1419" class="Symbol">=</a> <a id="1421" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="1433" class="Symbol">(</a><a id="1434" class="Bound">x</a> <a id="1436" href="Types.html#1204" class="Function Operator">↦</a> <a id="1438" class="Bound">n</a><a id="1439" class="Symbol">)</a>
    <a id="1445" class="Symbol">...</a> <a id="1449" class="Symbol">|</a> <a id="1451" href="Types.html#1451" class="Bound">y</a> <a id="1453" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1455" href="Types.html#1455" class="Bound">ys</a> <a id="1458" class="Symbol">=</a> <a id="1460" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="1472" class="Symbol">(</a><a id="1473" class="Bound">x</a> <a id="1475" href="Types.html#1204" class="Function Operator">↦</a> <a id="1477" class="Bound">n</a><a id="1478" class="Symbol">)</a> <a id="1480" href="Prelude.Sets.Concrete.html#2693" class="Function Operator">S.∪</a> <a id="1484" href="Types.html#1342" class="Function">go</a> <a id="1487" class="Symbol">(</a><a id="1488" href="Types.html#1451" class="Bound">y</a> <a id="1490" href="Data.List.NonEmpty.Base.html#1125" class="InductiveConstructor Operator">∷</a> <a id="1492" href="Types.html#1455" class="Bound">ys</a><a id="1494" class="Symbol">)</a> <a id="1496" class="Bound">n</a>

    <a id="1503" href="Types.html#1503" class="Function">go∗</a> <a id="1507" class="Symbol">:</a> <a id="1509" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1514" class="Symbol">(</a><a id="1515" href="Prelude.Sets.Concrete.html#7514" class="Record">S.Set⁺⟨</a> <a id="1523" href="Types.html#775" class="Function">Colour⁇</a> <a id="1531" href="Prelude.Sets.Concrete.html#7514" class="Record">⟩</a> <a id="1533" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1535" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1536" class="Symbol">)</a> <a id="1538" class="Symbol">→</a> <a id="1540" href="Types.html#1062" class="Function">CardCost</a>
    <a id="1553" href="Types.html#1503" class="Function">go∗</a> <a id="1557" class="Symbol">=</a> <a id="1559" class="Symbol">λ</a> <a id="1561" class="Keyword">where</a>
      <a id="1573" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="1576" class="Symbol">→</a> <a id="1578" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="1590" class="Symbol">(</a><a id="1591" href="Types.html#989" class="InductiveConstructor">C</a> <a id="1593" href="Types.html#1204" class="Function Operator">↦</a> <a id="1595" class="Number">0</a><a id="1596" class="Symbol">)</a>
      <a id="1604" class="Symbol">((</a><a id="1606" href="Types.html#1606" class="Bound">s⁺</a> <a id="1609" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1611" href="Types.html#1611" class="Bound">n</a><a id="1612" class="Symbol">)</a> <a id="1614" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1616" href="Types.html#1616" class="Bound">kvs</a><a id="1619" class="Symbol">)</a> <a id="1621" class="Symbol">→</a> <a id="1623" href="Prelude.FromList.html#155" class="Field">fromList</a>
                       <a id="1655" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="1657" href="Data.List.Base.html#4394" class="Function">L.concat</a>
                       <a id="1689" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="1691" class="Symbol">(</a><a id="1692" href="Types.html#1792" class="Function Operator">_⊗</a> <a id="1695" class="Symbol">(</a><a id="1696" href="Types.html#1503" class="Function">go∗</a> <a id="1700" href="Types.html#1616" class="Bound">kvs</a> <a id="1704" href="Prelude.ToList.html#173" class="Function Operator">∙toList</a><a id="1711" class="Symbol">))</a>
                     <a id="1735" href="Prelude.Functor.html#301" class="Field Operator">&lt;$&gt;</a> <a id="1739" href="Types.html#1342" class="Function">go</a> <a id="1742" class="Symbol">(</a><a id="1743" href="Prelude.Sets.Concrete.html#7984" class="Function">S.toList&#39;⁺</a> <a id="1754" href="Types.html#1606" class="Bound">s⁺</a><a id="1756" class="Symbol">)</a> <a id="1758" href="Types.html#1611" class="Bound">n</a> <a id="1760" href="Prelude.ToList.html#173" class="Function Operator">∙toList</a>
        <a id="1776" class="Keyword">where</a>
          <a id="1792" href="Types.html#1792" class="Function Operator">_⊗_</a> <a id="1796" class="Symbol">:</a> <a id="1798" href="Types.html#1046" class="Function">ManaCost</a> <a id="1807" class="Symbol">→</a> <a id="1809" href="Algebra.Core.html#475" class="Function">Op₁</a> <a id="1813" class="Symbol">(</a><a id="1814" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1819" href="Types.html#1046" class="Function">ManaCost</a><a id="1827" class="Symbol">)</a>
          <a id="1839" href="Types.html#1839" class="Bound">m</a> <a id="1841" href="Types.html#1792" class="Function Operator">⊗</a> <a id="1843" href="Types.html#1843" class="Bound">cur</a> <a id="1847" class="Symbol">=</a> <a id="1849" href="Data.List.Base.html#1544" class="Function">map</a> <a id="1853" class="Symbol">(</a><a id="1854" href="Prelude.Semigroup.html#158" class="Field Operator">_◇</a> <a id="1857" href="Types.html#1839" class="Bound">m</a><a id="1858" class="Symbol">)</a> <a id="1860" href="Types.html#1843" class="Bound">cur</a>

<a id="1865" class="Keyword">private</a>
  <a id="1875" href="Types.html#1875" class="Function">_</a> <a id="1877" class="Symbol">:</a> <a id="1879" href="Types.html#1004" class="Function">Mana</a> <a id="1884" class="Comment">-- 0</a>
  <a id="1891" class="Symbol">_</a> <a id="1893" class="Symbol">=</a> <a id="1895" href="Prelude.Maps.Concrete.html#906" class="Function">∅</a>

  <a id="m"></a><a id="1900" href="Types.html#1900" class="Function">m</a> <a id="1902" class="Symbol">:</a> <a id="1904" href="Types.html#1004" class="Function">Mana</a>
  <a id="1911" href="Types.html#1900" class="Function">m</a> <a id="1913" class="Symbol">=</a> <a id="1915" href="Types.html#989" class="InductiveConstructor">C</a> <a id="1917" href="Types.html#1204" class="Function Operator">↦</a> <a id="1919" class="Number">2</a> <a id="1921" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="1923" href="Types.html#912" class="InductiveConstructor">W</a> <a id="1925" href="Types.html#1204" class="Function Operator">↦</a> <a id="1927" class="Number">2</a>

  <a id="m′"></a><a id="1932" href="Types.html#1932" class="Function">m′</a> <a id="1935" class="Symbol">:</a> <a id="1937" href="Types.html#1004" class="Function">Mana</a>
  <a id="1944" href="Types.html#1932" class="Function">m′</a> <a id="1947" class="Symbol">=</a> <a id="1949" href="Types.html#989" class="InductiveConstructor">C</a> <a id="1951" href="Types.html#1204" class="Function Operator">↦</a> <a id="1953" class="Number">4</a> <a id="1955" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="1957" href="Types.html#912" class="InductiveConstructor">W</a> <a id="1959" href="Types.html#1204" class="Function Operator">↦</a> <a id="1961" class="Number">2</a>

  <a id="1966" href="Types.html#1966" class="Function">_</a> <a id="1968" class="Symbol">:</a> <a id="1970" href="Types.html#1900" class="Function">m</a> <a id="1972" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="1974" href="Types.html#1932" class="Function">m′</a>
    <a id="1981" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1983" href="Types.html#912" class="InductiveConstructor">W</a> <a id="1985" href="Types.html#1204" class="Function Operator">↦</a> <a id="1987" class="Number">4</a> <a id="1989" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="1991" href="Types.html#989" class="InductiveConstructor">C</a> <a id="1993" href="Types.html#1204" class="Function Operator">↦</a> <a id="1995" class="Number">6</a>
  <a id="1999" class="Symbol">_</a> <a id="2001" class="Symbol">=</a> <a id="2003" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

  <a id="2011" class="Comment">-- this is *not* setoid equality</a>
  <a id="2046" href="Types.html#2046" class="Function">_</a> <a id="2048" class="Symbol">:</a> <a id="2050" href="Types.html#1900" class="Function">m</a> <a id="2052" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2054" href="Types.html#1932" class="Function">m′</a>
    <a id="2061" href="Relation.Binary.PropositionalEquality.Core.html#830" class="Function Operator">≢</a> <a id="2063" href="Types.html#989" class="InductiveConstructor">C</a> <a id="2065" href="Types.html#1204" class="Function Operator">↦</a> <a id="2067" class="Number">6</a> <a id="2069" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2071" href="Types.html#912" class="InductiveConstructor">W</a> <a id="2073" href="Types.html#1204" class="Function Operator">↦</a> <a id="2075" class="Number">4</a>
  <a id="2079" class="Symbol">_</a> <a id="2081" class="Symbol">=</a> <a id="2083" class="Symbol">λ</a> <a id="2085" class="Symbol">()</a>

  <a id="2091" class="Comment">-- this *is* setoid equality</a>
  <a id="2122" href="Types.html#2122" class="Function">_</a> <a id="2124" class="Symbol">:</a> <a id="2126" class="Symbol">(</a><a id="2127" href="Types.html#1900" class="Function">m</a> <a id="2129" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2131" href="Types.html#1932" class="Function">m′</a><a id="2133" class="Symbol">)</a>
   <a id="2138" href="Prelude.Maps.Concrete.html#3647" class="Function Operator">≈ᵐ</a> <a id="2141" class="Symbol">(</a><a id="2142" href="Types.html#989" class="InductiveConstructor">C</a> <a id="2144" href="Types.html#1204" class="Function Operator">↦</a> <a id="2146" class="Number">6</a> <a id="2148" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2150" href="Types.html#912" class="InductiveConstructor">W</a> <a id="2152" href="Types.html#1204" class="Function Operator">↦</a> <a id="2154" class="Number">4</a><a id="2155" class="Symbol">)</a>
  <a id="2159" class="Symbol">_</a> <a id="2161" class="Symbol">=</a> <a id="2163" href="Prelude.Decidable.html#212" class="Function">auto</a>

  <a id="2171" href="Types.html#2171" class="Function">_</a> <a id="2173" class="Symbol">:</a> <a id="2175" href="Types.html#1030" class="Function">ManaPool</a>
  <a id="2186" class="Symbol">_</a> <a id="2188" class="Symbol">=</a> <a id="2190" href="Types.html#989" class="InductiveConstructor">C</a> <a id="2192" href="Types.html#1204" class="Function Operator">↦</a> <a id="2194" class="Number">2</a> <a id="2196" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2198" href="Types.html#912" class="InductiveConstructor">W</a> <a id="2200" href="Types.html#1204" class="Function Operator">↦</a> <a id="2202" class="Number">2</a> <a id="2204" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2206" href="Types.html#862" class="InductiveConstructor">R</a> <a id="2208" href="Types.html#1204" class="Function Operator">↦</a> <a id="2210" class="Number">1</a>

  <a id="1BBB"></a><a id="2215" href="Types.html#2215" class="Function">1BBB</a> <a id="2220" class="Symbol">=</a> <a id="2222" href="Types.html#1046" class="Function">ManaCost</a> <a id="2231" class="Comment">-- 1BBB</a>
    <a id="2243" href="Function.Base.html#4562" class="Function Operator">∋</a> <a id="2245" href="Types.html#989" class="InductiveConstructor">C</a> <a id="2247" href="Types.html#1204" class="Function Operator">↦</a> <a id="2249" class="Number">1</a> <a id="2251" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2253" href="Types.html#963" class="InductiveConstructor">B</a> <a id="2255" href="Types.html#1204" class="Function Operator">↦</a> <a id="2257" class="Number">3</a>
  <a id="2WW"></a><a id="2261" href="Types.html#2261" class="Function">2WW</a> <a id="2265" class="Symbol">=</a> <a id="2267" href="Types.html#1046" class="Function">ManaCost</a> <a id="2276" class="Comment">-- 2WW</a>
    <a id="2287" href="Function.Base.html#4562" class="Function Operator">∋</a> <a id="2289" href="Types.html#989" class="InductiveConstructor">C</a> <a id="2291" href="Types.html#1204" class="Function Operator">↦</a> <a id="2293" class="Number">2</a> <a id="2295" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2297" href="Types.html#912" class="InductiveConstructor">W</a> <a id="2299" href="Types.html#1204" class="Function Operator">↦</a> <a id="2301" class="Number">2</a>
  <a id="2WW/1BBB"></a><a id="2305" href="Types.html#2305" class="Function">2WW/1BBB</a> <a id="2314" class="Symbol">=</a> <a id="2316" href="Types.html#1062" class="Function">CardCost</a> <a id="2325" class="Comment">-- 2WW/1BBB</a>
    <a id="2341" href="Function.Base.html#4562" class="Function Operator">∋</a> <a id="2343" href="Prelude.FromList.html#155" class="Field">fromList</a> <a id="2352" href="Prelude.Nary.html#207" class="Function Operator">⟦</a> <a id="2354" href="Types.html#2261" class="Function">2WW</a> <a id="2358" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2360" href="Types.html#2215" class="Function">1BBB</a> <a id="2365" href="Prelude.Nary.html#207" class="Function Operator">⟧</a>

  <a id="2370" href="Types.html#2370" class="Function">_</a> <a id="2372" class="Symbol">=</a> <a id="2374" href="Types.html#1062" class="Function">CardCost</a> <a id="2383" class="Comment">-- 2WW(R|G) aka 2WWR|2WWG)</a>
    <a id="2414" href="Function.Base.html#4562" class="Function Operator">∋</a> <a id="2416" href="Prelude.FromList.html#155" class="Field">fromList</a>
        <a id="2433" href="Prelude.Nary.html#207" class="Function Operator">⟦</a> <a id="2435" href="Types.html#989" class="InductiveConstructor">C</a> <a id="2437" href="Types.html#1204" class="Function Operator">↦</a> <a id="2439" class="Number">2</a> <a id="2441" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2443" href="Types.html#912" class="InductiveConstructor">W</a> <a id="2445" href="Types.html#1204" class="Function Operator">↦</a> <a id="2447" class="Number">2</a> <a id="2449" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2451" href="Types.html#862" class="InductiveConstructor">R</a> <a id="2453" href="Types.html#1204" class="Function Operator">↦</a> <a id="2455" class="Number">1</a>
        <a id="2465" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2467" href="Types.html#989" class="InductiveConstructor">C</a> <a id="2469" href="Types.html#1204" class="Function Operator">↦</a> <a id="2471" class="Number">2</a> <a id="2473" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2475" href="Types.html#912" class="InductiveConstructor">W</a> <a id="2477" href="Types.html#1204" class="Function Operator">↦</a> <a id="2479" class="Number">2</a> <a id="2481" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2483" href="Types.html#886" class="InductiveConstructor">G</a> <a id="2485" href="Types.html#1204" class="Function Operator">↦</a> <a id="2487" class="Number">1</a>
        <a id="2497" href="Prelude.Nary.html#207" class="Function Operator">⟧</a>

  <a id="2502" href="Types.html#2502" class="Function">_</a> <a id="2504" class="Symbol">=</a> <a id="2506" href="Types.html#1091" class="Function">ManaCostChoices</a> <a id="2522" class="Comment">-- 2WW(R|G)</a>
    <a id="2538" href="Function.Base.html#4562" class="Function Operator">∋</a> <a id="2540" href="Prelude.Maps.Concrete.html#930" class="Function">singleton</a> <a id="2550" class="Symbol">(</a><a id="2551" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="2563" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="2565" href="Types.html#989" class="InductiveConstructor">C</a> <a id="2567" href="Data.List.Base.html#5025" class="Function Operator">]</a>     <a id="2573" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2575" class="Number">2</a><a id="2576" class="Symbol">)</a>
    <a id="2582" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2584" href="Prelude.Maps.Concrete.html#930" class="Function">singleton</a> <a id="2594" class="Symbol">(</a><a id="2595" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="2607" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="2609" href="Types.html#912" class="InductiveConstructor">W</a> <a id="2611" href="Data.List.Base.html#5025" class="Function Operator">]</a>     <a id="2617" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2619" class="Number">2</a><a id="2620" class="Symbol">)</a>
    <a id="2626" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2628" href="Prelude.Maps.Concrete.html#930" class="Function">singleton</a> <a id="2638" class="Symbol">(</a><a id="2639" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="2651" href="Prelude.Nary.html#207" class="Function Operator">⟦</a> <a id="2653" href="Types.html#862" class="InductiveConstructor">R</a> <a id="2655" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2657" href="Types.html#886" class="InductiveConstructor">G</a> <a id="2659" href="Prelude.Nary.html#207" class="Function Operator">⟧</a> <a id="2661" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2663" class="Number">1</a><a id="2664" class="Symbol">)</a>

  <a id="2669" href="Types.html#2669" class="Function">_</a> <a id="2671" class="Symbol">:</a> <a id="2673" href="Types.html#1256" class="Function">calculateCost</a> <a id="2687" href="Prelude.Maps.Concrete.html#906" class="Function">∅</a>
    <a id="2693" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2695" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="2707" class="Symbol">(</a><a id="2708" href="Types.html#989" class="InductiveConstructor">C</a> <a id="2710" href="Types.html#1204" class="Function Operator">↦</a> <a id="2712" class="Number">0</a><a id="2713" class="Symbol">)</a>
  <a id="2717" class="Symbol">_</a> <a id="2719" class="Symbol">=</a> <a id="2721" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

  <a id="2729" href="Types.html#2729" class="Function">_</a> <a id="2731" class="Symbol">:</a> <a id="2733" href="Types.html#1256" class="Function">calculateCost</a> <a id="2747" class="Symbol">(</a><a id="2748" href="Prelude.Maps.Concrete.html#930" class="Function">singleton</a> <a id="2758" class="Symbol">(</a><a id="2759" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="2771" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="2773" href="Types.html#989" class="InductiveConstructor">C</a> <a id="2775" href="Data.List.Base.html#5025" class="Function Operator">]</a> <a id="2777" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2779" class="Number">0</a><a id="2780" class="Symbol">))</a>
    <a id="2787" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2789" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="2801" class="Symbol">(</a><a id="2802" href="Types.html#989" class="InductiveConstructor">C</a> <a id="2804" href="Types.html#1204" class="Function Operator">↦</a> <a id="2806" class="Number">0</a><a id="2807" class="Symbol">)</a>
  <a id="2811" class="Symbol">_</a> <a id="2813" class="Symbol">=</a> <a id="2815" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

  <a id="2823" href="Types.html#2823" class="Function">_</a> <a id="2825" class="Symbol">:</a> <a id="2827" href="Types.html#1256" class="Function">calculateCost</a> <a id="2841" class="Symbol">(</a><a id="2842" href="Prelude.Maps.Concrete.html#930" class="Function">singleton</a> <a id="2852" class="Symbol">(</a><a id="2853" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="2865" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="2867" href="Types.html#862" class="InductiveConstructor">R</a> <a id="2869" href="Data.List.Base.html#5025" class="Function Operator">]</a> <a id="2871" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2873" class="Number">1</a><a id="2874" class="Symbol">))</a>
    <a id="2881" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2883" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="2895" class="Symbol">(</a><a id="2896" href="Types.html#989" class="InductiveConstructor">C</a> <a id="2898" href="Types.html#1204" class="Function Operator">↦</a> <a id="2900" class="Number">0</a> <a id="2902" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2904" href="Types.html#862" class="InductiveConstructor">R</a> <a id="2906" href="Types.html#1204" class="Function Operator">↦</a> <a id="2908" class="Number">1</a><a id="2909" class="Symbol">)</a>
  <a id="2913" class="Symbol">_</a> <a id="2915" class="Symbol">=</a> <a id="2917" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

  <a id="2925" href="Types.html#2925" class="Function">_</a> <a id="2927" class="Symbol">:</a> <a id="2929" href="Types.html#1256" class="Function">calculateCost</a> <a id="2943" class="Symbol">(</a><a id="2944" href="Prelude.Maps.Concrete.html#930" class="Function">singleton</a> <a id="2954" class="Symbol">(</a><a id="2955" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="2967" class="Symbol">(</a><a id="2968" href="Types.html#862" class="InductiveConstructor">R</a> <a id="2970" class="InductiveConstructor Operator">∷</a> <a id="2972" href="Types.html#886" class="InductiveConstructor">G</a> <a id="2974" class="InductiveConstructor Operator">∷</a> <a id="2976" class="InductiveConstructor">[]</a><a id="2978" class="Symbol">)</a> <a id="2980" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2982" class="Number">1</a><a id="2983" class="Symbol">))</a>
    <a id="2990" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a>   <a id="2994" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="3006" class="Symbol">(</a><a id="3007" href="Types.html#989" class="InductiveConstructor">C</a> <a id="3009" href="Types.html#1204" class="Function Operator">↦</a> <a id="3011" class="Number">0</a> <a id="3013" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3015" href="Types.html#862" class="InductiveConstructor">R</a> <a id="3017" href="Types.html#1204" class="Function Operator">↦</a> <a id="3019" class="Number">1</a><a id="3020" class="Symbol">)</a>
    <a id="3026" href="Prelude.Sets.Concrete.html#2693" class="Function Operator">S.∪</a> <a id="3030" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="3042" class="Symbol">(</a><a id="3043" href="Types.html#989" class="InductiveConstructor">C</a> <a id="3045" href="Types.html#1204" class="Function Operator">↦</a> <a id="3047" class="Number">0</a> <a id="3049" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3051" href="Types.html#886" class="InductiveConstructor">G</a> <a id="3053" href="Types.html#1204" class="Function Operator">↦</a> <a id="3055" class="Number">1</a><a id="3056" class="Symbol">)</a>
  <a id="3060" class="Symbol">_</a> <a id="3062" class="Symbol">=</a> <a id="3064" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

  <a id="3072" href="Types.html#3072" class="Function">_</a> <a id="3074" class="Symbol">:</a> <a id="3076" href="Types.html#1256" class="Function">calculateCost</a> <a id="3090" class="Symbol">(</a> <a id="3092" href="Prelude.Maps.Concrete.html#930" class="Function">singleton</a> <a id="3102" class="Symbol">(</a><a id="3103" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="3115" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="3117" href="Types.html#989" class="InductiveConstructor">C</a> <a id="3119" href="Data.List.Base.html#5025" class="Function Operator">]</a> <a id="3121" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3123" class="Number">2</a><a id="3124" class="Symbol">)</a>
                    <a id="3146" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3148" href="Prelude.Maps.Concrete.html#930" class="Function">singleton</a> <a id="3158" class="Symbol">(</a><a id="3159" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="3171" class="Symbol">(</a><a id="3172" href="Types.html#862" class="InductiveConstructor">R</a> <a id="3174" class="InductiveConstructor Operator">∷</a> <a id="3176" href="Types.html#886" class="InductiveConstructor">G</a> <a id="3178" class="InductiveConstructor Operator">∷</a> <a id="3180" class="InductiveConstructor">[]</a><a id="3182" class="Symbol">)</a> <a id="3184" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3186" class="Number">1</a><a id="3187" class="Symbol">))</a>
    <a id="3194" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a>   <a id="3198" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="3210" class="Symbol">(</a><a id="3211" href="Types.html#862" class="InductiveConstructor">R</a> <a id="3213" href="Types.html#1204" class="Function Operator">↦</a> <a id="3215" class="Number">1</a> <a id="3217" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3219" href="Types.html#989" class="InductiveConstructor">C</a> <a id="3221" href="Types.html#1204" class="Function Operator">↦</a> <a id="3223" class="Number">2</a><a id="3224" class="Symbol">)</a>
    <a id="3230" href="Prelude.Sets.Concrete.html#2693" class="Function Operator">S.∪</a> <a id="3234" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="3246" class="Symbol">(</a><a id="3247" href="Types.html#886" class="InductiveConstructor">G</a> <a id="3249" href="Types.html#1204" class="Function Operator">↦</a> <a id="3251" class="Number">1</a> <a id="3253" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3255" href="Types.html#989" class="InductiveConstructor">C</a> <a id="3257" href="Types.html#1204" class="Function Operator">↦</a> <a id="3259" class="Number">2</a><a id="3260" class="Symbol">)</a>
  <a id="3264" class="Symbol">_</a> <a id="3266" class="Symbol">=</a> <a id="3268" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

  <a id="3276" href="Types.html#3276" class="Function">_</a> <a id="3278" class="Symbol">:</a> <a id="3280" href="Types.html#1256" class="Function">calculateCost</a> <a id="3294" class="Symbol">(</a> <a id="3296" href="Prelude.Maps.Concrete.html#930" class="Function">singleton</a> <a id="3306" class="Symbol">(</a><a id="3307" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="3319" class="Symbol">(</a><a id="3320" href="Types.html#963" class="InductiveConstructor">B</a> <a id="3322" class="InductiveConstructor Operator">∷</a> <a id="3324" href="Types.html#938" class="InductiveConstructor">U</a> <a id="3326" class="InductiveConstructor Operator">∷</a> <a id="3328" class="InductiveConstructor">[]</a><a id="3330" class="Symbol">)</a> <a id="3332" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3334" class="Number">1</a><a id="3335" class="Symbol">)</a>
                    <a id="3357" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3359" href="Prelude.Maps.Concrete.html#930" class="Function">singleton</a> <a id="3369" class="Symbol">(</a><a id="3370" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="3382" class="Symbol">(</a><a id="3383" href="Types.html#862" class="InductiveConstructor">R</a> <a id="3385" class="InductiveConstructor Operator">∷</a> <a id="3387" href="Types.html#886" class="InductiveConstructor">G</a> <a id="3389" class="InductiveConstructor Operator">∷</a> <a id="3391" class="InductiveConstructor">[]</a><a id="3393" class="Symbol">)</a> <a id="3395" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3397" class="Number">1</a><a id="3398" class="Symbol">))</a>
    <a id="3405" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a>   <a id="3409" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="3421" class="Symbol">(</a><a id="3422" href="Types.html#989" class="InductiveConstructor">C</a> <a id="3424" href="Types.html#1204" class="Function Operator">↦</a> <a id="3426" class="Number">0</a> <a id="3428" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3430" href="Types.html#963" class="InductiveConstructor">B</a> <a id="3432" href="Types.html#1204" class="Function Operator">↦</a> <a id="3434" class="Number">1</a> <a id="3436" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3438" href="Types.html#862" class="InductiveConstructor">R</a> <a id="3440" href="Types.html#1204" class="Function Operator">↦</a> <a id="3442" class="Number">1</a><a id="3443" class="Symbol">)</a>
    <a id="3449" href="Prelude.Sets.Concrete.html#2693" class="Function Operator">S.∪</a> <a id="3453" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="3465" class="Symbol">(</a><a id="3466" href="Types.html#989" class="InductiveConstructor">C</a> <a id="3468" href="Types.html#1204" class="Function Operator">↦</a> <a id="3470" class="Number">0</a> <a id="3472" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3474" href="Types.html#963" class="InductiveConstructor">B</a> <a id="3476" href="Types.html#1204" class="Function Operator">↦</a> <a id="3478" class="Number">1</a> <a id="3480" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3482" href="Types.html#886" class="InductiveConstructor">G</a> <a id="3484" href="Types.html#1204" class="Function Operator">↦</a> <a id="3486" class="Number">1</a><a id="3487" class="Symbol">)</a>
    <a id="3493" href="Prelude.Sets.Concrete.html#2693" class="Function Operator">S.∪</a> <a id="3497" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="3509" class="Symbol">(</a><a id="3510" href="Types.html#989" class="InductiveConstructor">C</a> <a id="3512" href="Types.html#1204" class="Function Operator">↦</a> <a id="3514" class="Number">0</a> <a id="3516" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3518" href="Types.html#938" class="InductiveConstructor">U</a> <a id="3520" href="Types.html#1204" class="Function Operator">↦</a> <a id="3522" class="Number">1</a> <a id="3524" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3526" href="Types.html#862" class="InductiveConstructor">R</a> <a id="3528" href="Types.html#1204" class="Function Operator">↦</a> <a id="3530" class="Number">1</a><a id="3531" class="Symbol">)</a>
    <a id="3537" href="Prelude.Sets.Concrete.html#2693" class="Function Operator">S.∪</a> <a id="3541" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="3553" class="Symbol">(</a><a id="3554" href="Types.html#989" class="InductiveConstructor">C</a> <a id="3556" href="Types.html#1204" class="Function Operator">↦</a> <a id="3558" class="Number">0</a> <a id="3560" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3562" href="Types.html#938" class="InductiveConstructor">U</a> <a id="3564" href="Types.html#1204" class="Function Operator">↦</a> <a id="3566" class="Number">1</a> <a id="3568" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3570" href="Types.html#886" class="InductiveConstructor">G</a> <a id="3572" href="Types.html#1204" class="Function Operator">↦</a> <a id="3574" class="Number">1</a><a id="3575" class="Symbol">)</a>
  <a id="3579" class="Symbol">_</a> <a id="3581" class="Symbol">=</a> <a id="3583" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

  <a id="3591" href="Types.html#3591" class="Function">_</a> <a id="3593" class="Symbol">:</a> <a id="3595" href="Types.html#1256" class="Function">calculateCost</a> <a id="3609" class="Symbol">(</a> <a id="3611" href="Prelude.Maps.Concrete.html#930" class="Function">singleton</a> <a id="3621" class="Symbol">(</a><a id="3622" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="3634" class="Symbol">(</a><a id="3635" href="Types.html#862" class="InductiveConstructor">R</a> <a id="3637" class="InductiveConstructor Operator">∷</a> <a id="3639" href="Types.html#938" class="InductiveConstructor">U</a> <a id="3641" class="InductiveConstructor Operator">∷</a> <a id="3643" class="InductiveConstructor">[]</a><a id="3645" class="Symbol">)</a> <a id="3647" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3649" class="Number">1</a><a id="3650" class="Symbol">)</a>
                    <a id="3672" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3674" href="Prelude.Maps.Concrete.html#930" class="Function">singleton</a> <a id="3684" class="Symbol">(</a><a id="3685" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="3697" class="Symbol">(</a><a id="3698" href="Types.html#862" class="InductiveConstructor">R</a> <a id="3700" class="InductiveConstructor Operator">∷</a> <a id="3702" href="Types.html#886" class="InductiveConstructor">G</a> <a id="3704" class="InductiveConstructor Operator">∷</a> <a id="3706" class="InductiveConstructor">[]</a><a id="3708" class="Symbol">)</a> <a id="3710" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3712" class="Number">1</a><a id="3713" class="Symbol">))</a>
    <a id="3720" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a>   <a id="3724" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="3736" class="Symbol">(</a><a id="3737" href="Types.html#989" class="InductiveConstructor">C</a> <a id="3739" href="Types.html#1204" class="Function Operator">↦</a> <a id="3741" class="Number">0</a> <a id="3743" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3745" href="Types.html#862" class="InductiveConstructor">R</a> <a id="3747" href="Types.html#1204" class="Function Operator">↦</a> <a id="3749" class="Number">2</a><a id="3750" class="Symbol">)</a>
    <a id="3756" href="Prelude.Sets.Concrete.html#2693" class="Function Operator">S.∪</a> <a id="3760" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="3772" class="Symbol">(</a><a id="3773" href="Types.html#989" class="InductiveConstructor">C</a> <a id="3775" href="Types.html#1204" class="Function Operator">↦</a> <a id="3777" class="Number">0</a> <a id="3779" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3781" href="Types.html#862" class="InductiveConstructor">R</a> <a id="3783" href="Types.html#1204" class="Function Operator">↦</a> <a id="3785" class="Number">1</a> <a id="3787" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3789" href="Types.html#886" class="InductiveConstructor">G</a> <a id="3791" href="Types.html#1204" class="Function Operator">↦</a> <a id="3793" class="Number">1</a><a id="3794" class="Symbol">)</a>
    <a id="3800" href="Prelude.Sets.Concrete.html#2693" class="Function Operator">S.∪</a> <a id="3804" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="3816" class="Symbol">(</a><a id="3817" href="Types.html#989" class="InductiveConstructor">C</a> <a id="3819" href="Types.html#1204" class="Function Operator">↦</a> <a id="3821" class="Number">0</a> <a id="3823" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3825" href="Types.html#938" class="InductiveConstructor">U</a> <a id="3827" href="Types.html#1204" class="Function Operator">↦</a> <a id="3829" class="Number">1</a> <a id="3831" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3833" href="Types.html#862" class="InductiveConstructor">R</a> <a id="3835" href="Types.html#1204" class="Function Operator">↦</a> <a id="3837" class="Number">1</a><a id="3838" class="Symbol">)</a>
    <a id="3844" href="Prelude.Sets.Concrete.html#2693" class="Function Operator">S.∪</a> <a id="3848" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="3860" class="Symbol">(</a><a id="3861" href="Types.html#989" class="InductiveConstructor">C</a> <a id="3863" href="Types.html#1204" class="Function Operator">↦</a> <a id="3865" class="Number">0</a> <a id="3867" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3869" href="Types.html#938" class="InductiveConstructor">U</a> <a id="3871" href="Types.html#1204" class="Function Operator">↦</a> <a id="3873" class="Number">1</a> <a id="3875" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3877" href="Types.html#886" class="InductiveConstructor">G</a> <a id="3879" href="Types.html#1204" class="Function Operator">↦</a> <a id="3881" class="Number">1</a><a id="3882" class="Symbol">)</a>
  <a id="3886" class="Symbol">_</a> <a id="3888" class="Symbol">=</a> <a id="3890" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="3896" class="Comment">-- Cost = ManaCost ⊎ SacrificeCost</a>

<a id="3932" class="Keyword">data</a> <a id="CreatureType"></a><a id="3937" href="Types.html#3937" class="Datatype">CreatureType</a> <a id="3950" class="Symbol">:</a> <a id="3952" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="3957" class="Keyword">where</a>
  <a id="CreatureType.Human"></a><a id="3965" href="Types.html#3965" class="InductiveConstructor">Human</a> <a id="CreatureType.Soldier"></a><a id="3971" href="Types.html#3971" class="InductiveConstructor">Soldier</a> <a id="CreatureType.Dwarf"></a><a id="3979" href="Types.html#3979" class="InductiveConstructor">Dwarf</a> <a id="CreatureType.Vampire"></a><a id="3985" href="Types.html#3985" class="InductiveConstructor">Vampire</a> <a id="CreatureType.Ogre"></a><a id="3993" href="Types.html#3993" class="InductiveConstructor">Ogre</a> <a id="CreatureType.Warrior"></a><a id="3998" href="Types.html#3998" class="InductiveConstructor">Warrior</a> <a id="4006" class="Symbol">:</a> <a id="4008" href="Types.html#3937" class="Datatype">CreatureType</a>
<a id="4021" class="Keyword">unquoteDecl</a> <a id="DecEq-CreatureType"></a><a id="4033" href="Types.html#4033" class="Function">DecEq-CreatureType</a> <a id="4052" class="Symbol">=</a> <a id="4054" href="Prelude.Generics.html#9852" class="Function">DERIVE</a> <a id="4061" href="Prelude.DecEq.Core.html#97" class="Record">DecEq</a> <a id="4067" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="4069" class="Keyword">quote</a> <a id="4075" href="Types.html#3937" class="Datatype">CreatureType</a> <a id="4088" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4090" href="Types.html#4033" class="Function">DecEq-CreatureType</a> <a id="4109" href="Data.List.Base.html#5025" class="Function Operator">]</a>

<a id="4112" class="Keyword">record</a> <a id="CreatureStats"></a><a id="4119" href="Types.html#4119" class="Record">CreatureStats</a> <a id="4133" class="Symbol">:</a> <a id="4135" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="4140" class="Keyword">where</a>
  <a id="4148" class="Keyword">constructor</a> <a id="_/_"></a><a id="4160" href="Types.html#4160" class="InductiveConstructor Operator">_/_</a>
  <a id="4166" class="Keyword">field</a> <a id="CreatureStats.power"></a><a id="4172" href="Types.html#4172" class="Field">power</a>     <a id="4182" class="Symbol">:</a> <a id="4184" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
        <a id="CreatureStats.toughness"></a><a id="4194" href="Types.html#4194" class="Field">toughness</a> <a id="4204" class="Symbol">:</a> <a id="4206" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="4208" class="Keyword">open</a> <a id="4213" href="Types.html#4119" class="Module">CreatureStats</a> <a id="4227" class="Keyword">public</a>
<a id="4234" class="Keyword">unquoteDecl</a> <a id="DecEq-CreatureStats"></a><a id="4246" href="Types.html#4246" class="Function">DecEq-CreatureStats</a> <a id="4266" class="Symbol">=</a> <a id="4268" href="Prelude.Generics.html#9852" class="Function">DERIVE</a> <a id="4275" href="Prelude.DecEq.Core.html#97" class="Record">DecEq</a> <a id="4281" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="4283" class="Keyword">quote</a> <a id="4289" href="Types.html#4119" class="Record">CreatureStats</a> <a id="4303" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4305" href="Types.html#4246" class="Function">DecEq-CreatureStats</a> <a id="4325" href="Data.List.Base.html#5025" class="Function Operator">]</a>

<a id="4328" class="Keyword">data</a> <a id="Card"></a><a id="4333" href="Types.html#4333" class="Datatype">Card</a> <a id="4338" class="Symbol">:</a> <a id="4340" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="4345" class="Keyword">where</a>
  <a id="Card.BasicLand"></a><a id="4353" href="Types.html#4353" class="InductiveConstructor">BasicLand</a> <a id="4363" class="Symbol">:</a> <a id="4365" href="Types.html#644" class="Datatype">Colour</a> <a id="4372" class="Symbol">→</a> <a id="4374" href="Types.html#4333" class="Datatype">Card</a>
  <a id="Card.Creature"></a><a id="4381" href="Types.html#4381" class="InductiveConstructor">Creature</a>  <a id="4391" class="Symbol">:</a> <a id="4393" href="Types.html#1062" class="Function">CardCost</a> <a id="4402" class="Symbol">→</a> <a id="4404" href="Prelude.Sets.Concrete.html#7514" class="Record">S.Set⁺⟨</a> <a id="4412" href="Types.html#3937" class="Datatype">CreatureType</a> <a id="4425" href="Prelude.Sets.Concrete.html#7514" class="Record">⟩</a> <a id="4427" class="Symbol">→</a> <a id="4429" href="Types.html#4119" class="Record">CreatureStats</a> <a id="4443" class="Symbol">→</a> <a id="4445" href="Types.html#4333" class="Datatype">Card</a>
<a id="4450" class="Keyword">unquoteDecl</a> <a id="DecEq-Card"></a><a id="4462" href="Types.html#4462" class="Function">DecEq-Card</a> <a id="4473" class="Symbol">=</a> <a id="4475" href="Prelude.Generics.html#9852" class="Function">DERIVE</a> <a id="4482" href="Prelude.DecEq.Core.html#97" class="Record">DecEq</a> <a id="4488" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="4490" class="Keyword">quote</a> <a id="4496" href="Types.html#4333" class="Datatype">Card</a> <a id="4501" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4503" href="Types.html#4462" class="Function">DecEq-Card</a> <a id="4514" href="Data.List.Base.html#5025" class="Function Operator">]</a>

<a id="4517" class="Keyword">private</a> <a id="4525" class="Keyword">variable</a> <a id="4534" href="Types.html#4534" class="Generalizable">c</a> <a id="4536" href="Types.html#4536" class="Generalizable">c′</a> <a id="4539" href="Types.html#4539" class="Generalizable">c″</a> <a id="4542" class="Symbol">:</a> <a id="4544" href="Types.html#4333" class="Datatype">Card</a>

<a id="Mountain"></a><a id="4550" href="Types.html#4550" class="Function">Mountain</a> <a id="4559" class="Symbol">=</a> <a id="4561" href="Types.html#4353" class="InductiveConstructor">BasicLand</a> <a id="4571" href="Types.html#666" class="InductiveConstructor">Red</a>
<a id="Forest"></a><a id="4575" href="Types.html#4575" class="Function">Forest</a>   <a id="4584" class="Symbol">=</a> <a id="4586" href="Types.html#4353" class="InductiveConstructor">BasicLand</a> <a id="4596" href="Types.html#670" class="InductiveConstructor">Green</a>
<a id="Plains"></a><a id="4602" href="Types.html#4602" class="Function">Plains</a>   <a id="4611" class="Symbol">=</a> <a id="4613" href="Types.html#4353" class="InductiveConstructor">BasicLand</a> <a id="4623" href="Types.html#676" class="InductiveConstructor">White</a>
<a id="Island"></a><a id="4629" href="Types.html#4629" class="Function">Island</a>   <a id="4638" class="Symbol">=</a> <a id="4640" href="Types.html#4353" class="InductiveConstructor">BasicLand</a> <a id="4650" href="Types.html#682" class="InductiveConstructor">Blue</a>
<a id="Swamp"></a><a id="4655" href="Types.html#4655" class="Function">Swamp</a>    <a id="4664" class="Symbol">=</a> <a id="4666" href="Types.html#4353" class="InductiveConstructor">BasicLand</a> <a id="4676" href="Types.html#687" class="InductiveConstructor">Black</a>

<a id="GlorySeeker"></a><a id="4683" href="Types.html#4683" class="Function">GlorySeeker</a> <a id="4695" class="Symbol">=</a> <a id="4697" href="Types.html#4333" class="Datatype">Card</a> <a id="4702" href="Function.Base.html#4562" class="Function Operator">∋</a> <a id="4704" href="Types.html#4381" class="InductiveConstructor">Creature</a>
  <a id="4715" class="Symbol">(</a><a id="4716" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="4728" class="Symbol">(</a><a id="4729" href="Types.html#989" class="InductiveConstructor">C</a> <a id="4731" href="Types.html#1204" class="Function Operator">↦</a> <a id="4733" class="Number">1</a> <a id="4735" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="4737" href="Types.html#912" class="InductiveConstructor">W</a> <a id="4739" href="Types.html#1204" class="Function Operator">↦</a> <a id="4741" class="Number">1</a><a id="4742" class="Symbol">))</a>
  <a id="4747" class="Symbol">(</a><a id="4748" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="4760" href="Prelude.Nary.html#207" class="Function Operator">⟦</a> <a id="4762" href="Types.html#3965" class="InductiveConstructor">Human</a> <a id="4768" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4770" href="Types.html#3971" class="InductiveConstructor">Soldier</a> <a id="4778" href="Prelude.Nary.html#207" class="Function Operator">⟧</a><a id="4779" class="Symbol">)</a>
  <a id="4783" class="Symbol">(</a><a id="4784" class="Number">2</a> <a id="4786" href="Types.html#4160" class="InductiveConstructor Operator">/</a> <a id="4788" class="Number">2</a><a id="4789" class="Symbol">)</a>

<a id="StaunchShieldmate"></a><a id="4792" href="Types.html#4792" class="Function">StaunchShieldmate</a> <a id="4810" class="Symbol">=</a> <a id="4812" href="Types.html#4333" class="Datatype">Card</a> <a id="4817" href="Function.Base.html#4562" class="Function Operator">∋</a> <a id="4819" href="Types.html#4381" class="InductiveConstructor">Creature</a>
  <a id="4830" class="Symbol">(</a><a id="4831" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="4843" class="Symbol">(</a><a id="4844" href="Types.html#912" class="InductiveConstructor">W</a> <a id="4846" href="Types.html#1204" class="Function Operator">↦</a> <a id="4848" class="Number">1</a><a id="4849" class="Symbol">))</a>
  <a id="4854" class="Symbol">(</a><a id="4855" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="4867" href="Prelude.Nary.html#207" class="Function Operator">⟦</a> <a id="4869" href="Types.html#3979" class="InductiveConstructor">Dwarf</a> <a id="4875" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4877" href="Types.html#3971" class="InductiveConstructor">Soldier</a> <a id="4885" href="Prelude.Nary.html#207" class="Function Operator">⟧</a><a id="4886" class="Symbol">)</a>
  <a id="4890" class="Symbol">(</a><a id="4891" class="Number">1</a> <a id="4893" href="Types.html#4160" class="InductiveConstructor Operator">/</a> <a id="4895" class="Number">3</a><a id="4896" class="Symbol">)</a>

<a id="FalkenrathReaver"></a><a id="4899" href="Types.html#4899" class="Function">FalkenrathReaver</a> <a id="4916" class="Symbol">=</a> <a id="4918" href="Types.html#4333" class="Datatype">Card</a> <a id="4923" href="Function.Base.html#4562" class="Function Operator">∋</a> <a id="4925" href="Types.html#4381" class="InductiveConstructor">Creature</a>
  <a id="4936" class="Symbol">(</a><a id="4937" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="4949" class="Symbol">(</a><a id="4950" href="Types.html#989" class="InductiveConstructor">C</a> <a id="4952" href="Types.html#1204" class="Function Operator">↦</a> <a id="4954" class="Number">1</a> <a id="4956" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="4958" href="Types.html#862" class="InductiveConstructor">R</a> <a id="4960" href="Types.html#1204" class="Function Operator">↦</a> <a id="4962" class="Number">1</a><a id="4963" class="Symbol">))</a>
  <a id="4968" class="Symbol">(</a><a id="4969" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="4981" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="4983" href="Types.html#3985" class="InductiveConstructor">Vampire</a> <a id="4991" href="Data.List.Base.html#5025" class="Function Operator">]</a><a id="4992" class="Symbol">)</a>
  <a id="4996" class="Symbol">(</a><a id="4997" class="Number">2</a> <a id="4999" href="Types.html#4160" class="InductiveConstructor Operator">/</a> <a id="5001" class="Number">2</a><a id="5002" class="Symbol">)</a>

<a id="OnakkeOgre"></a><a id="5005" href="Types.html#5005" class="Function">OnakkeOgre</a> <a id="5016" class="Symbol">=</a> <a id="5018" href="Types.html#4333" class="Datatype">Card</a> <a id="5023" href="Function.Base.html#4562" class="Function Operator">∋</a> <a id="5025" href="Types.html#4381" class="InductiveConstructor">Creature</a>
  <a id="5036" class="Symbol">(</a><a id="5037" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="5049" class="Symbol">(</a><a id="5050" href="Types.html#989" class="InductiveConstructor">C</a> <a id="5052" href="Types.html#1204" class="Function Operator">↦</a> <a id="5054" class="Number">2</a> <a id="5056" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="5058" href="Types.html#862" class="InductiveConstructor">R</a> <a id="5060" href="Types.html#1204" class="Function Operator">↦</a> <a id="5062" class="Number">1</a><a id="5063" class="Symbol">))</a>
  <a id="5068" class="Symbol">(</a><a id="5069" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="5081" href="Prelude.Nary.html#207" class="Function Operator">⟦</a> <a id="5083" href="Types.html#3993" class="InductiveConstructor">Ogre</a> <a id="5088" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5090" href="Types.html#3998" class="InductiveConstructor">Warrior</a> <a id="5098" href="Prelude.Nary.html#207" class="Function Operator">⟧</a><a id="5099" class="Symbol">)</a>
  <a id="5103" class="Symbol">(</a><a id="5104" class="Number">4</a> <a id="5106" href="Types.html#4160" class="InductiveConstructor Operator">/</a> <a id="5108" class="Number">2</a><a id="5109" class="Symbol">)</a>

<a id="IsLand"></a><a id="5112" href="Types.html#5112" class="Function">IsLand</a> <a id="IsCreature"></a><a id="5119" href="Types.html#5119" class="Function">IsCreature</a> <a id="5130" class="Symbol">:</a> <a id="5132" href="Prelude.Init.html#11508" class="Function">Pred₀</a> <a id="5138" href="Types.html#4333" class="Datatype">Card</a>
<a id="5143" href="Types.html#5112" class="Function">IsLand</a> <a id="5150" class="Symbol">=</a> <a id="5152" class="Symbol">λ</a> <a id="5154" class="Keyword">where</a>
  <a id="5162" class="Symbol">(</a><a id="5163" href="Types.html#4353" class="InductiveConstructor">BasicLand</a> <a id="5173" class="Symbol">_)</a> <a id="5176" class="Symbol">→</a> <a id="5178" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
  <a id="5182" class="CatchallClause Symbol">_</a> <a id="5184" class="Symbol">→</a> <a id="5186" href="Data.Empty.html#526" class="Datatype">⊥</a>
<a id="5188" href="Types.html#5119" class="Function">IsCreature</a> <a id="5199" class="Symbol">=</a> <a id="5201" class="Symbol">λ</a> <a id="5203" class="Keyword">where</a>
  <a id="5211" class="Symbol">(</a><a id="5212" href="Types.html#4381" class="InductiveConstructor">Creature</a> <a id="5221" class="Symbol">_</a> <a id="5223" class="Symbol">_</a> <a id="5225" class="Symbol">_)</a> <a id="5228" class="Symbol">→</a> <a id="5230" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
  <a id="5234" class="CatchallClause Symbol">_</a> <a id="5236" class="Symbol">→</a> <a id="5238" href="Data.Empty.html#526" class="Datatype">⊥</a>

<a id="LandProperties"></a><a id="5241" href="Types.html#5241" class="Function">LandProperties</a> <a id="5256" class="Symbol">=</a> <a id="5258" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>

<a id="5261" class="Keyword">record</a> <a id="CreatureProperties"></a><a id="5268" href="Types.html#5268" class="Record">CreatureProperties</a> <a id="5287" class="Symbol">:</a> <a id="5289" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="5294" class="Keyword">where</a>
  <a id="5302" class="Keyword">field</a> <a id="CreatureProperties.summoningSickness"></a><a id="5308" href="Types.html#5308" class="Field">summoningSickness</a> <a id="5326" class="Symbol">:</a> <a id="5328" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="5333" class="Keyword">open</a> <a id="5338" href="Types.html#5268" class="Module">CreatureProperties</a> <a id="5357" class="Keyword">public</a>

<a id="Properties"></a><a id="5365" href="Types.html#5365" class="Function">Properties</a> <a id="5376" class="Symbol">:</a> <a id="5378" href="Types.html#4333" class="Datatype">Card</a> <a id="5383" class="Symbol">→</a> <a id="5385" href="Agda.Primitive.html#326" class="Primitive">Type</a>
<a id="5390" href="Types.html#5365" class="Function">Properties</a> <a id="5401" class="Symbol">=</a> <a id="5403" class="Symbol">λ</a> <a id="5405" class="Keyword">where</a>
  <a id="5413" class="Symbol">(</a><a id="5414" href="Types.html#4353" class="InductiveConstructor">BasicLand</a> <a id="5424" class="Symbol">_)</a>    <a id="5430" class="Symbol">→</a> <a id="5432" href="Types.html#5241" class="Function">LandProperties</a>
  <a id="5449" class="Symbol">(</a><a id="5450" href="Types.html#4381" class="InductiveConstructor">Creature</a> <a id="5459" class="Symbol">_</a> <a id="5461" class="Symbol">_</a> <a id="5463" class="Symbol">_)</a> <a id="5466" class="Symbol">→</a> <a id="5468" href="Types.html#5268" class="Record">CreatureProperties</a>

<a id="5488" class="Keyword">record</a> <a id="CardInstance"></a><a id="5495" href="Types.html#5495" class="Record">CardInstance</a> <a id="5508" class="Symbol">:</a> <a id="5510" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="5515" class="Keyword">where</a>
  <a id="5523" class="Keyword">field</a>
    <a id="CardInstance.card"></a><a id="5533" href="Types.html#5533" class="Field">card</a> <a id="5538" class="Symbol">:</a> <a id="5540" href="Types.html#4333" class="Datatype">Card</a>
    <a id="CardInstance.tapped"></a><a id="5549" href="Types.html#5549" class="Field">tapped</a> <a id="5556" class="Symbol">:</a> <a id="5558" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
    <a id="CardInstance.properties"></a><a id="5567" href="Types.html#5567" class="Field">properties</a> <a id="5578" class="Symbol">:</a> <a id="5580" href="Types.html#5365" class="Function">Properties</a> <a id="5591" href="Types.html#5533" class="Field">card</a>
<a id="5596" class="Keyword">open</a> <a id="5601" href="Types.html#5495" class="Module">CardInstance</a> <a id="5614" class="Keyword">public</a>

<a id="5622" class="Keyword">private</a>
  <a id="unsummon"></a><a id="5632" href="Types.html#5632" class="Function">unsummon</a> <a id="5641" class="Symbol">:</a> <a id="5643" href="Algebra.Core.html#475" class="Function">Op₁</a> <a id="5647" href="Types.html#5268" class="Record">CreatureProperties</a>
  <a id="5668" href="Types.html#5632" class="Function">unsummon</a> <a id="5677" href="Types.html#5677" class="Bound">ps</a> <a id="5680" class="Symbol">=</a> <a id="5682" class="Keyword">record</a> <a id="5689" href="Types.html#5677" class="Bound">ps</a> <a id="5692" class="Symbol">{</a><a id="5693" href="Types.html#5308" class="Field">summoningSickness</a> <a id="5711" class="Symbol">=</a> <a id="5713" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a><a id="5718" class="Symbol">}</a>

  <a id="liftProp"></a><a id="5723" href="Types.html#5723" class="Function">liftProp</a> <a id="5732" class="Symbol">:</a> <a id="5734" href="Algebra.Core.html#475" class="Function">Op₁</a> <a id="5738" href="Types.html#5268" class="Record">CreatureProperties</a> <a id="5757" class="Symbol">→</a> <a id="5759" href="Algebra.Core.html#475" class="Function">Op₁</a> <a id="5763" class="Symbol">(</a><a id="5764" href="Types.html#5365" class="Function">Properties</a> <a id="5775" href="Types.html#4534" class="Generalizable">c</a><a id="5776" class="Symbol">)</a>
  <a id="5780" href="Types.html#5723" class="Function">liftProp</a> <a id="5789" class="Symbol">{</a><a id="5790" class="Argument">c</a> <a id="5792" class="Symbol">=</a> <a id="5794" href="Types.html#5794" class="Bound">c</a><a id="5795" class="Symbol">}</a> <a id="5797" href="Types.html#5797" class="Bound">go</a> <a id="5800" href="Types.html#5800" class="Bound">ps</a> <a id="5803" class="Keyword">with</a> <a id="5808" href="Types.html#5794" class="Bound">c</a>
  <a id="5812" class="Symbol">...</a> <a id="5816" class="Symbol">|</a> <a id="5818" href="Types.html#4353" class="InductiveConstructor">BasicLand</a> <a id="5828" class="Symbol">_</a>    <a id="5833" class="Symbol">=</a> <a id="5835" class="Bound">ps</a>
  <a id="5840" class="Symbol">...</a> <a id="5844" class="Symbol">|</a> <a id="5846" href="Types.html#4381" class="InductiveConstructor">Creature</a> <a id="5855" class="Symbol">_</a> <a id="5857" class="Symbol">_</a> <a id="5859" class="Symbol">_</a> <a id="5861" class="Symbol">=</a> <a id="5863" class="Bound">go</a> <a id="5866" class="Bound">ps</a>

  <a id="liftProp′"></a><a id="5872" href="Types.html#5872" class="Function">liftProp′</a> <a id="5882" class="Symbol">:</a> <a id="5884" href="Algebra.Core.html#475" class="Function">Op₁</a> <a id="5888" href="Types.html#5495" class="Record">CardInstance</a>
  <a id="5903" href="Types.html#5872" class="Function">liftProp′</a> <a id="5913" href="Types.html#5913" class="Bound">ci</a><a id="5915" class="Symbol">@(</a><a id="5917" class="Keyword">record</a> <a id="5924" class="Symbol">{</a><a id="5925" href="Types.html#5533" class="Field">card</a> <a id="5930" class="Symbol">=</a> <a id="5932" href="Types.html#5932" class="Bound">c</a><a id="5933" class="Symbol">;</a> <a id="5935" href="Types.html#5549" class="Field">tapped</a> <a id="5942" class="Symbol">=</a> <a id="5944" href="Types.html#5944" class="Bound">tp</a><a id="5946" class="Symbol">;</a> <a id="5948" href="Types.html#5567" class="Field">properties</a> <a id="5959" class="Symbol">=</a> <a id="5961" href="Types.html#5961" class="Bound">ps</a><a id="5963" class="Symbol">})</a>
    <a id="5970" class="Symbol">=</a> <a id="5972" class="Keyword">record</a> <a id="5979" class="Symbol">{</a><a id="5980" href="Types.html#5533" class="Field">card</a> <a id="5985" class="Symbol">=</a> <a id="5987" href="Types.html#5932" class="Bound">c</a><a id="5988" class="Symbol">;</a> <a id="5990" href="Types.html#5549" class="Field">tapped</a> <a id="5997" class="Symbol">=</a> <a id="5999" href="Types.html#5944" class="Bound">tp</a><a id="6001" class="Symbol">;</a> <a id="6003" href="Types.html#5567" class="Field">properties</a> <a id="6014" class="Symbol">=</a> <a id="6016" href="Types.html#5723" class="Function">liftProp</a> <a id="6025" href="Types.html#5632" class="Function">unsummon</a> <a id="6034" href="Types.html#5961" class="Bound">ps</a><a id="6036" class="Symbol">}</a>

<a id="Cards"></a><a id="6039" href="Types.html#6039" class="Function">Cards</a> <a id="6045" class="Symbol">=</a> <a id="6047" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="6052" href="Types.html#4333" class="Datatype">Card</a>
<a id="Deck"></a><a id="6057" href="Types.html#6057" class="Function">Deck</a> <a id="6062" class="Symbol">=</a> <a id="6064" href="Types.html#6039" class="Function">Cards</a>
<a id="Hand"></a><a id="6070" href="Types.html#6070" class="Function">Hand</a> <a id="6075" class="Symbol">=</a> <a id="6077" href="Types.html#6039" class="Function">Cards</a>

<a id="6084" class="Keyword">private</a> <a id="6092" class="Keyword">variable</a>
  <a id="6103" href="Types.html#6103" class="Generalizable">cs</a> <a id="6106" href="Types.html#6106" class="Generalizable">cs′</a> <a id="6110" href="Types.html#6110" class="Generalizable">cs″</a> <a id="6114" class="Symbol">:</a> <a id="6116" href="Types.html#6039" class="Function">Cards</a>
  <a id="6124" href="Types.html#6124" class="Generalizable">d</a> <a id="6126" href="Types.html#6126" class="Generalizable">d′</a> <a id="6129" href="Types.html#6129" class="Generalizable">d″</a> <a id="6132" class="Symbol">:</a> <a id="6134" href="Types.html#6057" class="Function">Deck</a>
  <a id="6141" href="Types.html#6141" class="Generalizable">h</a> <a id="6143" href="Types.html#6143" class="Generalizable">h′</a> <a id="6146" href="Types.html#6146" class="Generalizable">h″</a> <a id="6149" class="Symbol">:</a> <a id="6151" href="Types.html#6070" class="Function">Hand</a>

<a id="6157" class="Keyword">record</a> <a id="Player"></a><a id="6164" href="Types.html#6164" class="Record">Player</a> <a id="6171" class="Symbol">:</a> <a id="6173" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="6178" class="Keyword">where</a>
  <a id="6186" class="Keyword">constructor</a> <a id="mkPlayer"></a><a id="6198" href="Types.html#6198" class="InductiveConstructor">mkPlayer</a>
  <a id="6209" class="Keyword">field</a>
    <a id="Player.name"></a><a id="6219" href="Types.html#6219" class="Field">name</a> <a id="6224" class="Symbol">:</a> <a id="6226" href="Agda.Builtin.String.html#336" class="Postulate">String</a>
    <a id="Player.library"></a><a id="6237" href="Types.html#6237" class="Field">library</a> <a id="6245" class="Symbol">:</a> <a id="6247" href="Types.html#6039" class="Function">Cards</a>
    <a id="Player.hand"></a><a id="6257" href="Types.html#6257" class="Field">hand</a> <a id="6262" class="Symbol">:</a> <a id="6264" href="Types.html#6070" class="Function">Hand</a>
    <a id="Player.graveyard"></a><a id="6273" href="Types.html#6273" class="Field">graveyard</a> <a id="6283" class="Symbol">:</a> <a id="6285" href="Types.html#6039" class="Function">Cards</a>
    <a id="Player.exile"></a><a id="6295" href="Types.html#6295" class="Field">exile</a> <a id="6301" class="Symbol">:</a> <a id="6303" href="Types.html#6039" class="Function">Cards</a>
    <a id="Player.life"></a><a id="6313" href="Types.html#6313" class="Field">life</a> <a id="6318" class="Symbol">:</a> <a id="6320" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="Player.control"></a><a id="6326" href="Types.html#6326" class="Field">control</a> <a id="6334" class="Symbol">:</a> <a id="6336" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="6341" href="Types.html#5495" class="Record">CardInstance</a>
<a id="6354" class="Keyword">open</a> <a id="6359" href="Types.html#6164" class="Module">Player</a> <a id="6366" class="Keyword">public</a>
<a id="6373" class="Keyword">unquoteDecl</a> <a id="$name"></a><a id="6385" href="Types.html#6385" class="Function">$name</a> <a id="_∙name"></a><a id="6391" href="Types.html#6391" class="Function Operator">_∙name</a> <a id="_∙name=_"></a><a id="6398" href="Types.html#6398" class="Function Operator">_∙name=_</a> <a id="_∙name↝_"></a><a id="6407" href="Types.html#6407" class="Function Operator">_∙name↝_</a>
            <a id="$library"></a><a id="6428" href="Types.html#6428" class="Function">$library</a> <a id="_∙library"></a><a id="6437" href="Types.html#6437" class="Function Operator">_∙library</a> <a id="_∙library=_"></a><a id="6447" href="Types.html#6447" class="Function Operator">_∙library=_</a> <a id="_∙library↝_"></a><a id="6459" href="Types.html#6459" class="Function Operator">_∙library↝_</a>
            <a id="$hand"></a><a id="6483" href="Types.html#6483" class="Function">$hand</a> <a id="_∙hand"></a><a id="6489" href="Types.html#6489" class="Function Operator">_∙hand</a> <a id="_∙hand=_"></a><a id="6496" href="Types.html#6496" class="Function Operator">_∙hand=_</a> <a id="_∙hand↝_"></a><a id="6505" href="Types.html#6505" class="Function Operator">_∙hand↝_</a>
            <a id="$graveyard"></a><a id="6526" href="Types.html#6526" class="Function">$graveyard</a> <a id="_∙graveyard"></a><a id="6537" href="Types.html#6537" class="Function Operator">_∙graveyard</a> <a id="_∙graveyard=_"></a><a id="6549" href="Types.html#6549" class="Function Operator">_∙graveyard=_</a> <a id="_∙graveyard↝_"></a><a id="6563" href="Types.html#6563" class="Function Operator">_∙graveyard↝_</a>
            <a id="$exile"></a><a id="6589" href="Types.html#6589" class="Function">$exile</a> <a id="_∙exile"></a><a id="6596" href="Types.html#6596" class="Function Operator">_∙exile</a> <a id="_∙exile=_"></a><a id="6604" href="Types.html#6604" class="Function Operator">_∙exile=_</a> <a id="_∙exile↝_"></a><a id="6614" href="Types.html#6614" class="Function Operator">_∙exile↝_</a>
            <a id="$life"></a><a id="6636" href="Types.html#6636" class="Function">$life</a> <a id="_∙life"></a><a id="6642" href="Types.html#6642" class="Function Operator">_∙life</a> <a id="_∙life=_"></a><a id="6649" href="Types.html#6649" class="Function Operator">_∙life=_</a> <a id="_∙life↝_"></a><a id="6658" href="Types.html#6658" class="Function Operator">_∙life↝_</a>
            <a id="$control"></a><a id="6679" href="Types.html#6679" class="Function">$control</a> <a id="_∙control"></a><a id="6688" href="Types.html#6688" class="Function Operator">_∙control</a> <a id="_∙control=_"></a><a id="6698" href="Types.html#6698" class="Function Operator">_∙control=_</a> <a id="_∙control↝_"></a><a id="6710" href="Types.html#6710" class="Function Operator">_∙control↝_</a>
  <a id="6724" class="Symbol">=</a> <a id="6726" href="Prelude.Lenses.Derive.html#270" class="Function">deriveLenses</a> <a id="6739" class="Symbol">(</a><a id="6740" class="Keyword">quote</a> <a id="6746" href="Types.html#6164" class="Record">Player</a><a id="6752" class="Symbol">)</a>
  <a id="6756" class="Symbol">(</a> <a id="6758" class="Symbol">(</a><a id="6759" href="Types.html#6385" class="Function">$name</a> <a id="6765" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6767" href="Types.html#6391" class="Function Operator">_∙name</a> <a id="6774" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6776" href="Types.html#6398" class="Function Operator">_∙name=_</a> <a id="6785" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6787" href="Types.html#6407" class="Function Operator">_∙name↝_</a><a id="6795" class="Symbol">)</a>
  <a id="6799" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6801" class="Symbol">(</a><a id="6802" href="Types.html#6428" class="Function">$library</a> <a id="6811" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6813" href="Types.html#6437" class="Function Operator">_∙library</a> <a id="6823" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6825" href="Types.html#6447" class="Function Operator">_∙library=_</a> <a id="6837" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6839" href="Types.html#6459" class="Function Operator">_∙library↝_</a><a id="6850" class="Symbol">)</a>
  <a id="6854" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6856" class="Symbol">(</a><a id="6857" href="Types.html#6483" class="Function">$hand</a> <a id="6863" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6865" href="Types.html#6489" class="Function Operator">_∙hand</a> <a id="6872" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6874" href="Types.html#6496" class="Function Operator">_∙hand=_</a> <a id="6883" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6885" href="Types.html#6505" class="Function Operator">_∙hand↝_</a><a id="6893" class="Symbol">)</a>
  <a id="6897" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6899" class="Symbol">(</a><a id="6900" href="Types.html#6526" class="Function">$graveyard</a> <a id="6911" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6913" href="Types.html#6537" class="Function Operator">_∙graveyard</a> <a id="6925" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6927" href="Types.html#6549" class="Function Operator">_∙graveyard=_</a> <a id="6941" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6943" href="Types.html#6563" class="Function Operator">_∙graveyard↝_</a><a id="6956" class="Symbol">)</a>
  <a id="6960" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6962" class="Symbol">(</a><a id="6963" href="Types.html#6589" class="Function">$exile</a> <a id="6970" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6972" href="Types.html#6596" class="Function Operator">_∙exile</a> <a id="6980" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6982" href="Types.html#6604" class="Function Operator">_∙exile=_</a> <a id="6992" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6994" href="Types.html#6614" class="Function Operator">_∙exile↝_</a><a id="7003" class="Symbol">)</a>
  <a id="7007" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7009" class="Symbol">(</a><a id="7010" href="Types.html#6636" class="Function">$life</a> <a id="7016" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7018" href="Types.html#6642" class="Function Operator">_∙life</a> <a id="7025" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7027" href="Types.html#6649" class="Function Operator">_∙life=_</a> <a id="7036" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7038" href="Types.html#6658" class="Function Operator">_∙life↝_</a><a id="7046" class="Symbol">)</a>
  <a id="7050" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7052" class="Symbol">(</a><a id="7053" href="Types.html#6679" class="Function">$control</a> <a id="7062" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7064" href="Types.html#6688" class="Function Operator">_∙control</a> <a id="7074" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7076" href="Types.html#6698" class="Function Operator">_∙control=_</a> <a id="7088" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7090" href="Types.html#6710" class="Function Operator">_∙control↝_</a><a id="7101" class="Symbol">)</a>
  <a id="7105" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7107" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="7109" class="Symbol">)</a>
<a id="7111" class="Keyword">infixl</a> <a id="7118" class="Number">10</a>
  <a id="7123" href="Types.html#6398" class="Function Operator">_∙name=_</a> <a id="7132" href="Types.html#6407" class="Function Operator">_∙name↝_</a>
  <a id="7143" href="Types.html#6447" class="Function Operator">_∙library=_</a> <a id="7155" href="Types.html#6459" class="Function Operator">_∙library↝_</a>
  <a id="7169" href="Types.html#6496" class="Function Operator">_∙hand=_</a> <a id="7178" href="Types.html#6505" class="Function Operator">_∙hand↝_</a>
  <a id="7189" href="Types.html#6549" class="Function Operator">_∙graveyard=_</a> <a id="7203" href="Types.html#6563" class="Function Operator">_∙graveyard↝_</a>
  <a id="7219" href="Types.html#6604" class="Function Operator">_∙exile=_</a> <a id="7229" href="Types.html#6614" class="Function Operator">_∙exile↝_</a>
  <a id="7241" href="Types.html#6649" class="Function Operator">_∙life=_</a> <a id="7250" href="Types.html#6658" class="Function Operator">_∙life↝_</a>
  <a id="7261" href="Types.html#6698" class="Function Operator">_∙control=_</a> <a id="7273" href="Types.html#6710" class="Function Operator">_∙control↝_</a>

<a id="7286" class="Keyword">data</a> <a id="Turn"></a><a id="7291" href="Types.html#7291" class="Datatype">Turn</a> <a id="7296" class="Symbol">:</a> <a id="7298" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="7303" class="Keyword">where</a>
  <a id="Turn.on-the-play"></a><a id="7311" href="Types.html#7311" class="InductiveConstructor">on-the-play</a> <a id="Turn.on-the-draw"></a><a id="7323" href="Types.html#7323" class="InductiveConstructor">on-the-draw</a> <a id="7335" class="Symbol">:</a> <a id="7337" href="Types.html#7291" class="Datatype">Turn</a>

<a id="7343" class="Keyword">data</a> <a id="Phase"></a><a id="7348" href="Types.html#7348" class="Datatype">Phase</a> <a id="7354" class="Symbol">:</a> <a id="7356" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="7361" class="Keyword">where</a>
  <a id="Phase.draw"></a><a id="7369" href="Types.html#7369" class="InductiveConstructor">draw</a> <a id="Phase.main"></a><a id="7374" href="Types.html#7374" class="InductiveConstructor">main</a> <a id="7379" class="Symbol">:</a> <a id="7381" href="Types.html#7348" class="Datatype">Phase</a>

<a id="7388" class="Keyword">data</a> <a id="Outcome"></a><a id="7393" href="Types.html#7393" class="Datatype">Outcome</a> <a id="7401" class="Symbol">:</a> <a id="7403" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="7408" class="Keyword">where</a>
  <a id="Outcome.DRAW"></a><a id="7416" href="Types.html#7416" class="InductiveConstructor">DRAW</a> <a id="Outcome.𝟙-WINS"></a><a id="7421" href="Types.html#7421" class="InductiveConstructor">𝟙-WINS</a> <a id="Outcome.𝟚-WINS"></a><a id="7428" href="Types.html#7428" class="InductiveConstructor">𝟚-WINS</a> <a id="7435" class="Symbol">:</a> <a id="7437" href="Types.html#7393" class="Datatype">Outcome</a>

<a id="7446" class="Keyword">record</a> <a id="GameState"></a><a id="7453" href="Types.html#7453" class="Record">GameState</a> <a id="7463" class="Symbol">:</a> <a id="7465" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="7470" class="Keyword">where</a>
  <a id="7478" class="Keyword">field</a>
    <a id="GameState.player₁"></a><a id="7488" href="Types.html#7488" class="Field">player₁</a>  <a id="7497" class="Symbol">:</a> <a id="7499" href="Types.html#6164" class="Record">Player</a>
    <a id="GameState.player₂"></a><a id="7510" href="Types.html#7510" class="Field">player₂</a>  <a id="7519" class="Symbol">:</a> <a id="7521" href="Types.html#6164" class="Record">Player</a>

    <a id="GameState.curTurn"></a><a id="7533" href="Types.html#7533" class="Field">curTurn</a> <a id="7541" class="Symbol">:</a> <a id="7543" href="Types.html#7291" class="Datatype">Turn</a>
    <a id="GameState.turnTrans"></a><a id="7552" href="Types.html#7552" class="Field">turnTrans</a> <a id="7562" class="Symbol">:</a> <a id="7564" href="Algebra.Core.html#475" class="Function">Op₁</a> <a id="7568" href="Types.html#7291" class="Datatype">Turn</a>

    <a id="GameState.curPhase"></a><a id="7578" href="Types.html#7578" class="Field">curPhase</a> <a id="7587" class="Symbol">:</a> <a id="7589" href="Types.html#7348" class="Datatype">Phase</a>
    <a id="GameState.phaseTrans"></a><a id="7599" href="Types.html#7599" class="Field">phaseTrans</a> <a id="7610" class="Symbol">:</a> <a id="7612" href="Types.html#7348" class="Datatype">Phase</a> <a id="7618" class="Symbol">→</a> <a id="7620" href="Types.html#7348" class="Datatype">Phase</a>

    <a id="GameState.hasPlayedLand"></a><a id="7631" href="Types.html#7631" class="Field">hasPlayedLand</a> <a id="7645" class="Symbol">:</a> <a id="7647" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
    <a id="GameState.outcome"></a><a id="7656" href="Types.html#7656" class="Field">outcome</a> <a id="7664" class="Symbol">:</a> <a id="7666" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="7672" href="Types.html#7393" class="Datatype">Outcome</a>

<a id="7681" class="Keyword">open</a> <a id="7686" href="Types.html#7453" class="Module">GameState</a> <a id="7696" class="Keyword">public</a>
<a id="7703" class="Keyword">private</a> <a id="7711" class="Keyword">variable</a> <a id="7720" href="Types.html#7720" class="Generalizable">s</a> <a id="7722" href="Types.html#7722" class="Generalizable">s′</a> <a id="7725" href="Types.html#7725" class="Generalizable">s″</a> <a id="7728" class="Symbol">:</a> <a id="7730" href="Types.html#7453" class="Record">GameState</a>

<a id="7741" class="Keyword">unquoteDecl</a> <a id="𝕃"></a><a id="7753" href="Types.html#7753" class="Function">𝕃</a> <a id="_∙l"></a><a id="7755" href="Types.html#7755" class="Function Operator">_∙l</a> <a id="_∙l=_"></a><a id="7759" href="Types.html#7759" class="Function Operator">_∙l=_</a> <a id="_∙l↝_"></a><a id="7765" href="Types.html#7765" class="Function Operator">_∙l↝_</a>
            <a id="ℝ"></a><a id="7783" href="Types.html#7783" class="Function">ℝ</a> <a id="_∙r"></a><a id="7785" href="Types.html#7785" class="Function Operator">_∙r</a> <a id="_∙r=_"></a><a id="7789" href="Types.html#7789" class="Function Operator">_∙r=_</a> <a id="_∙r↝_"></a><a id="7795" href="Types.html#7795" class="Function Operator">_∙r↝_</a>
            <a id="$curTurn"></a><a id="7813" href="Types.html#7813" class="Function">$curTurn</a> <a id="_∙curTurn"></a><a id="7822" href="Types.html#7822" class="Function Operator">_∙curTurn</a> <a id="_∙curTurn=_"></a><a id="7832" href="Types.html#7832" class="Function Operator">_∙curTurn=_</a> <a id="_∙curTurn↝_"></a><a id="7844" href="Types.html#7844" class="Function Operator">_∙curTurn↝_</a>
            <a id="$turnTrans"></a><a id="7868" href="Types.html#7868" class="Function">$turnTrans</a> <a id="_∙turnTrans"></a><a id="7879" href="Types.html#7879" class="Function Operator">_∙turnTrans</a> <a id="_∙turnTrans=_"></a><a id="7891" href="Types.html#7891" class="Function Operator">_∙turnTrans=_</a> <a id="_∙turnTrans↝_"></a><a id="7905" href="Types.html#7905" class="Function Operator">_∙turnTrans↝_</a>
            <a id="$curPhase"></a><a id="7931" href="Types.html#7931" class="Function">$curPhase</a> <a id="_∙curPhase"></a><a id="7941" href="Types.html#7941" class="Function Operator">_∙curPhase</a> <a id="_∙curPhase=_"></a><a id="7952" href="Types.html#7952" class="Function Operator">_∙curPhase=_</a> <a id="_∙curPhase↝_"></a><a id="7965" href="Types.html#7965" class="Function Operator">_∙curPhase↝_</a>
            <a id="$phaseTrans"></a><a id="7990" href="Types.html#7990" class="Function">$phaseTrans</a> <a id="_∙phaseTrans"></a><a id="8002" href="Types.html#8002" class="Function Operator">_∙phaseTrans</a> <a id="_∙phaseTrans=_"></a><a id="8015" href="Types.html#8015" class="Function Operator">_∙phaseTrans=_</a> <a id="_∙phaseTrans↝_"></a><a id="8030" href="Types.html#8030" class="Function Operator">_∙phaseTrans↝_</a>
            <a id="$hasPlayedLand"></a><a id="8057" href="Types.html#8057" class="Function">$hasPlayedLand</a> <a id="_∙hasPlayedLand"></a><a id="8072" href="Types.html#8072" class="Function Operator">_∙hasPlayedLand</a> <a id="_∙hasPlayedLand=_"></a><a id="8088" href="Types.html#8088" class="Function Operator">_∙hasPlayedLand=_</a> <a id="_∙hasPlayedLand↝_"></a><a id="8106" href="Types.html#8106" class="Function Operator">_∙hasPlayedLand↝_</a>
            <a id="$outcome"></a><a id="8136" href="Types.html#8136" class="Function">$outcome</a> <a id="_∙outcome"></a><a id="8145" href="Types.html#8145" class="Function Operator">_∙outcome</a> <a id="_∙outcome=_"></a><a id="8155" href="Types.html#8155" class="Function Operator">_∙outcome=_</a> <a id="_∙outcome↝_"></a><a id="8167" href="Types.html#8167" class="Function Operator">_∙outcome↝_</a>
  <a id="8181" class="Symbol">=</a> <a id="8183" href="Prelude.Lenses.Derive.html#270" class="Function">deriveLenses</a> <a id="8196" class="Symbol">(</a><a id="8197" class="Keyword">quote</a> <a id="8203" href="Types.html#7453" class="Record">GameState</a><a id="8212" class="Symbol">)</a>
    <a id="8218" class="Symbol">(</a> <a id="8220" class="Symbol">(</a><a id="8221" href="Types.html#7753" class="Function">𝕃</a> <a id="8223" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8225" href="Types.html#7755" class="Function Operator">_∙l</a> <a id="8229" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8231" href="Types.html#7759" class="Function Operator">_∙l=_</a> <a id="8237" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8239" href="Types.html#7765" class="Function Operator">_∙l↝_</a><a id="8244" class="Symbol">)</a>
    <a id="8250" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8252" class="Symbol">(</a><a id="8253" href="Types.html#7783" class="Function">ℝ</a> <a id="8255" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8257" href="Types.html#7785" class="Function Operator">_∙r</a> <a id="8261" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8263" href="Types.html#7789" class="Function Operator">_∙r=_</a> <a id="8269" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8271" href="Types.html#7795" class="Function Operator">_∙r↝_</a><a id="8276" class="Symbol">)</a>
    <a id="8282" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8284" class="Symbol">(</a><a id="8285" href="Types.html#7813" class="Function">$curTurn</a> <a id="8294" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8296" href="Types.html#7822" class="Function Operator">_∙curTurn</a> <a id="8306" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8308" href="Types.html#7832" class="Function Operator">_∙curTurn=_</a> <a id="8320" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8322" href="Types.html#7844" class="Function Operator">_∙curTurn↝_</a><a id="8333" class="Symbol">)</a>
    <a id="8339" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8341" class="Symbol">(</a><a id="8342" href="Types.html#7868" class="Function">$turnTrans</a> <a id="8353" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8355" href="Types.html#7879" class="Function Operator">_∙turnTrans</a> <a id="8367" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8369" href="Types.html#7891" class="Function Operator">_∙turnTrans=_</a> <a id="8383" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8385" href="Types.html#7905" class="Function Operator">_∙turnTrans↝_</a><a id="8398" class="Symbol">)</a>
    <a id="8404" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8406" class="Symbol">(</a><a id="8407" href="Types.html#7931" class="Function">$curPhase</a> <a id="8417" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8419" href="Types.html#7941" class="Function Operator">_∙curPhase</a> <a id="8430" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8432" href="Types.html#7952" class="Function Operator">_∙curPhase=_</a> <a id="8445" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8447" href="Types.html#7965" class="Function Operator">_∙curPhase↝_</a><a id="8459" class="Symbol">)</a>
    <a id="8465" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8467" class="Symbol">(</a><a id="8468" href="Types.html#7990" class="Function">$phaseTrans</a> <a id="8480" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8482" href="Types.html#8002" class="Function Operator">_∙phaseTrans</a> <a id="8495" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8497" href="Types.html#8015" class="Function Operator">_∙phaseTrans=_</a> <a id="8512" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8514" href="Types.html#8030" class="Function Operator">_∙phaseTrans↝_</a><a id="8528" class="Symbol">)</a>
    <a id="8534" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8536" class="Symbol">(</a><a id="8537" href="Types.html#8057" class="Function">$hasPlayedLand</a> <a id="8552" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8554" href="Types.html#8072" class="Function Operator">_∙hasPlayedLand</a> <a id="8570" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8572" href="Types.html#8088" class="Function Operator">_∙hasPlayedLand=_</a> <a id="8590" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8592" href="Types.html#8106" class="Function Operator">_∙hasPlayedLand↝_</a><a id="8609" class="Symbol">)</a>
    <a id="8615" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8617" class="Symbol">(</a><a id="8618" href="Types.html#8136" class="Function">$outcome</a> <a id="8627" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8629" href="Types.html#8145" class="Function Operator">_∙outcome</a> <a id="8639" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8641" href="Types.html#8155" class="Function Operator">_∙outcome=_</a> <a id="8653" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8655" href="Types.html#8167" class="Function Operator">_∙outcome↝_</a><a id="8666" class="Symbol">)</a>
    <a id="8672" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8674" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="8676" class="Symbol">)</a>
<a id="8678" class="Keyword">infixl</a> <a id="8685" class="Number">10</a>
  <a id="8690" href="Types.html#7759" class="Function Operator">_∙l=_</a> <a id="8696" href="Types.html#7765" class="Function Operator">_∙l↝_</a>
  <a id="8704" href="Types.html#7789" class="Function Operator">_∙r=_</a> <a id="8710" href="Types.html#7795" class="Function Operator">_∙r↝_</a>
  <a id="8718" href="Types.html#7832" class="Function Operator">_∙curTurn=_</a> <a id="8730" href="Types.html#7844" class="Function Operator">_∙curTurn↝_</a>
  <a id="8744" href="Types.html#7891" class="Function Operator">_∙turnTrans=_</a> <a id="8758" href="Types.html#7905" class="Function Operator">_∙turnTrans↝_</a>
  <a id="8774" href="Types.html#7952" class="Function Operator">_∙curPhase=_</a> <a id="8787" href="Types.html#7965" class="Function Operator">_∙curPhase↝_</a>
  <a id="8802" href="Types.html#8015" class="Function Operator">_∙phaseTrans=_</a> <a id="8817" href="Types.html#8030" class="Function Operator">_∙phaseTrans↝_</a>
  <a id="8834" href="Types.html#8088" class="Function Operator">_∙hasPlayedLand=_</a> <a id="8852" href="Types.html#8106" class="Function Operator">_∙hasPlayedLand↝_</a>
  <a id="8872" href="Types.html#8155" class="Function Operator">_∙outcome=_</a> <a id="8884" href="Types.html#8167" class="Function Operator">_∙outcome↝_</a>

<a id="_∙curPlayer"></a><a id="8897" href="Types.html#8897" class="Function Operator">_∙curPlayer</a> <a id="_∙otherPlayer"></a><a id="8909" href="Types.html#8909" class="Function Operator">_∙otherPlayer</a> <a id="8923" class="Symbol">:</a> <a id="8925" href="Types.html#7453" class="Record">GameState</a> <a id="8935" class="Symbol">→</a> <a id="8937" href="Types.html#6164" class="Record">Player</a>
<a id="8944" href="Types.html#8944" class="Bound">s</a> <a id="8946" href="Types.html#8897" class="Function Operator">∙curPlayer</a> <a id="8957" class="Symbol">=</a> <a id="8959" href="Function.Base.html#4121" class="Function Operator">case</a> <a id="8964" href="Types.html#8944" class="Bound">s</a> <a id="8966" href="Types.html#7822" class="Function Operator">∙curTurn</a> <a id="8975" href="Function.Base.html#4121" class="Function Operator">of</a> <a id="8978" class="Symbol">λ</a> <a id="8980" class="Keyword">where</a>
  <a id="8988" href="Types.html#7311" class="InductiveConstructor">on-the-play</a> <a id="9000" class="Symbol">→</a> <a id="9002" href="Types.html#8944" class="Bound">s</a> <a id="9004" href="Types.html#7755" class="Function Operator">∙l</a>
  <a id="9009" href="Types.html#7323" class="InductiveConstructor">on-the-draw</a> <a id="9021" class="Symbol">→</a> <a id="9023" href="Types.html#8944" class="Bound">s</a> <a id="9025" href="Types.html#7785" class="Function Operator">∙r</a>
<a id="9028" href="Types.html#9028" class="Bound">s</a> <a id="9030" href="Types.html#8909" class="Function Operator">∙otherPlayer</a> <a id="9043" class="Symbol">=</a> <a id="9045" href="Function.Base.html#4121" class="Function Operator">case</a> <a id="9050" href="Types.html#9028" class="Bound">s</a> <a id="9052" href="Types.html#7822" class="Function Operator">∙curTurn</a> <a id="9061" href="Function.Base.html#4121" class="Function Operator">of</a> <a id="9064" class="Symbol">λ</a> <a id="9066" class="Keyword">where</a>
  <a id="9074" href="Types.html#7311" class="InductiveConstructor">on-the-play</a> <a id="9086" class="Symbol">→</a> <a id="9088" href="Types.html#9028" class="Bound">s</a> <a id="9090" href="Types.html#7785" class="Function Operator">∙r</a>
  <a id="9095" href="Types.html#7323" class="InductiveConstructor">on-the-draw</a> <a id="9107" class="Symbol">→</a> <a id="9109" href="Types.html#9028" class="Bound">s</a> <a id="9111" href="Types.html#7755" class="Function Operator">∙l</a>

<a id="9115" class="Keyword">instance</a>
  <a id="Default-Player"></a><a id="9126" href="Types.html#9126" class="Function">Default-Player</a> <a id="9141" class="Symbol">:</a> <a id="9143" href="Prelude.Default.html#676" class="Record">Default</a> <a id="9151" href="Types.html#6164" class="Record">Player</a>
  <a id="9160" href="Types.html#9126" class="Function">Default-Player</a> <a id="9175" class="Symbol">.</a><a id="9176" href="Prelude.Default.html#736" class="Field">def</a> <a id="9180" class="Symbol">=</a> <a id="9182" class="Symbol">λ</a> <a id="9184" class="Keyword">where</a>
    <a id="9194" class="Symbol">.</a><a id="9195" href="Types.html#6219" class="Field">name</a> <a id="9200" class="Symbol">→</a> <a id="9202" class="String">&quot;&quot;</a>
    <a id="9209" class="Symbol">.</a><a id="9210" href="Types.html#6237" class="Field">library</a> <a id="9218" class="Symbol">→</a> <a id="9220" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
    <a id="9227" class="Symbol">.</a><a id="9228" href="Types.html#6257" class="Field">hand</a> <a id="9233" class="Symbol">→</a> <a id="9235" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
    <a id="9242" class="Symbol">.</a><a id="9243" href="Types.html#6273" class="Field">graveyard</a> <a id="9253" class="Symbol">→</a> <a id="9255" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
    <a id="9262" class="Symbol">.</a><a id="9263" href="Types.html#6295" class="Field">exile</a> <a id="9269" class="Symbol">→</a> <a id="9271" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
    <a id="9278" class="Symbol">.</a><a id="9279" href="Types.html#6313" class="Field">life</a> <a id="9284" class="Symbol">→</a> <a id="9286" class="Number">0</a>
    <a id="9292" class="Symbol">.</a><a id="9293" href="Types.html#6326" class="Field">control</a> <a id="9301" class="Symbol">→</a> <a id="9303" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>

  <a id="Default-Turn"></a><a id="9309" href="Types.html#9309" class="Function">Default-Turn</a> <a id="9322" class="Symbol">:</a> <a id="9324" href="Prelude.Default.html#676" class="Record">Default</a> <a id="9332" href="Types.html#7291" class="Datatype">Turn</a>
  <a id="9339" href="Types.html#9309" class="Function">Default-Turn</a> <a id="9352" class="Symbol">.</a><a id="9353" href="Prelude.Default.html#736" class="Field">def</a> <a id="9357" class="Symbol">=</a> <a id="9359" href="Types.html#7311" class="InductiveConstructor">on-the-play</a>

  <a id="Default-TurnTrans"></a><a id="9374" href="Types.html#9374" class="Function">Default-TurnTrans</a> <a id="9392" class="Symbol">:</a> <a id="9394" href="Prelude.Default.html#676" class="Record">Default</a> <a id="9402" class="Symbol">(</a><a id="9403" href="Algebra.Core.html#475" class="Function">Op₁</a> <a id="9407" href="Types.html#7291" class="Datatype">Turn</a><a id="9411" class="Symbol">)</a>
  <a id="9415" href="Types.html#9374" class="Function">Default-TurnTrans</a> <a id="9433" class="Symbol">.</a><a id="9434" href="Prelude.Default.html#736" class="Field">def</a> <a id="9438" class="Symbol">=</a> <a id="9440" class="Symbol">λ</a> <a id="9442" class="Keyword">where</a>
    <a id="9452" href="Types.html#7323" class="InductiveConstructor">on-the-draw</a> <a id="9464" class="Symbol">→</a> <a id="9466" href="Types.html#7311" class="InductiveConstructor">on-the-play</a>
    <a id="9482" href="Types.html#7311" class="InductiveConstructor">on-the-play</a> <a id="9494" class="Symbol">→</a> <a id="9496" href="Types.html#7323" class="InductiveConstructor">on-the-draw</a>

  <a id="Default-Phase"></a><a id="9511" href="Types.html#9511" class="Function">Default-Phase</a> <a id="9525" class="Symbol">:</a> <a id="9527" href="Prelude.Default.html#676" class="Record">Default</a> <a id="9535" href="Types.html#7348" class="Datatype">Phase</a>
  <a id="9543" href="Types.html#9511" class="Function">Default-Phase</a> <a id="9557" class="Symbol">.</a><a id="9558" href="Prelude.Default.html#736" class="Field">def</a> <a id="9562" class="Symbol">=</a> <a id="9564" href="Types.html#7369" class="InductiveConstructor">draw</a>

  <a id="Default-PhaseTrans"></a><a id="9572" href="Types.html#9572" class="Function">Default-PhaseTrans</a> <a id="9591" class="Symbol">:</a> <a id="9593" href="Prelude.Default.html#676" class="Record">Default</a> <a id="9601" class="Symbol">(</a><a id="9602" href="Algebra.Core.html#475" class="Function">Op₁</a> <a id="9606" href="Types.html#7348" class="Datatype">Phase</a><a id="9611" class="Symbol">)</a>
  <a id="9615" href="Types.html#9572" class="Function">Default-PhaseTrans</a> <a id="9634" class="Symbol">.</a><a id="9635" href="Prelude.Default.html#736" class="Field">def</a> <a id="9639" class="Symbol">=</a> <a id="9641" class="Symbol">λ</a> <a id="9643" class="Keyword">where</a>
    <a id="9653" href="Types.html#7369" class="InductiveConstructor">draw</a> <a id="9658" class="Symbol">→</a> <a id="9660" href="Types.html#7374" class="InductiveConstructor">main</a>
    <a id="9669" href="Types.html#7374" class="InductiveConstructor">main</a> <a id="9674" class="Symbol">→</a> <a id="9676" href="Types.html#7369" class="InductiveConstructor">draw</a>

  <a id="Default-GameState"></a><a id="9684" href="Types.html#9684" class="Function">Default-GameState</a> <a id="9702" class="Symbol">:</a> <a id="9704" href="Prelude.Default.html#676" class="Record">Default</a> <a id="9712" href="Types.html#7453" class="Record">GameState</a>
  <a id="9724" href="Types.html#9684" class="Function">Default-GameState</a> <a id="9742" class="Symbol">.</a><a id="9743" href="Prelude.Default.html#736" class="Field">def</a> <a id="9747" class="Symbol">=</a> <a id="9749" class="Symbol">λ</a> <a id="9751" class="Keyword">where</a>
    <a id="9761" class="Symbol">.</a><a id="9762" href="Types.html#7488" class="Field">player₁</a> <a id="9770" class="Symbol">→</a> <a id="9772" href="Prelude.Default.html#736" class="Field">def</a>
    <a id="9780" class="Symbol">.</a><a id="9781" href="Types.html#7510" class="Field">player₂</a> <a id="9789" class="Symbol">→</a> <a id="9791" href="Prelude.Default.html#736" class="Field">def</a>
    <a id="9799" class="Symbol">.</a><a id="9800" href="Types.html#7533" class="Field">curTurn</a> <a id="9808" class="Symbol">→</a> <a id="9810" href="Prelude.Default.html#736" class="Field">def</a>
    <a id="9818" class="Symbol">.</a><a id="9819" href="Types.html#7552" class="Field">turnTrans</a> <a id="9829" class="Symbol">→</a> <a id="9831" href="Types.html#9374" class="Function">Default-TurnTrans</a> <a id="9849" class="Symbol">.</a><a id="9850" href="Prelude.Default.html#736" class="Field">def</a>
    <a id="9858" class="Symbol">.</a><a id="9859" href="Types.html#7578" class="Field">curPhase</a> <a id="9868" class="Symbol">→</a> <a id="9870" href="Prelude.Default.html#736" class="Field">def</a>
    <a id="9878" class="Symbol">.</a><a id="9879" href="Types.html#7599" class="Field">phaseTrans</a> <a id="9890" class="Symbol">→</a> <a id="9892" href="Types.html#9572" class="Function">Default-PhaseTrans</a> <a id="9911" class="Symbol">.</a><a id="9912" href="Prelude.Default.html#736" class="Field">def</a>
    <a id="9920" class="Symbol">.</a><a id="9921" href="Types.html#7631" class="Field">hasPlayedLand</a> <a id="9935" class="Symbol">→</a> <a id="9937" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a>
    <a id="9947" class="Symbol">.</a><a id="9948" href="Types.html#7656" class="Field">outcome</a> <a id="9956" class="Symbol">→</a> <a id="9958" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>

<a id="9967" class="Keyword">instance</a>
  <a id="Show-Player"></a><a id="9978" href="Types.html#9978" class="Function">Show-Player</a> <a id="9990" class="Symbol">:</a> <a id="9992" href="Prelude.Show.html#280" class="Record">Show</a> <a id="9997" href="Types.html#6164" class="Record">Player</a>
  <a id="10006" href="Types.html#9978" class="Function">Show-Player</a> <a id="10018" class="Symbol">.</a><a id="10019" href="Prelude.Show.html#315" class="Field">show</a> <a id="10024" href="Types.html#10024" class="Bound">p</a> <a id="10026" class="Symbol">=</a>
    <a id="10032" class="String">&quot;{name: &quot;</a> <a id="10042" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="10044" href="Prelude.Show.html#315" class="Field">show</a> <a id="10049" class="Symbol">(</a><a id="10050" href="Types.html#10024" class="Bound">p</a> <a id="10052" href="Types.html#6391" class="Function Operator">∙name</a><a id="10057" class="Symbol">)</a> <a id="10059" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="10061" class="String">&quot;,&quot;</a> <a id="10065" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a>
    <a id="10071" class="String">&quot;life: &quot;</a> <a id="10080" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="10082" href="Prelude.Show.html#315" class="Field">show</a> <a id="10087" class="Symbol">(</a><a id="10088" href="Types.html#10024" class="Bound">p</a> <a id="10090" href="Types.html#6642" class="Function Operator">∙life</a><a id="10095" class="Symbol">)</a> <a id="10097" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="10099" class="String">&quot;}&quot;</a>
    <a id="10107" class="Comment">-- &quot;hand: &quot; ◇</a>

  <a id="Show-Turn"></a><a id="10124" href="Types.html#10124" class="Function">Show-Turn</a> <a id="10134" class="Symbol">:</a> <a id="10136" href="Prelude.Show.html#280" class="Record">Show</a> <a id="10141" href="Types.html#7291" class="Datatype">Turn</a>
  <a id="10148" href="Types.html#10124" class="Function">Show-Turn</a> <a id="10158" class="Symbol">.</a><a id="10159" href="Prelude.Show.html#315" class="Field">show</a> <a id="10164" class="Symbol">=</a> <a id="10166" class="Symbol">λ</a> <a id="10168" class="Keyword">where</a>
    <a id="10178" href="Types.html#7311" class="InductiveConstructor">on-the-play</a> <a id="10190" class="Symbol">→</a> <a id="10192" class="String">&quot;on-the-play&quot;</a>
    <a id="10210" href="Types.html#7323" class="InductiveConstructor">on-the-draw</a> <a id="10222" class="Symbol">→</a> <a id="10224" class="String">&quot;on-the-draw&quot;</a>

  <a id="Show-Phase"></a><a id="10241" href="Types.html#10241" class="Function">Show-Phase</a> <a id="10252" class="Symbol">:</a> <a id="10254" href="Prelude.Show.html#280" class="Record">Show</a> <a id="10259" href="Types.html#7348" class="Datatype">Phase</a>
  <a id="10267" href="Types.html#10241" class="Function">Show-Phase</a> <a id="10278" class="Symbol">.</a><a id="10279" href="Prelude.Show.html#315" class="Field">show</a> <a id="10284" class="Symbol">=</a> <a id="10286" class="Symbol">λ</a> <a id="10288" class="Keyword">where</a>
    <a id="10298" href="Types.html#7369" class="InductiveConstructor">draw</a> <a id="10303" class="Symbol">→</a> <a id="10305" class="String">&quot;draw&quot;</a>
    <a id="10316" href="Types.html#7374" class="InductiveConstructor">main</a> <a id="10321" class="Symbol">→</a> <a id="10323" class="String">&quot;main&quot;</a>

  <a id="Show-GameState"></a><a id="10333" href="Types.html#10333" class="Function">Show-GameState</a> <a id="10348" class="Symbol">:</a> <a id="10350" href="Prelude.Show.html#280" class="Record">Show</a> <a id="10355" href="Types.html#7453" class="Record">GameState</a>
  <a id="10367" href="Types.html#10333" class="Function">Show-GameState</a> <a id="10382" class="Symbol">.</a><a id="10383" href="Prelude.Show.html#315" class="Field">show</a> <a id="10388" href="Types.html#10388" class="Bound">s</a> <a id="10390" class="Symbol">=</a>
    <a id="10396" class="String">&quot;player₁: &quot;</a> <a id="10408" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="10410" href="Prelude.Show.html#315" class="Field">show</a> <a id="10415" class="Symbol">(</a><a id="10416" href="Types.html#10388" class="Bound">s</a> <a id="10418" href="Types.html#7755" class="Function Operator">∙l</a><a id="10420" class="Symbol">)</a> <a id="10422" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="10424" class="String">&quot;\n&quot;</a> <a id="10429" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a>
    <a id="10435" class="String">&quot;player₂: &quot;</a> <a id="10447" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="10449" href="Prelude.Show.html#315" class="Field">show</a> <a id="10454" class="Symbol">(</a><a id="10455" href="Types.html#10388" class="Bound">s</a> <a id="10457" href="Types.html#7785" class="Function Operator">∙r</a><a id="10459" class="Symbol">)</a> <a id="10461" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="10463" class="String">&quot;\n&quot;</a> <a id="10468" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a>
    <a id="10474" class="String">&quot;curTurn: &quot;</a> <a id="10486" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="10488" href="Prelude.Show.html#315" class="Field">show</a> <a id="10493" class="Symbol">(</a><a id="10494" href="Types.html#10388" class="Bound">s</a> <a id="10496" href="Types.html#7822" class="Function Operator">∙curTurn</a><a id="10504" class="Symbol">)</a> <a id="10506" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="10508" class="String">&quot;\n&quot;</a> <a id="10513" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a>
    <a id="10519" class="String">&quot;curPhase: &quot;</a> <a id="10532" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="10534" href="Prelude.Show.html#315" class="Field">show</a> <a id="10539" class="Symbol">(</a><a id="10540" href="Types.html#10388" class="Bound">s</a> <a id="10542" href="Types.html#7941" class="Function Operator">∙curPhase</a><a id="10551" class="Symbol">)</a> <a id="10553" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="10555" class="String">&quot;\n&quot;</a>

<a id="p₁≢p₂"></a><a id="10561" href="Types.html#10561" class="Function">p₁≢p₂</a> <a id="10567" class="Symbol">:</a> <a id="10569" href="Types.html#7488" class="Field">player₁</a> <a id="10577" href="Relation.Binary.PropositionalEquality.Core.html#830" class="Function Operator">≢</a> <a id="10579" href="Types.html#7510" class="Field">player₂</a>
<a id="10587" href="Types.html#10561" class="Function">p₁≢p₂</a> <a id="10593" href="Types.html#10593" class="Bound">eq</a> <a id="10596" class="Symbol">=</a>
  <a id="10600" href="Function.Base.html#4121" class="Function Operator">case</a> <a id="10605" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a> <a id="10610" class="Symbol">(</a><a id="10611" href="Types.html#6391" class="Function Operator">_∙name</a><a id="10617" class="Symbol">)</a>
     <a id="10624" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="10626" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a> <a id="10631" class="Symbol">(</a><a id="10632" href="Function.Base.html#1919" class="Function Operator">_$</a> <a id="10635" href="Prelude.Default.html#736" class="Field">def</a> <a id="10639" href="Types.html#7795" class="Function Operator">∙r↝</a> <a id="10643" class="Symbol">(</a><a id="10644" href="Types.html#6398" class="Function Operator">_∙name=</a> <a id="10652" class="String">&quot;sth&quot;</a><a id="10657" class="Symbol">))</a> <a id="10660" href="Types.html#10593" class="Bound">eq</a>
  <a id="10665" href="Function.Base.html#4121" class="Function Operator">of</a> <a id="10668" class="Symbol">λ</a> <a id="10670" class="Symbol">()</a>

<a id="𝕃≢ℝ"></a><a id="10674" href="Types.html#10674" class="Function">𝕃≢ℝ</a> <a id="10678" class="Symbol">:</a> <a id="10680" href="Types.html#7753" class="Function">𝕃</a> <a id="10682" href="Relation.Binary.PropositionalEquality.Core.html#830" class="Function Operator">≢</a> <a id="10684" href="Types.html#7783" class="Function">ℝ</a>
<a id="10686" href="Types.html#10674" class="Function">𝕃≢ℝ</a> <a id="10690" class="Symbol">=</a> <a id="10692" href="Types.html#10561" class="Function">p₁≢p₂</a> <a id="10698" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="10700" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a> <a id="10705" href="Prelude.Lenses.Core.html#403" class="Field">get</a>

<a id="mkWin"></a><a id="10710" href="Types.html#10710" class="Function">mkWin</a> <a id="10716" class="Symbol">:</a> <a id="10718" href="Types.html#7291" class="Datatype">Turn</a> <a id="10723" class="Symbol">→</a> <a id="10725" href="Types.html#7393" class="Datatype">Outcome</a>
<a id="10733" href="Types.html#10710" class="Function">mkWin</a> <a id="10739" class="Symbol">=</a> <a id="10741" class="Symbol">λ</a> <a id="10743" class="Keyword">where</a>
  <a id="10751" href="Types.html#7311" class="InductiveConstructor">on-the-play</a> <a id="10763" class="Symbol">→</a> <a id="10765" href="Types.html#7421" class="InductiveConstructor">𝟙-WINS</a>
  <a id="10774" href="Types.html#7323" class="InductiveConstructor">on-the-draw</a> <a id="10786" class="Symbol">→</a> <a id="10788" href="Types.html#7428" class="InductiveConstructor">𝟚-WINS</a>

<a id="toControl"></a><a id="10796" href="Types.html#10796" class="Function">toControl</a> <a id="10806" class="Symbol">:</a> <a id="10808" class="Symbol">∀</a> <a id="10810" href="Types.html#10810" class="Bound">c</a> <a id="10812" class="Symbol">→</a> <a id="10814" href="Types.html#5365" class="Function">Properties</a> <a id="10825" href="Types.html#10810" class="Bound">c</a>
<a id="10827" href="Types.html#10796" class="Function">toControl</a> <a id="10837" class="Symbol">=</a> <a id="10839" class="Symbol">λ</a> <a id="10841" class="Keyword">where</a>
  <a id="10849" class="Symbol">(</a><a id="10850" href="Types.html#4353" class="InductiveConstructor">BasicLand</a> <a id="10860" class="Symbol">_)</a>    <a id="10866" class="Symbol">→</a> <a id="10868" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a>
  <a id="10873" class="Symbol">(</a><a id="10874" href="Types.html#4381" class="InductiveConstructor">Creature</a> <a id="10883" class="Symbol">_</a> <a id="10885" class="Symbol">_</a> <a id="10887" class="Symbol">_)</a> <a id="10890" class="Symbol">→</a> <a id="10892" class="Keyword">record</a> <a id="10899" class="Symbol">{</a><a id="10900" href="Types.html#5308" class="Field">summoningSickness</a> <a id="10918" class="Symbol">=</a> <a id="10920" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a><a id="10924" class="Symbol">}</a>

<a id="defInstance"></a><a id="10927" href="Types.html#10927" class="Function">defInstance</a> <a id="10939" class="Symbol">:</a> <a id="10941" href="Types.html#4333" class="Datatype">Card</a> <a id="10946" class="Symbol">→</a> <a id="10948" href="Types.html#5495" class="Record">CardInstance</a>
<a id="10961" href="Types.html#10927" class="Function">defInstance</a> <a id="10973" href="Types.html#10973" class="Bound">c</a> <a id="10975" class="Symbol">=</a> <a id="10977" class="Keyword">record</a> <a id="10984" class="Symbol">{</a><a id="10985" href="Types.html#5533" class="Field">card</a> <a id="10990" class="Symbol">=</a> <a id="10992" href="Types.html#10973" class="Bound">c</a><a id="10993" class="Symbol">;</a> <a id="10995" href="Types.html#5549" class="Field">tapped</a> <a id="11002" class="Symbol">=</a> <a id="11004" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a><a id="11009" class="Symbol">;</a> <a id="11011" href="Types.html#5567" class="Field">properties</a> <a id="11022" class="Symbol">=</a> <a id="11024" href="Types.html#10796" class="Function">toControl</a> <a id="11034" href="Types.html#10973" class="Bound">c</a><a id="11035" class="Symbol">}</a>

<a id="11038" class="Keyword">infix</a> <a id="11044" class="Number">4</a> <a id="11046" href="Types.html#11055" class="Datatype Operator">_↝_</a>
<a id="11050" class="Keyword">data</a> <a id="_↝_"></a><a id="11055" href="Types.html#11055" class="Datatype Operator">_↝_</a> <a id="11059" class="Symbol">:</a> <a id="11061" href="Prelude.Init.html#11514" class="Function">Rel₀</a> <a id="11066" href="Types.html#7453" class="Record">GameState</a> <a id="11076" class="Keyword">where</a>

  <a id="_↝_.DrawLose"></a><a id="11085" href="Types.html#11085" class="InductiveConstructor">DrawLose</a> <a id="11094" class="Symbol">:</a>
    <a id="11100" href="Prelude.InferenceRules.html#56066" class="Function Operator">∙</a> <a id="11102" href="Data.Maybe.html#852" class="Function">Is-nothing</a> <a id="11113" class="Symbol">(</a><a id="11114" href="Types.html#7720" class="Generalizable">s</a> <a id="11116" href="Types.html#8145" class="Function Operator">∙outcome</a><a id="11124" class="Symbol">)</a>
    <a id="11130" href="Prelude.InferenceRules.html#56000" class="Function Operator">∙</a> <a id="11132" class="Symbol">(</a><a id="11133" href="Types.html#7720" class="Generalizable">s</a> <a id="11135" href="Types.html#7941" class="Function Operator">∙curPhase</a> <a id="11145" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="11147" href="Types.html#7369" class="InductiveConstructor">draw</a><a id="11151" class="Symbol">)</a>
    <a id="11157" href="Prelude.InferenceRules.html#56000" class="Function Operator">∙</a> <a id="11159" class="Symbol">(</a><a id="11160" href="Types.html#7720" class="Generalizable">s</a> <a id="11162" href="Types.html#8897" class="Function Operator">∙curPlayer</a> <a id="11173" href="Types.html#6437" class="Function Operator">∙library</a> <a id="11182" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="11184" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="11186" class="Symbol">)</a>
      <a id="11194" href="Prelude.InferenceRules.html#13655" class="Function Operator">─────────────────────────────────</a>
      <a id="11234" href="Types.html#7720" class="Generalizable">s</a> <a id="11236" href="Types.html#11055" class="Datatype Operator">↝</a> <a id="11238" href="Types.html#7720" class="Generalizable">s</a> <a id="11240" href="Types.html#8155" class="Function Operator">∙outcome=</a> <a id="11250" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="11255" class="Symbol">(</a><a id="11256" href="Types.html#10710" class="Function">mkWin</a> <a id="11262" class="Symbol">(</a><a id="11263" href="Types.html#7720" class="Generalizable">s</a> <a id="11265" href="Types.html#7822" class="Function Operator">∙curTurn</a><a id="11273" class="Symbol">)</a> <a id="11275" class="Symbol">)</a>

  <a id="11280" class="Comment">-- Draw : ∀ (player : Lens GameState Player) →</a>
  <a id="11329" class="Comment">--   let p   = player .get s</a>
  <a id="11360" class="Comment">--       p=_ = player .set s</a>
  <a id="11391" class="Comment">--       p↝_ = (player ∙modify) s</a>

  <a id="11428" class="Comment">--       lib = p ∙library</a>
  <a id="11456" class="Comment">--   in</a>
  <a id="11466" class="Comment">--   (lib≡ : lib ≡ c ∷ lib′) →</a>
  <a id="11499" class="Comment">--   IsLand c →</a>
  <a id="11517" class="Comment">--   -- ¬ T (s ∙hasPlayedLand)</a>
  <a id="11550" class="Comment">--   ─────────────────────────────────</a>
  <a id="11591" class="Comment">--   s ↝ p↝ ( _∙hand↝ (c ∷_)</a>
  <a id="11622" class="Comment">--          ∘ _∙lib=  lib′</a>
  <a id="11651" class="Comment">--          )</a>

  <a id="_↝_.PlayLand"></a><a id="11668" href="Types.html#11668" class="InductiveConstructor">PlayLand</a> <a id="11677" class="Symbol">:</a> <a id="11679" class="Symbol">∀</a> <a id="11681" class="Symbol">(</a><a id="11682" href="Types.html#11682" class="Bound">player</a> <a id="11689" class="Symbol">:</a> <a id="11691" href="Prelude.Lenses.Core.html#374" class="Record">Lens</a> <a id="11696" href="Types.html#7453" class="Record">GameState</a> <a id="11706" href="Types.html#6164" class="Record">Player</a><a id="11712" class="Symbol">)</a> <a id="11714" class="Symbol">→</a>
    <a id="11720" class="Keyword">let</a> <a id="11724" href="Types.html#11724" class="Bound">p</a>   <a id="11728" class="Symbol">=</a> <a id="11730" href="Types.html#11682" class="Bound">player</a> <a id="11737" class="Symbol">.</a><a id="11738" href="Prelude.Lenses.Core.html#403" class="Field">get</a> <a id="11742" href="Types.html#7720" class="Generalizable">s</a>
        <a id="11752" href="Types.html#11752" class="Bound Operator">p=_</a> <a id="11756" class="Symbol">=</a> <a id="11758" href="Types.html#11682" class="Bound">player</a> <a id="11765" class="Symbol">.</a><a id="11766" href="Prelude.Lenses.Core.html#424" class="Field">set</a> <a id="11770" href="Types.html#7720" class="Generalizable">s</a>
        <a id="11780" href="Types.html#11780" class="Bound Operator">p↝_</a> <a id="11784" class="Symbol">=</a> <a id="11786" class="Symbol">(</a><a id="11787" href="Types.html#11682" class="Bound">player</a> <a id="11794" href="Prelude.Lenses.Core.html#496" class="Function Operator">∙modify</a><a id="11801" class="Symbol">)</a> <a id="11803" href="Types.html#7720" class="Generalizable">s</a>

        <a id="11814" href="Types.html#11814" class="Bound">h</a>   <a id="11818" class="Symbol">=</a> <a id="11820" href="Types.html#11724" class="Bound">p</a> <a id="11822" href="Types.html#6489" class="Function Operator">∙hand</a>
    <a id="11832" class="Keyword">in</a>
    <a id="11839" class="Symbol">(</a><a id="11840" href="Types.html#11840" class="Bound">c∈</a> <a id="11843" class="Symbol">:</a> <a id="11845" href="Types.html#4534" class="Generalizable">c</a> <a id="11847" href="Prelude.Membership.html#379" class="Field Operator">∈</a> <a id="11849" href="Types.html#11814" class="Bound">h</a><a id="11850" class="Symbol">)</a> <a id="11852" class="Symbol">→</a>
    <a id="11858" href="Types.html#5112" class="Function">IsLand</a> <a id="11865" href="Types.html#4534" class="Generalizable">c</a> <a id="11867" class="Symbol">→</a>
    <a id="11873" class="Comment">-- ¬ T (s ∙hasPlayedLand)</a>
    <a id="11903" href="Prelude.InferenceRules.html#45114" class="Function Operator">─────────────────────────────────</a>
    <a id="11941" href="Types.html#7720" class="Generalizable">s</a> <a id="11943" href="Types.html#11055" class="Datatype Operator">↝</a> <a id="11945" href="Types.html#11780" class="Bound Operator">p↝</a> <a id="11948" class="Symbol">(</a> <a id="11950" href="Types.html#6710" class="Function Operator">_∙control↝</a> <a id="11961" class="Symbol">(</a><a id="11962" href="Types.html#10927" class="Function">defInstance</a> <a id="11974" href="Types.html#4534" class="Generalizable">c</a> <a id="11976" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷_</a><a id="11978" class="Symbol">)</a>
           <a id="11991" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="11993" href="Types.html#6496" class="Function Operator">_∙hand=</a>    <a id="12004" href="Prelude.Lists.Indexed.html#772" class="Function">remove</a> <a id="12011" href="Types.html#11814" class="Bound">h</a> <a id="12013" class="Symbol">(</a><a id="12014" href="Data.List.Relation.Unary.Any.html#1817" class="Function">L.Any.index</a> <a id="12026" href="Types.html#11840" class="Bound">c∈</a><a id="12028" class="Symbol">)</a>
           <a id="12041" class="Symbol">)</a>
        <a id="12051" class="Comment">-- ∙hasPlayedLand= true</a>

  <a id="12078" class="Comment">-- PlayCreature : ∀ (player : Lens GameState Player) →</a>
  <a id="12135" class="Comment">--   let p   = player .get s</a>
  <a id="12166" class="Comment">--       p=_ = player .set s</a>
  <a id="12197" class="Comment">--       p↝_ = (player ∙modify) s</a>

  <a id="12234" class="Comment">--       h    = p ∙hand</a>
  <a id="12260" class="Comment">--   in</a>
  <a id="12270" class="Comment">--   (c∈ : c ∈ h) →</a>
  <a id="12292" class="Comment">--   IsCreature c →</a>
  <a id="12314" class="Comment">--   c ∙cost ≤ curManaPool →</a>
  <a id="12345" class="Comment">--   ─────────────────────────────────</a>
  <a id="12386" class="Comment">--   s ↝ p↝ ( _∙control↝ (defInstance c ∷_)</a>
  <a id="12432" class="Comment">--          ∘ _∙hand=    remove h (L.Any.index c∈)</a>
  <a id="12485" class="Comment">--          )</a>

<a id="12500" class="Keyword">open</a> <a id="12505" href="Prelude.Closures.html#8217" class="Module">ReflexiveTransitiveClosure</a> <a id="12532" href="Types.html#11055" class="Datatype Operator">_↝_</a> <a id="12536" class="Keyword">public</a>
  <a id="12545" class="Keyword">using</a> <a id="12551" class="Symbol">(</a><a id="12552" href="Prelude.Closures.html#8395" class="InductiveConstructor Operator">begin_</a><a id="12558" class="Symbol">;</a> <a id="12560" href="Prelude.Closures.html#8462" class="InductiveConstructor Operator">_∎</a><a id="12562" class="Symbol">)</a>
  <a id="12566" class="Keyword">renaming</a> <a id="12575" class="Symbol">(</a><a id="12576" href="Prelude.Closures.html#8484" class="InductiveConstructor Operator">_—→⟨_⟩_</a> <a id="12584" class="Symbol">to</a> <a id="12587" class="InductiveConstructor Operator">_↝⟨_⟩_</a><a id="12593" class="Symbol">;</a> <a id="12595" href="Prelude.Closures.html#8437" class="Datatype Operator">_—↠_</a> <a id="12600" class="Symbol">to</a> <a id="12603" class="Datatype Operator">_↝∗_</a><a id="12607" class="Symbol">)</a>

<a id="12610" class="Keyword">private</a>
  <a id="S"></a><a id="12620" href="Types.html#12620" class="Function">S</a>  <a id="12623" class="Symbol">=</a> <a id="12625" href="Prelude.Default.html#736" class="Field">def</a> <a id="12629" href="Types.html#7765" class="Function Operator">∙l↝</a> <a id="12633" class="Symbol">(</a> <a id="12635" href="Types.html#6398" class="Function Operator">_∙name=</a> <a id="12643" class="String">&quot;Orestis&quot;</a>
               <a id="12668" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="12670" href="Types.html#6496" class="Function Operator">_∙hand=</a> <a id="12678" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="12680" href="Types.html#4575" class="Function">Forest</a> <a id="12687" href="Data.List.Base.html#5025" class="Function Operator">]</a> <a id="12689" class="Symbol">)</a>
           <a id="12702" href="Types.html#7795" class="Function Operator">∙r↝</a> <a id="12706" class="Symbol">(</a><a id="12707" href="Types.html#6398" class="Function Operator">_∙name=</a> <a id="12715" class="String">&quot;Kokos&quot;</a><a id="12722" class="Symbol">)</a>
  <a id="S′"></a><a id="12726" href="Types.html#12726" class="Function">S′</a> <a id="12729" class="Symbol">=</a> <a id="12731" href="Types.html#12620" class="Function">S</a> <a id="12733" href="Types.html#7765" class="Function Operator">∙l↝</a> <a id="12737" class="Symbol">(</a> <a id="12739" href="Types.html#6496" class="Function Operator">_∙hand=</a>    <a id="12750" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
             <a id="12766" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="12768" href="Types.html#6698" class="Function Operator">_∙control=</a> <a id="12779" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="12781" href="Types.html#10927" class="Function">defInstance</a> <a id="12793" href="Types.html#4575" class="Function">Forest</a> <a id="12800" href="Data.List.Base.html#5025" class="Function Operator">]</a> <a id="12802" class="Symbol">)</a>

  <a id="12807" href="Types.html#12807" class="Function">_</a> <a id="12809" class="Symbol">:</a> <a id="12811" href="Types.html#12620" class="Function">S</a> <a id="12813" href="Types.html#12603" class="Datatype Operator">↝∗</a> <a id="12816" href="Types.html#12726" class="Function">S′</a>
  <a id="12821" class="Symbol">_</a> <a id="12823" class="Symbol">=</a> <a id="12825" href="Prelude.Closures.html#8395" class="InductiveConstructor Operator">begin</a>
      <a id="12837" href="Types.html#12620" class="Function">S</a>
    <a id="12843" href="Types.html#12587" class="InductiveConstructor Operator">↝⟨</a> <a id="12846" href="Types.html#11668" class="InductiveConstructor">PlayLand</a> <a id="12855" href="Types.html#7753" class="Function">𝕃</a> <a id="12857" href="Prelude.Decidable.html#212" class="Function">auto</a> <a id="12862" href="Prelude.Decidable.html#212" class="Function">auto</a> <a id="12867" href="Types.html#12587" class="InductiveConstructor Operator">⟩</a>
      <a id="12875" href="Types.html#12726" class="Function">S′</a>
    <a id="12882" href="Prelude.Closures.html#8462" class="InductiveConstructor Operator">∎</a>

  <a id="12887" class="Comment">-- _ : S ↝∗ S′</a>
  <a id="12904" class="Comment">-- _ = begin</a>
  <a id="12919" class="Comment">--     ...</a>
  <a id="12932" class="Comment">--   ↝⟨ PlayLand 𝕃 auto auto ⟩</a>
  <a id="12965" class="Comment">--     ...</a>
  <a id="12978" class="Comment">--   ↝⟨ PlayLand ℝ auto auto ⟩</a>
  <a id="13011" class="Comment">--     ...</a>
  <a id="13024" class="Comment">--   ∎</a>

  <a id="13034" class="Comment">-- _ : S ↝∗ S′</a>
  <a id="13051" class="Comment">-- _ = begin</a>
  <a id="13066" class="Comment">--     ...</a>
  <a id="13079" class="Comment">--   ↝⟨ PlayLand 𝕃 auto auto ⟩</a>
  <a id="13112" class="Comment">--   ↝⟨ PlayLand 𝕃 auto auto ⟩</a>
  <a id="13145" class="Comment">--     ...</a>
  <a id="13158" class="Comment">--   ∎</a>

  <a id="13168" class="Comment">-- _ : S ↝∗ S′</a>
  <a id="13185" class="Comment">-- _ = begin</a>
  <a id="13200" class="Comment">--   {S}</a>
  <a id="13211" class="Comment">--   --TURNS</a>
  <a id="13226" class="Comment">--   𝕃: --PHASES</a>
  <a id="13245" class="Comment">--     {S}</a>
  <a id="13258" class="Comment">--     DRAW: Forest</a>
  <a id="13280" class="Comment">--     {S₁}</a>
  <a id="13294" class="Comment">--     MAIN:</a>
  <a id="13309" class="Comment">--       ∙ play land (Forest)</a>
  <a id="13341" class="Comment">--     {S₂}</a>
  <a id="13355" class="Comment">--   ℝ:</a>
  <a id="13365" class="Comment">--     {S₂}</a>
  <a id="13379" class="Comment">--     DRAW: ToxicGnarler</a>
  <a id="13407" class="Comment">--     {S₃}</a>
  <a id="13421" class="Comment">--     MAIN:</a>
  <a id="13436" class="Comment">--       ∙ play land (Mountain)</a>
  <a id="13470" class="Comment">--     {S₄}</a>
  <a id="13484" class="Comment">--   𝕃:</a>
  <a id="13494" class="Comment">--     {S₄}</a>
  <a id="13508" class="Comment">--     DRAW: TreeHugger</a>
  <a id="13534" class="Comment">--     {S₅}</a>
  <a id="13548" class="Comment">--     MAIN:</a>
  <a id="13563" class="Comment">--       ∙ play creature (TreeHugger)</a>
  <a id="13603" class="Comment">--     {S₆}</a>
  <a id="13617" class="Comment">--   ℝ:</a>
  <a id="13627" class="Comment">--     DRAW: Mountain</a>
  <a id="13651" class="Comment">--     MAIN:</a>
  <a id="13666" class="Comment">--       ∙ play land (Mountain)</a>
  <a id="13700" class="Comment">--       ∙ play creature (ToxicGnarler)</a>
  <a id="13742" class="Comment">--   {S′}</a>
  <a id="13754" class="Comment">--   ∎</a>

<a id="13762" class="Comment">{-

removeSummoningSickness : Player → Player
removeSummoningSickness p = p {control = go &lt;$&gt; p .control}
  where
    goProps : Op₁ CreatureProperties
    goProps ps = record ps {summoningSickness = false}

    go : Op₁ CardInstance
    go ci@(record {card = c; properties = ps})
      with ci .card
    ... | BasicLand _    = ci
    ... | Creature _ _ _ = ? -- record ci {properties = goProps ps}
-}</a>

<a id="14164" class="Comment">-- data DRAW⟨_↝_⟩ : Player → Maybe Player → Type where</a>

<a id="14220" class="Comment">--   drawFail :</a>

<a id="14237" class="Comment">--     p .library ≡ []</a>
<a id="14260" class="Comment">--     ───────────────────</a>
<a id="14287" class="Comment">--     DRAW⟨ p ↝ nothing ⟩</a>

<a id="14315" class="Comment">--   drawSuccess :</a>

<a id="14335" class="Comment">--     p .library ≡ c ∷ cs</a>
<a id="14362" class="Comment">--     ─────────────────────────────────────────────────────────</a>
<a id="14427" class="Comment">--     DRAW⟨ p ↝ just (p { library = cs; hand = c ∷ p .hand } ⟩</a>

<a id="14492" class="Comment">-- data MAIN⟨_↝_⟩ : Player → Maybe Player → Type where</a>

<a id="14548" class="Comment">--    curState .players ≡ p ∷ ps</a>
<a id="14581" class="Comment">--   DRAW⟨ p ↝ nothing ⟩</a>
<a id="14606" class="Comment">--   ─────────────────────────────────────────────────────────</a>
<a id="14669" class="Comment">--   FinalState</a>

<a id="14686" class="Comment">-- prepare : GameState → GameState</a>
<a id="14721" class="Comment">-- prepare st = st {players = removeSummoningSickness &lt;$&gt; st .players}</a>

<a id="14793" class="Comment">--   executeAllPhases :</a>
<a id="14817" class="Comment">--     ∙ DRAW⟨ st₀ ↝ st₁ ⟩</a>
<a id="14844" class="Comment">--     ∙ MAIN⟨ st₁ ↝ st₂ ⟩</a>
<a id="14871" class="Comment">--     ∙ ATTACK⟨ st₂ ↝ st₃ ⟩</a>
<a id="14900" class="Comment">--     -- ∙ POST⟨ st₃ ↝ st₄ ⟩</a>
<a id="14930" class="Comment">--     -- ∙ END⟨  ⟩</a>
<a id="14950" class="Comment">--       ─────────────────</a>
<a id="14977" class="Comment">--       st₀ ↝ st₄</a>

<a id="14997" class="Comment">{- ** Parsing/pretty-printing: interface to the outside world.
  instance
    Parser ManaCost : String → Maybe ManaCost
    Show ManaCost : ManaCost → String

  Input —— parse ——→ Semiring/Monoid
                          ∣
                     -—  show
                       \  ∣
                        \ ↓
                          String

  0) Input: 5W(U|B)
  1) Parse: 5*Any ◇ 1*W ◇ 1*(U|B)
  2) ... analysis ...
  3) Show: 5W(U|B)

  1) Given a cost, 5*Any ◇ 1*W ◇ 1*(U|B) ◇ 1*W
  2) ... analysis ...
  3) Show: 5W(U|B)W or Show⁺⁺: 5W(U|B)----
-}</a>
</pre></body></html>