<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Types</title><link rel="stylesheet" href="css/Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="Types.html" class="Module">Types</a> <a id="14" class="Keyword">where</a>

<a id="21" class="Keyword">open</a> <a id="26" class="Keyword">import</a> <a id="33" href="Prelude.Init.html" class="Module">Prelude.Init</a>
<a id="46" class="Keyword">open</a> <a id="51" href="Prelude.Init.html#35" class="Module">SetAsType</a>
<a id="61" class="Keyword">open</a> <a id="66" class="Keyword">import</a> <a id="73" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="87" class="Keyword">open</a> <a id="92" class="Keyword">import</a> <a id="99" href="Prelude.Semigroup.html" class="Module">Prelude.Semigroup</a>
<a id="117" class="Comment">-- import Prelude.Maps.Concrete as M</a>
<a id="154" class="Keyword">open</a> <a id="159" class="Keyword">import</a> <a id="166" href="Prelude.Maps.Concrete.html" class="Module">Prelude.Maps.Concrete</a>
<a id="188" class="Keyword">import</a> <a id="195" href="Prelude.Sets.Concrete.html" class="Module">Prelude.Sets.Concrete</a> <a id="217" class="Symbol">as</a> <a id="220" class="Module">S</a>
<a id="222" class="Comment">-- open import Prelude.Sets.Concrete</a>
<a id="259" class="Comment">-- open import Prelude.Lists</a>
<a id="288" class="Keyword">open</a> <a id="293" class="Keyword">import</a> <a id="300" href="Prelude.DecLists.html" class="Module">Prelude.DecLists</a>
<a id="317" class="Keyword">open</a> <a id="322" class="Keyword">import</a> <a id="329" href="Prelude.FromList.html" class="Module">Prelude.FromList</a>
<a id="346" class="Keyword">open</a> <a id="351" class="Keyword">import</a> <a id="358" href="Prelude.ToList.html" class="Module">Prelude.ToList</a>
<a id="373" class="Keyword">open</a> <a id="378" class="Keyword">import</a> <a id="385" href="Prelude.Nary.html" class="Module">Prelude.Nary</a>
<a id="398" class="Keyword">open</a> <a id="403" class="Keyword">import</a> <a id="410" href="Prelude.Functor.html" class="Module">Prelude.Functor</a>
<a id="426" class="Keyword">open</a> <a id="431" class="Keyword">import</a> <a id="438" href="Prelude.Decidable.html" class="Module">Prelude.Decidable</a>
<a id="456" class="Keyword">open</a> <a id="461" class="Keyword">import</a> <a id="468" href="Prelude.Ord.html" class="Module">Prelude.Ord</a>
<a id="480" class="Keyword">open</a> <a id="485" class="Keyword">import</a> <a id="492" href="Prelude.Monoid.html" class="Module">Prelude.Monoid</a>

<a id="508" class="Keyword">data</a> <a id="Colour"></a><a id="513" href="Types.html#513" class="Datatype">Colour</a> <a id="520" class="Symbol">:</a> <a id="522" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="527" class="Keyword">where</a>
  <a id="Colour.Red"></a><a id="535" href="Types.html#535" class="InductiveConstructor">Red</a> <a id="Colour.Green"></a><a id="539" href="Types.html#539" class="InductiveConstructor">Green</a> <a id="Colour.White"></a><a id="545" href="Types.html#545" class="InductiveConstructor">White</a> <a id="Colour.Blue"></a><a id="551" href="Types.html#551" class="InductiveConstructor">Blue</a> <a id="Colour.Black"></a><a id="556" href="Types.html#556" class="InductiveConstructor">Black</a> <a id="562" class="Symbol">:</a> <a id="564" href="Types.html#513" class="Datatype">Colour</a>
<a id="571" class="Keyword">unquoteDecl</a> <a id="DecEq-Colour"></a><a id="583" href="Types.html#583" class="Function">DecEq-Colour</a> <a id="596" class="Symbol">=</a> <a id="598" href="Prelude.Generics.html#9474" class="Function">DERIVE</a> <a id="605" href="Prelude.DecEq.Core.html#97" class="Record">DecEq</a> <a id="611" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="613" class="Keyword">quote</a> <a id="619" href="Types.html#513" class="Datatype">Colour</a> <a id="626" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="628" href="Types.html#583" class="Function">DecEq-Colour</a> <a id="641" href="Data.List.Base.html#5025" class="Function Operator">]</a>

<a id="Colour⁇"></a><a id="644" href="Types.html#644" class="Function">Colour⁇</a> <a id="652" class="Symbol">=</a> <a id="654" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="660" href="Types.html#513" class="Datatype">Colour</a>

<a id="668" class="Keyword">pattern</a> <a id="colorless"></a><a id="676" href="Types.html#676" class="InductiveConstructor">colorless</a> <a id="686" class="Symbol">=</a> <a id="688" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
<a id="696" class="Keyword">pattern</a> <a id="colored"></a><a id="704" href="Types.html#704" class="InductiveConstructor">colored</a> <a id="712" href="Types.html#721" class="Bound">x</a> <a id="714" class="Symbol">=</a> <a id="716" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="721" href="Types.html#721" class="Bound">x</a>
<a id="723" class="Keyword">pattern</a> <a id="R"></a><a id="731" href="Types.html#731" class="InductiveConstructor">R</a> <a id="733" class="Symbol">=</a> <a id="735" href="Types.html#704" class="InductiveConstructor">colored</a> <a id="743" href="Types.html#535" class="InductiveConstructor">Red</a>
<a id="747" class="Keyword">pattern</a> <a id="G"></a><a id="755" href="Types.html#755" class="InductiveConstructor">G</a> <a id="757" class="Symbol">=</a> <a id="759" href="Types.html#704" class="InductiveConstructor">colored</a> <a id="767" href="Types.html#539" class="InductiveConstructor">Green</a>
<a id="773" class="Keyword">pattern</a> <a id="W"></a><a id="781" href="Types.html#781" class="InductiveConstructor">W</a> <a id="783" class="Symbol">=</a> <a id="785" href="Types.html#704" class="InductiveConstructor">colored</a> <a id="793" href="Types.html#545" class="InductiveConstructor">White</a>
<a id="799" class="Keyword">pattern</a> <a id="U"></a><a id="807" href="Types.html#807" class="InductiveConstructor">U</a> <a id="809" class="Symbol">=</a> <a id="811" href="Types.html#704" class="InductiveConstructor">colored</a> <a id="819" href="Types.html#551" class="InductiveConstructor">Blue</a>
<a id="824" class="Keyword">pattern</a> <a id="B"></a><a id="832" href="Types.html#832" class="InductiveConstructor">B</a> <a id="834" class="Symbol">=</a> <a id="836" href="Types.html#704" class="InductiveConstructor">colored</a> <a id="844" href="Types.html#556" class="InductiveConstructor">Black</a>
<a id="850" class="Keyword">pattern</a> <a id="C"></a><a id="858" href="Types.html#858" class="InductiveConstructor">C</a> <a id="860" class="Symbol">=</a> <a id="862" href="Types.html#676" class="InductiveConstructor">colorless</a>

<a id="Mana"></a><a id="873" href="Types.html#873" class="Function">Mana</a> <a id="878" class="Symbol">=</a> <a id="880" href="Prelude.Maps.Concrete.html#517" class="Record">Map⟨</a> <a id="885" href="Types.html#644" class="Function">Colour⁇</a> <a id="893" href="Prelude.Maps.Concrete.html#517" class="Record">↦</a> <a id="895" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="897" href="Prelude.Maps.Concrete.html#517" class="Record">⟩</a>
<a id="ManaPool"></a><a id="899" href="Types.html#899" class="Function">ManaPool</a> <a id="908" class="Symbol">=</a> <a id="910" href="Types.html#873" class="Function">Mana</a>
<a id="ManaCost"></a><a id="915" href="Types.html#915" class="Function">ManaCost</a> <a id="924" class="Symbol">=</a> <a id="926" href="Types.html#873" class="Function">Mana</a>
<a id="CardCost"></a><a id="931" href="Types.html#931" class="Function">CardCost</a> <a id="940" class="Symbol">=</a> <a id="942" href="Prelude.Sets.Concrete.html#933" class="Record">S.Set⟨</a> <a id="949" href="Types.html#915" class="Function">ManaCost</a> <a id="958" href="Prelude.Sets.Concrete.html#933" class="Record">⟩</a>
<a id="ManaCostChoices"></a><a id="960" href="Types.html#960" class="Function">ManaCostChoices</a> <a id="976" class="Symbol">=</a> <a id="978" href="Prelude.Maps.Concrete.html#517" class="Record">Map⟨</a> <a id="983" href="Prelude.Sets.Concrete.html#7514" class="Record">S.Set⁺⟨</a> <a id="991" href="Types.html#644" class="Function">Colour⁇</a> <a id="999" href="Prelude.Sets.Concrete.html#7514" class="Record">⟩</a> <a id="1001" href="Prelude.Maps.Concrete.html#517" class="Record">↦</a> <a id="1003" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1005" href="Prelude.Maps.Concrete.html#517" class="Record">⟩</a>

<a id="1008" class="Keyword">instance</a> <a id="1017" href="Types.html#1017" class="Function">_</a> <a id="1019" class="Symbol">=</a> <a id="1021" href="Prelude.Semigroup.html#2075" class="Function">Semigroup-ℕ-+</a>
<a id="1035" class="Keyword">instance</a> <a id="1044" href="Types.html#1044" class="Function">_</a> <a id="1046" class="Symbol">=</a> <a id="1048" href="Prelude.Monoid.html#1301" class="Function">Monoid-ℕ-+</a>

<a id="1060" class="Keyword">infix</a> <a id="1066" class="Number">10</a> <a id="1069" href="Types.html#1073" class="Function Operator">_↦_</a>
<a id="_↦_"></a><a id="1073" href="Types.html#1073" class="Function Operator">_↦_</a> <a id="1077" class="Symbol">=</a> <a id="1079" class="Symbol">(</a><a id="1080" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="1086" href="Types.html#513" class="Datatype">Colour</a> <a id="1093" class="Symbol">→</a> <a id="1095" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1097" class="Symbol">→</a> <a id="1099" href="Types.html#873" class="Function">Mana</a><a id="1103" class="Symbol">)</a> <a id="1105" href="Function.Base.html#4562" class="Function Operator">∋</a> <a id="1107" href="Prelude.Maps.Concrete.html#930" class="Function">singleton</a> <a id="1117" href="Function.Base.html#1219" class="Function Operator">∘₂</a> <a id="1120" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a>

<a id="calculateCost"></a><a id="1125" href="Types.html#1125" class="Function">calculateCost</a> <a id="1139" class="Symbol">:</a> <a id="1141" href="Types.html#960" class="Function">ManaCostChoices</a> <a id="1157" class="Symbol">→</a> <a id="1159" href="Types.html#931" class="Function">CardCost</a>
<a id="1168" href="Types.html#1125" class="Function">calculateCost</a> <a id="1182" class="Symbol">=</a> <a id="1184" href="Types.html#1372" class="Function">go∗</a> <a id="1188" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1190" href="Prelude.ToList.html#173" class="Function Operator">_∙toList</a>
  <a id="1201" class="Keyword">where</a>
    <a id="1211" href="Types.html#1211" class="Function">go</a> <a id="1214" class="Symbol">:</a> <a id="1216" href="Data.List.NonEmpty.Base.html#1079" class="Record">List⁺</a> <a id="1222" href="Types.html#644" class="Function">Colour⁇</a> <a id="1230" class="Symbol">→</a> <a id="1232" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1234" class="Symbol">→</a> <a id="1236" href="Types.html#931" class="Function">CardCost</a>
    <a id="1249" href="Types.html#1211" class="Function">go</a> <a id="1252" class="Symbol">(</a><a id="1253" href="Types.html#1253" class="Bound">x</a> <a id="1255" href="Data.List.NonEmpty.Base.html#1125" class="InductiveConstructor Operator">∷</a> <a id="1257" href="Types.html#1257" class="Bound">xs</a><a id="1259" class="Symbol">)</a> <a id="1261" href="Types.html#1261" class="Bound">n</a> <a id="1263" class="Keyword">with</a> <a id="1268" href="Types.html#1257" class="Bound">xs</a>
    <a id="1275" class="Symbol">...</a> <a id="1279" class="Symbol">|</a> <a id="1281" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>     <a id="1288" class="Symbol">=</a> <a id="1290" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="1302" class="Symbol">(</a><a id="1303" class="Bound">x</a> <a id="1305" href="Types.html#1073" class="Function Operator">↦</a> <a id="1307" class="Bound">n</a><a id="1308" class="Symbol">)</a>
    <a id="1314" class="Symbol">...</a> <a id="1318" class="Symbol">|</a> <a id="1320" href="Types.html#1320" class="Bound">y</a> <a id="1322" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1324" href="Types.html#1324" class="Bound">ys</a> <a id="1327" class="Symbol">=</a> <a id="1329" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="1341" class="Symbol">(</a><a id="1342" class="Bound">x</a> <a id="1344" href="Types.html#1073" class="Function Operator">↦</a> <a id="1346" class="Bound">n</a><a id="1347" class="Symbol">)</a> <a id="1349" href="Prelude.Sets.Concrete.html#2693" class="Function Operator">S.∪</a> <a id="1353" href="Types.html#1211" class="Function">go</a> <a id="1356" class="Symbol">(</a><a id="1357" href="Types.html#1320" class="Bound">y</a> <a id="1359" href="Data.List.NonEmpty.Base.html#1125" class="InductiveConstructor Operator">∷</a> <a id="1361" href="Types.html#1324" class="Bound">ys</a><a id="1363" class="Symbol">)</a> <a id="1365" class="Bound">n</a>

    <a id="1372" href="Types.html#1372" class="Function">go∗</a> <a id="1376" class="Symbol">:</a> <a id="1378" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1383" class="Symbol">(</a><a id="1384" href="Prelude.Sets.Concrete.html#7514" class="Record">S.Set⁺⟨</a> <a id="1392" href="Types.html#644" class="Function">Colour⁇</a> <a id="1400" href="Prelude.Sets.Concrete.html#7514" class="Record">⟩</a> <a id="1402" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1404" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1405" class="Symbol">)</a> <a id="1407" class="Symbol">→</a> <a id="1409" href="Types.html#931" class="Function">CardCost</a>
    <a id="1422" href="Types.html#1372" class="Function">go∗</a> <a id="1426" class="Symbol">=</a> <a id="1428" class="Symbol">λ</a> <a id="1430" class="Keyword">where</a>
      <a id="1442" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="1445" class="Symbol">→</a> <a id="1447" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="1459" class="Symbol">(</a><a id="1460" href="Types.html#858" class="InductiveConstructor">C</a> <a id="1462" href="Types.html#1073" class="Function Operator">↦</a> <a id="1464" class="Number">0</a><a id="1465" class="Symbol">)</a>
      <a id="1473" class="Symbol">((</a><a id="1475" href="Types.html#1475" class="Bound">s⁺</a> <a id="1478" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1480" href="Types.html#1480" class="Bound">n</a><a id="1481" class="Symbol">)</a> <a id="1483" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1485" href="Types.html#1485" class="Bound">kvs</a><a id="1488" class="Symbol">)</a> <a id="1490" class="Symbol">→</a> <a id="1492" href="Prelude.FromList.html#155" class="Field">fromList</a>
                       <a id="1524" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="1526" href="Data.List.Base.html#4394" class="Function">L.concat</a>
                       <a id="1558" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="1560" class="Symbol">(</a><a id="1561" href="Types.html#1661" class="Function Operator">_⊗</a> <a id="1564" class="Symbol">(</a><a id="1565" href="Types.html#1372" class="Function">go∗</a> <a id="1569" href="Types.html#1485" class="Bound">kvs</a> <a id="1573" href="Prelude.ToList.html#173" class="Function Operator">∙toList</a><a id="1580" class="Symbol">))</a>
                     <a id="1604" href="Prelude.Functor.html#301" class="Field Operator">&lt;$&gt;</a> <a id="1608" href="Types.html#1211" class="Function">go</a> <a id="1611" class="Symbol">(</a><a id="1612" href="Prelude.Sets.Concrete.html#7984" class="Function">S.toList&#39;⁺</a> <a id="1623" href="Types.html#1475" class="Bound">s⁺</a><a id="1625" class="Symbol">)</a> <a id="1627" href="Types.html#1480" class="Bound">n</a> <a id="1629" href="Prelude.ToList.html#173" class="Function Operator">∙toList</a>
        <a id="1645" class="Keyword">where</a>
          <a id="1661" href="Types.html#1661" class="Function Operator">_⊗_</a> <a id="1665" class="Symbol">:</a> <a id="1667" href="Types.html#915" class="Function">ManaCost</a> <a id="1676" class="Symbol">→</a> <a id="1678" href="Algebra.Core.html#475" class="Function">Op₁</a> <a id="1682" class="Symbol">(</a><a id="1683" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1688" href="Types.html#915" class="Function">ManaCost</a><a id="1696" class="Symbol">)</a>
          <a id="1708" href="Types.html#1708" class="Bound">m</a> <a id="1710" href="Types.html#1661" class="Function Operator">⊗</a> <a id="1712" href="Types.html#1712" class="Bound">cur</a> <a id="1716" class="Symbol">=</a> <a id="1718" href="Data.List.Base.html#1544" class="Function">map</a> <a id="1722" class="Symbol">(</a><a id="1723" href="Prelude.Semigroup.html#158" class="Field Operator">_◇</a> <a id="1726" href="Types.html#1708" class="Bound">m</a><a id="1727" class="Symbol">)</a> <a id="1729" href="Types.html#1712" class="Bound">cur</a>

<a id="1734" class="Keyword">private</a>
  <a id="1744" href="Types.html#1744" class="Function">_</a> <a id="1746" class="Symbol">:</a> <a id="1748" href="Types.html#873" class="Function">Mana</a> <a id="1753" class="Comment">-- 0</a>
  <a id="1760" class="Symbol">_</a> <a id="1762" class="Symbol">=</a> <a id="1764" href="Prelude.Maps.Concrete.html#906" class="Function">∅</a>

  <a id="m"></a><a id="1769" href="Types.html#1769" class="Function">m</a> <a id="1771" class="Symbol">:</a> <a id="1773" href="Types.html#873" class="Function">Mana</a>
  <a id="1780" href="Types.html#1769" class="Function">m</a> <a id="1782" class="Symbol">=</a> <a id="1784" href="Types.html#858" class="InductiveConstructor">C</a> <a id="1786" href="Types.html#1073" class="Function Operator">↦</a> <a id="1788" class="Number">2</a> <a id="1790" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="1792" href="Types.html#781" class="InductiveConstructor">W</a> <a id="1794" href="Types.html#1073" class="Function Operator">↦</a> <a id="1796" class="Number">2</a>

  <a id="m′"></a><a id="1801" href="Types.html#1801" class="Function">m′</a> <a id="1804" class="Symbol">:</a> <a id="1806" href="Types.html#873" class="Function">Mana</a>
  <a id="1813" href="Types.html#1801" class="Function">m′</a> <a id="1816" class="Symbol">=</a> <a id="1818" href="Types.html#858" class="InductiveConstructor">C</a> <a id="1820" href="Types.html#1073" class="Function Operator">↦</a> <a id="1822" class="Number">4</a> <a id="1824" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="1826" href="Types.html#781" class="InductiveConstructor">W</a> <a id="1828" href="Types.html#1073" class="Function Operator">↦</a> <a id="1830" class="Number">2</a>

  <a id="1835" href="Types.html#1835" class="Function">_</a> <a id="1837" class="Symbol">:</a> <a id="1839" href="Types.html#1769" class="Function">m</a> <a id="1841" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="1843" href="Types.html#1801" class="Function">m′</a>
    <a id="1850" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1852" href="Types.html#781" class="InductiveConstructor">W</a> <a id="1854" href="Types.html#1073" class="Function Operator">↦</a> <a id="1856" class="Number">4</a> <a id="1858" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="1860" href="Types.html#858" class="InductiveConstructor">C</a> <a id="1862" href="Types.html#1073" class="Function Operator">↦</a> <a id="1864" class="Number">6</a>
  <a id="1868" class="Symbol">_</a> <a id="1870" class="Symbol">=</a> <a id="1872" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

  <a id="1880" class="Comment">-- this is *not* setoid equality</a>
  <a id="1915" href="Types.html#1915" class="Function">_</a> <a id="1917" class="Symbol">:</a> <a id="1919" href="Types.html#1769" class="Function">m</a> <a id="1921" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="1923" href="Types.html#1801" class="Function">m′</a>
    <a id="1930" href="Relation.Binary.PropositionalEquality.Core.html#830" class="Function Operator">≢</a> <a id="1932" href="Types.html#858" class="InductiveConstructor">C</a> <a id="1934" href="Types.html#1073" class="Function Operator">↦</a> <a id="1936" class="Number">6</a> <a id="1938" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="1940" href="Types.html#781" class="InductiveConstructor">W</a> <a id="1942" href="Types.html#1073" class="Function Operator">↦</a> <a id="1944" class="Number">4</a>
  <a id="1948" class="Symbol">_</a> <a id="1950" class="Symbol">=</a> <a id="1952" class="Symbol">λ</a> <a id="1954" class="Symbol">()</a>

  <a id="1960" class="Comment">-- this *is* setoid equality</a>
  <a id="1991" href="Types.html#1991" class="Function">_</a> <a id="1993" class="Symbol">:</a> <a id="1995" class="Symbol">(</a><a id="1996" href="Types.html#1769" class="Function">m</a> <a id="1998" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2000" href="Types.html#1801" class="Function">m′</a><a id="2002" class="Symbol">)</a>
   <a id="2007" href="Prelude.Maps.Concrete.html#3647" class="Function Operator">≈ᵐ</a> <a id="2010" class="Symbol">(</a><a id="2011" href="Types.html#858" class="InductiveConstructor">C</a> <a id="2013" href="Types.html#1073" class="Function Operator">↦</a> <a id="2015" class="Number">6</a> <a id="2017" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2019" href="Types.html#781" class="InductiveConstructor">W</a> <a id="2021" href="Types.html#1073" class="Function Operator">↦</a> <a id="2023" class="Number">4</a><a id="2024" class="Symbol">)</a>
  <a id="2028" class="Symbol">_</a> <a id="2030" class="Symbol">=</a> <a id="2032" href="Prelude.Decidable.html#212" class="Function">auto</a>

  <a id="2040" href="Types.html#2040" class="Function">_</a> <a id="2042" class="Symbol">:</a> <a id="2044" href="Types.html#899" class="Function">ManaPool</a>
  <a id="2055" class="Symbol">_</a> <a id="2057" class="Symbol">=</a> <a id="2059" href="Types.html#858" class="InductiveConstructor">C</a> <a id="2061" href="Types.html#1073" class="Function Operator">↦</a> <a id="2063" class="Number">2</a> <a id="2065" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2067" href="Types.html#781" class="InductiveConstructor">W</a> <a id="2069" href="Types.html#1073" class="Function Operator">↦</a> <a id="2071" class="Number">2</a> <a id="2073" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2075" href="Types.html#731" class="InductiveConstructor">R</a> <a id="2077" href="Types.html#1073" class="Function Operator">↦</a> <a id="2079" class="Number">1</a>

  <a id="1BBB"></a><a id="2084" href="Types.html#2084" class="Function">1BBB</a> <a id="2089" class="Symbol">=</a> <a id="2091" href="Types.html#915" class="Function">ManaCost</a> <a id="2100" class="Comment">-- 1BBB</a>
    <a id="2112" href="Function.Base.html#4562" class="Function Operator">∋</a> <a id="2114" href="Types.html#858" class="InductiveConstructor">C</a> <a id="2116" href="Types.html#1073" class="Function Operator">↦</a> <a id="2118" class="Number">1</a> <a id="2120" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2122" href="Types.html#832" class="InductiveConstructor">B</a> <a id="2124" href="Types.html#1073" class="Function Operator">↦</a> <a id="2126" class="Number">3</a>
  <a id="2WW"></a><a id="2130" href="Types.html#2130" class="Function">2WW</a> <a id="2134" class="Symbol">=</a> <a id="2136" href="Types.html#915" class="Function">ManaCost</a> <a id="2145" class="Comment">-- 2WW</a>
    <a id="2156" href="Function.Base.html#4562" class="Function Operator">∋</a> <a id="2158" href="Types.html#858" class="InductiveConstructor">C</a> <a id="2160" href="Types.html#1073" class="Function Operator">↦</a> <a id="2162" class="Number">2</a> <a id="2164" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2166" href="Types.html#781" class="InductiveConstructor">W</a> <a id="2168" href="Types.html#1073" class="Function Operator">↦</a> <a id="2170" class="Number">2</a>
  <a id="2WW/1BBB"></a><a id="2174" href="Types.html#2174" class="Function">2WW/1BBB</a> <a id="2183" class="Symbol">=</a> <a id="2185" href="Types.html#931" class="Function">CardCost</a> <a id="2194" class="Comment">-- 2WW/1BBB</a>
    <a id="2210" href="Function.Base.html#4562" class="Function Operator">∋</a> <a id="2212" href="Prelude.FromList.html#155" class="Field">fromList</a> <a id="2221" href="Prelude.Nary.html#207" class="Function Operator">⟦</a> <a id="2223" href="Types.html#2130" class="Function">2WW</a> <a id="2227" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2229" href="Types.html#2084" class="Function">1BBB</a> <a id="2234" href="Prelude.Nary.html#207" class="Function Operator">⟧</a>

  <a id="2239" href="Types.html#2239" class="Function">_</a> <a id="2241" class="Symbol">=</a> <a id="2243" href="Types.html#931" class="Function">CardCost</a> <a id="2252" class="Comment">-- 2WW(R|G) aka 2WWR|2WWG)</a>
    <a id="2283" href="Function.Base.html#4562" class="Function Operator">∋</a> <a id="2285" href="Prelude.FromList.html#155" class="Field">fromList</a>
        <a id="2302" href="Prelude.Nary.html#207" class="Function Operator">⟦</a> <a id="2304" href="Types.html#858" class="InductiveConstructor">C</a> <a id="2306" href="Types.html#1073" class="Function Operator">↦</a> <a id="2308" class="Number">2</a> <a id="2310" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2312" href="Types.html#781" class="InductiveConstructor">W</a> <a id="2314" href="Types.html#1073" class="Function Operator">↦</a> <a id="2316" class="Number">2</a> <a id="2318" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2320" href="Types.html#731" class="InductiveConstructor">R</a> <a id="2322" href="Types.html#1073" class="Function Operator">↦</a> <a id="2324" class="Number">1</a>
        <a id="2334" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2336" href="Types.html#858" class="InductiveConstructor">C</a> <a id="2338" href="Types.html#1073" class="Function Operator">↦</a> <a id="2340" class="Number">2</a> <a id="2342" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2344" href="Types.html#781" class="InductiveConstructor">W</a> <a id="2346" href="Types.html#1073" class="Function Operator">↦</a> <a id="2348" class="Number">2</a> <a id="2350" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2352" href="Types.html#755" class="InductiveConstructor">G</a> <a id="2354" href="Types.html#1073" class="Function Operator">↦</a> <a id="2356" class="Number">1</a>
        <a id="2366" href="Prelude.Nary.html#207" class="Function Operator">⟧</a>

  <a id="2371" href="Types.html#2371" class="Function">_</a> <a id="2373" class="Symbol">=</a> <a id="2375" href="Types.html#960" class="Function">ManaCostChoices</a> <a id="2391" class="Comment">-- 2WW(R|G)</a>
    <a id="2407" href="Function.Base.html#4562" class="Function Operator">∋</a> <a id="2409" href="Prelude.Maps.Concrete.html#930" class="Function">singleton</a> <a id="2419" class="Symbol">(</a><a id="2420" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="2432" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="2434" href="Types.html#858" class="InductiveConstructor">C</a> <a id="2436" href="Data.List.Base.html#5025" class="Function Operator">]</a>     <a id="2442" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2444" class="Number">2</a><a id="2445" class="Symbol">)</a>
    <a id="2451" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2453" href="Prelude.Maps.Concrete.html#930" class="Function">singleton</a> <a id="2463" class="Symbol">(</a><a id="2464" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="2476" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="2478" href="Types.html#781" class="InductiveConstructor">W</a> <a id="2480" href="Data.List.Base.html#5025" class="Function Operator">]</a>     <a id="2486" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2488" class="Number">2</a><a id="2489" class="Symbol">)</a>
    <a id="2495" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2497" href="Prelude.Maps.Concrete.html#930" class="Function">singleton</a> <a id="2507" class="Symbol">(</a><a id="2508" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="2520" href="Prelude.Nary.html#207" class="Function Operator">⟦</a> <a id="2522" href="Types.html#731" class="InductiveConstructor">R</a> <a id="2524" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2526" href="Types.html#755" class="InductiveConstructor">G</a> <a id="2528" href="Prelude.Nary.html#207" class="Function Operator">⟧</a> <a id="2530" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2532" class="Number">1</a><a id="2533" class="Symbol">)</a>

  <a id="2538" href="Types.html#2538" class="Function">_</a> <a id="2540" class="Symbol">:</a> <a id="2542" href="Types.html#1125" class="Function">calculateCost</a> <a id="2556" href="Prelude.Maps.Concrete.html#906" class="Function">∅</a>
    <a id="2562" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2564" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="2576" class="Symbol">(</a><a id="2577" href="Types.html#858" class="InductiveConstructor">C</a> <a id="2579" href="Types.html#1073" class="Function Operator">↦</a> <a id="2581" class="Number">0</a><a id="2582" class="Symbol">)</a>
  <a id="2586" class="Symbol">_</a> <a id="2588" class="Symbol">=</a> <a id="2590" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

  <a id="2598" href="Types.html#2598" class="Function">_</a> <a id="2600" class="Symbol">:</a> <a id="2602" href="Types.html#1125" class="Function">calculateCost</a> <a id="2616" class="Symbol">(</a><a id="2617" href="Prelude.Maps.Concrete.html#930" class="Function">singleton</a> <a id="2627" class="Symbol">(</a><a id="2628" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="2640" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="2642" href="Types.html#858" class="InductiveConstructor">C</a> <a id="2644" href="Data.List.Base.html#5025" class="Function Operator">]</a> <a id="2646" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2648" class="Number">0</a><a id="2649" class="Symbol">))</a>
    <a id="2656" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2658" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="2670" class="Symbol">(</a><a id="2671" href="Types.html#858" class="InductiveConstructor">C</a> <a id="2673" href="Types.html#1073" class="Function Operator">↦</a> <a id="2675" class="Number">0</a><a id="2676" class="Symbol">)</a>
  <a id="2680" class="Symbol">_</a> <a id="2682" class="Symbol">=</a> <a id="2684" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

  <a id="2692" href="Types.html#2692" class="Function">_</a> <a id="2694" class="Symbol">:</a> <a id="2696" href="Types.html#1125" class="Function">calculateCost</a> <a id="2710" class="Symbol">(</a><a id="2711" href="Prelude.Maps.Concrete.html#930" class="Function">singleton</a> <a id="2721" class="Symbol">(</a><a id="2722" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="2734" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="2736" href="Types.html#731" class="InductiveConstructor">R</a> <a id="2738" href="Data.List.Base.html#5025" class="Function Operator">]</a> <a id="2740" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2742" class="Number">1</a><a id="2743" class="Symbol">))</a>
    <a id="2750" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2752" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="2764" class="Symbol">(</a><a id="2765" href="Types.html#858" class="InductiveConstructor">C</a> <a id="2767" href="Types.html#1073" class="Function Operator">↦</a> <a id="2769" class="Number">0</a> <a id="2771" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2773" href="Types.html#731" class="InductiveConstructor">R</a> <a id="2775" href="Types.html#1073" class="Function Operator">↦</a> <a id="2777" class="Number">1</a><a id="2778" class="Symbol">)</a>
  <a id="2782" class="Symbol">_</a> <a id="2784" class="Symbol">=</a> <a id="2786" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

  <a id="2794" href="Types.html#2794" class="Function">_</a> <a id="2796" class="Symbol">:</a> <a id="2798" href="Types.html#1125" class="Function">calculateCost</a> <a id="2812" class="Symbol">(</a><a id="2813" href="Prelude.Maps.Concrete.html#930" class="Function">singleton</a> <a id="2823" class="Symbol">(</a><a id="2824" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="2836" class="Symbol">(</a><a id="2837" href="Types.html#731" class="InductiveConstructor">R</a> <a id="2839" class="InductiveConstructor Operator">∷</a> <a id="2841" href="Types.html#755" class="InductiveConstructor">G</a> <a id="2843" class="InductiveConstructor Operator">∷</a> <a id="2845" class="InductiveConstructor">[]</a><a id="2847" class="Symbol">)</a> <a id="2849" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2851" class="Number">1</a><a id="2852" class="Symbol">))</a>
    <a id="2859" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a>   <a id="2863" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="2875" class="Symbol">(</a><a id="2876" href="Types.html#858" class="InductiveConstructor">C</a> <a id="2878" href="Types.html#1073" class="Function Operator">↦</a> <a id="2880" class="Number">0</a> <a id="2882" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2884" href="Types.html#731" class="InductiveConstructor">R</a> <a id="2886" href="Types.html#1073" class="Function Operator">↦</a> <a id="2888" class="Number">1</a><a id="2889" class="Symbol">)</a>
    <a id="2895" href="Prelude.Sets.Concrete.html#2693" class="Function Operator">S.∪</a> <a id="2899" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="2911" class="Symbol">(</a><a id="2912" href="Types.html#858" class="InductiveConstructor">C</a> <a id="2914" href="Types.html#1073" class="Function Operator">↦</a> <a id="2916" class="Number">0</a> <a id="2918" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2920" href="Types.html#755" class="InductiveConstructor">G</a> <a id="2922" href="Types.html#1073" class="Function Operator">↦</a> <a id="2924" class="Number">1</a><a id="2925" class="Symbol">)</a>
  <a id="2929" class="Symbol">_</a> <a id="2931" class="Symbol">=</a> <a id="2933" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

  <a id="2941" href="Types.html#2941" class="Function">_</a> <a id="2943" class="Symbol">:</a> <a id="2945" href="Types.html#1125" class="Function">calculateCost</a> <a id="2959" class="Symbol">(</a> <a id="2961" href="Prelude.Maps.Concrete.html#930" class="Function">singleton</a> <a id="2971" class="Symbol">(</a><a id="2972" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="2984" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="2986" href="Types.html#858" class="InductiveConstructor">C</a> <a id="2988" href="Data.List.Base.html#5025" class="Function Operator">]</a> <a id="2990" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2992" class="Number">2</a><a id="2993" class="Symbol">)</a>
                    <a id="3015" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3017" href="Prelude.Maps.Concrete.html#930" class="Function">singleton</a> <a id="3027" class="Symbol">(</a><a id="3028" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="3040" class="Symbol">(</a><a id="3041" href="Types.html#731" class="InductiveConstructor">R</a> <a id="3043" class="InductiveConstructor Operator">∷</a> <a id="3045" href="Types.html#755" class="InductiveConstructor">G</a> <a id="3047" class="InductiveConstructor Operator">∷</a> <a id="3049" class="InductiveConstructor">[]</a><a id="3051" class="Symbol">)</a> <a id="3053" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3055" class="Number">1</a><a id="3056" class="Symbol">))</a>
    <a id="3063" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a>   <a id="3067" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="3079" class="Symbol">(</a><a id="3080" href="Types.html#731" class="InductiveConstructor">R</a> <a id="3082" href="Types.html#1073" class="Function Operator">↦</a> <a id="3084" class="Number">1</a> <a id="3086" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3088" href="Types.html#858" class="InductiveConstructor">C</a> <a id="3090" href="Types.html#1073" class="Function Operator">↦</a> <a id="3092" class="Number">2</a><a id="3093" class="Symbol">)</a>
    <a id="3099" href="Prelude.Sets.Concrete.html#2693" class="Function Operator">S.∪</a> <a id="3103" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="3115" class="Symbol">(</a><a id="3116" href="Types.html#755" class="InductiveConstructor">G</a> <a id="3118" href="Types.html#1073" class="Function Operator">↦</a> <a id="3120" class="Number">1</a> <a id="3122" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3124" href="Types.html#858" class="InductiveConstructor">C</a> <a id="3126" href="Types.html#1073" class="Function Operator">↦</a> <a id="3128" class="Number">2</a><a id="3129" class="Symbol">)</a>
  <a id="3133" class="Symbol">_</a> <a id="3135" class="Symbol">=</a> <a id="3137" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

  <a id="3145" href="Types.html#3145" class="Function">_</a> <a id="3147" class="Symbol">:</a> <a id="3149" href="Types.html#1125" class="Function">calculateCost</a> <a id="3163" class="Symbol">(</a> <a id="3165" href="Prelude.Maps.Concrete.html#930" class="Function">singleton</a> <a id="3175" class="Symbol">(</a><a id="3176" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="3188" class="Symbol">(</a><a id="3189" href="Types.html#832" class="InductiveConstructor">B</a> <a id="3191" class="InductiveConstructor Operator">∷</a> <a id="3193" href="Types.html#807" class="InductiveConstructor">U</a> <a id="3195" class="InductiveConstructor Operator">∷</a> <a id="3197" class="InductiveConstructor">[]</a><a id="3199" class="Symbol">)</a> <a id="3201" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3203" class="Number">1</a><a id="3204" class="Symbol">)</a>
                    <a id="3226" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3228" href="Prelude.Maps.Concrete.html#930" class="Function">singleton</a> <a id="3238" class="Symbol">(</a><a id="3239" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="3251" class="Symbol">(</a><a id="3252" href="Types.html#731" class="InductiveConstructor">R</a> <a id="3254" class="InductiveConstructor Operator">∷</a> <a id="3256" href="Types.html#755" class="InductiveConstructor">G</a> <a id="3258" class="InductiveConstructor Operator">∷</a> <a id="3260" class="InductiveConstructor">[]</a><a id="3262" class="Symbol">)</a> <a id="3264" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3266" class="Number">1</a><a id="3267" class="Symbol">))</a>
    <a id="3274" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a>   <a id="3278" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="3290" class="Symbol">(</a><a id="3291" href="Types.html#858" class="InductiveConstructor">C</a> <a id="3293" href="Types.html#1073" class="Function Operator">↦</a> <a id="3295" class="Number">0</a> <a id="3297" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3299" href="Types.html#832" class="InductiveConstructor">B</a> <a id="3301" href="Types.html#1073" class="Function Operator">↦</a> <a id="3303" class="Number">1</a> <a id="3305" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3307" href="Types.html#731" class="InductiveConstructor">R</a> <a id="3309" href="Types.html#1073" class="Function Operator">↦</a> <a id="3311" class="Number">1</a><a id="3312" class="Symbol">)</a>
    <a id="3318" href="Prelude.Sets.Concrete.html#2693" class="Function Operator">S.∪</a> <a id="3322" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="3334" class="Symbol">(</a><a id="3335" href="Types.html#858" class="InductiveConstructor">C</a> <a id="3337" href="Types.html#1073" class="Function Operator">↦</a> <a id="3339" class="Number">0</a> <a id="3341" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3343" href="Types.html#832" class="InductiveConstructor">B</a> <a id="3345" href="Types.html#1073" class="Function Operator">↦</a> <a id="3347" class="Number">1</a> <a id="3349" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3351" href="Types.html#755" class="InductiveConstructor">G</a> <a id="3353" href="Types.html#1073" class="Function Operator">↦</a> <a id="3355" class="Number">1</a><a id="3356" class="Symbol">)</a>
    <a id="3362" href="Prelude.Sets.Concrete.html#2693" class="Function Operator">S.∪</a> <a id="3366" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="3378" class="Symbol">(</a><a id="3379" href="Types.html#858" class="InductiveConstructor">C</a> <a id="3381" href="Types.html#1073" class="Function Operator">↦</a> <a id="3383" class="Number">0</a> <a id="3385" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3387" href="Types.html#807" class="InductiveConstructor">U</a> <a id="3389" href="Types.html#1073" class="Function Operator">↦</a> <a id="3391" class="Number">1</a> <a id="3393" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3395" href="Types.html#731" class="InductiveConstructor">R</a> <a id="3397" href="Types.html#1073" class="Function Operator">↦</a> <a id="3399" class="Number">1</a><a id="3400" class="Symbol">)</a>
    <a id="3406" href="Prelude.Sets.Concrete.html#2693" class="Function Operator">S.∪</a> <a id="3410" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="3422" class="Symbol">(</a><a id="3423" href="Types.html#858" class="InductiveConstructor">C</a> <a id="3425" href="Types.html#1073" class="Function Operator">↦</a> <a id="3427" class="Number">0</a> <a id="3429" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3431" href="Types.html#807" class="InductiveConstructor">U</a> <a id="3433" href="Types.html#1073" class="Function Operator">↦</a> <a id="3435" class="Number">1</a> <a id="3437" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3439" href="Types.html#755" class="InductiveConstructor">G</a> <a id="3441" href="Types.html#1073" class="Function Operator">↦</a> <a id="3443" class="Number">1</a><a id="3444" class="Symbol">)</a>
  <a id="3448" class="Symbol">_</a> <a id="3450" class="Symbol">=</a> <a id="3452" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

  <a id="3460" href="Types.html#3460" class="Function">_</a> <a id="3462" class="Symbol">:</a> <a id="3464" href="Types.html#1125" class="Function">calculateCost</a> <a id="3478" class="Symbol">(</a> <a id="3480" href="Prelude.Maps.Concrete.html#930" class="Function">singleton</a> <a id="3490" class="Symbol">(</a><a id="3491" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="3503" class="Symbol">(</a><a id="3504" href="Types.html#731" class="InductiveConstructor">R</a> <a id="3506" class="InductiveConstructor Operator">∷</a> <a id="3508" href="Types.html#807" class="InductiveConstructor">U</a> <a id="3510" class="InductiveConstructor Operator">∷</a> <a id="3512" class="InductiveConstructor">[]</a><a id="3514" class="Symbol">)</a> <a id="3516" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3518" class="Number">1</a><a id="3519" class="Symbol">)</a>
                    <a id="3541" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3543" href="Prelude.Maps.Concrete.html#930" class="Function">singleton</a> <a id="3553" class="Symbol">(</a><a id="3554" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="3566" class="Symbol">(</a><a id="3567" href="Types.html#731" class="InductiveConstructor">R</a> <a id="3569" class="InductiveConstructor Operator">∷</a> <a id="3571" href="Types.html#755" class="InductiveConstructor">G</a> <a id="3573" class="InductiveConstructor Operator">∷</a> <a id="3575" class="InductiveConstructor">[]</a><a id="3577" class="Symbol">)</a> <a id="3579" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3581" class="Number">1</a><a id="3582" class="Symbol">))</a>
    <a id="3589" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a>   <a id="3593" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="3605" class="Symbol">(</a><a id="3606" href="Types.html#858" class="InductiveConstructor">C</a> <a id="3608" href="Types.html#1073" class="Function Operator">↦</a> <a id="3610" class="Number">0</a> <a id="3612" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3614" href="Types.html#731" class="InductiveConstructor">R</a> <a id="3616" href="Types.html#1073" class="Function Operator">↦</a> <a id="3618" class="Number">2</a><a id="3619" class="Symbol">)</a>
    <a id="3625" href="Prelude.Sets.Concrete.html#2693" class="Function Operator">S.∪</a> <a id="3629" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="3641" class="Symbol">(</a><a id="3642" href="Types.html#858" class="InductiveConstructor">C</a> <a id="3644" href="Types.html#1073" class="Function Operator">↦</a> <a id="3646" class="Number">0</a> <a id="3648" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3650" href="Types.html#731" class="InductiveConstructor">R</a> <a id="3652" href="Types.html#1073" class="Function Operator">↦</a> <a id="3654" class="Number">1</a> <a id="3656" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3658" href="Types.html#755" class="InductiveConstructor">G</a> <a id="3660" href="Types.html#1073" class="Function Operator">↦</a> <a id="3662" class="Number">1</a><a id="3663" class="Symbol">)</a>
    <a id="3669" href="Prelude.Sets.Concrete.html#2693" class="Function Operator">S.∪</a> <a id="3673" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="3685" class="Symbol">(</a><a id="3686" href="Types.html#858" class="InductiveConstructor">C</a> <a id="3688" href="Types.html#1073" class="Function Operator">↦</a> <a id="3690" class="Number">0</a> <a id="3692" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3694" href="Types.html#807" class="InductiveConstructor">U</a> <a id="3696" href="Types.html#1073" class="Function Operator">↦</a> <a id="3698" class="Number">1</a> <a id="3700" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3702" href="Types.html#731" class="InductiveConstructor">R</a> <a id="3704" href="Types.html#1073" class="Function Operator">↦</a> <a id="3706" class="Number">1</a><a id="3707" class="Symbol">)</a>
    <a id="3713" href="Prelude.Sets.Concrete.html#2693" class="Function Operator">S.∪</a> <a id="3717" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="3729" class="Symbol">(</a><a id="3730" href="Types.html#858" class="InductiveConstructor">C</a> <a id="3732" href="Types.html#1073" class="Function Operator">↦</a> <a id="3734" class="Number">0</a> <a id="3736" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3738" href="Types.html#807" class="InductiveConstructor">U</a> <a id="3740" href="Types.html#1073" class="Function Operator">↦</a> <a id="3742" class="Number">1</a> <a id="3744" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3746" href="Types.html#755" class="InductiveConstructor">G</a> <a id="3748" href="Types.html#1073" class="Function Operator">↦</a> <a id="3750" class="Number">1</a><a id="3751" class="Symbol">)</a>
  <a id="3755" class="Symbol">_</a> <a id="3757" class="Symbol">=</a> <a id="3759" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="3765" class="Comment">-- Cost = ManaCost ⊎ SacrificeCost</a>

<a id="3801" class="Keyword">data</a> <a id="CreatureType"></a><a id="3806" href="Types.html#3806" class="Datatype">CreatureType</a> <a id="3819" class="Symbol">:</a> <a id="3821" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="3826" class="Keyword">where</a>
  <a id="CreatureType.Human"></a><a id="3834" href="Types.html#3834" class="InductiveConstructor">Human</a> <a id="CreatureType.Soldier"></a><a id="3840" href="Types.html#3840" class="InductiveConstructor">Soldier</a> <a id="CreatureType.Dwarf"></a><a id="3848" href="Types.html#3848" class="InductiveConstructor">Dwarf</a> <a id="CreatureType.Vampire"></a><a id="3854" href="Types.html#3854" class="InductiveConstructor">Vampire</a> <a id="CreatureType.Ogre"></a><a id="3862" href="Types.html#3862" class="InductiveConstructor">Ogre</a> <a id="CreatureType.Warrior"></a><a id="3867" href="Types.html#3867" class="InductiveConstructor">Warrior</a> <a id="3875" class="Symbol">:</a> <a id="3877" href="Types.html#3806" class="Datatype">CreatureType</a>
<a id="3890" class="Keyword">unquoteDecl</a> <a id="DecEq-CreatureType"></a><a id="3902" href="Types.html#3902" class="Function">DecEq-CreatureType</a> <a id="3921" class="Symbol">=</a> <a id="3923" href="Prelude.Generics.html#9474" class="Function">DERIVE</a> <a id="3930" href="Prelude.DecEq.Core.html#97" class="Record">DecEq</a> <a id="3936" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="3938" class="Keyword">quote</a> <a id="3944" href="Types.html#3806" class="Datatype">CreatureType</a> <a id="3957" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3959" href="Types.html#3902" class="Function">DecEq-CreatureType</a> <a id="3978" href="Data.List.Base.html#5025" class="Function Operator">]</a>

<a id="3981" class="Keyword">record</a> <a id="CreatureStats"></a><a id="3988" href="Types.html#3988" class="Record">CreatureStats</a> <a id="4002" class="Symbol">:</a> <a id="4004" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="4009" class="Keyword">where</a>
  <a id="4017" class="Keyword">constructor</a> <a id="_/_"></a><a id="4029" href="Types.html#4029" class="InductiveConstructor Operator">_/_</a>
  <a id="4035" class="Keyword">field</a> <a id="CreatureStats.power"></a><a id="4041" href="Types.html#4041" class="Field">power</a>     <a id="4051" class="Symbol">:</a> <a id="4053" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
        <a id="CreatureStats.toughness"></a><a id="4063" href="Types.html#4063" class="Field">toughness</a> <a id="4073" class="Symbol">:</a> <a id="4075" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="4077" class="Keyword">open</a> <a id="4082" href="Types.html#3988" class="Module">CreatureStats</a> <a id="4096" class="Keyword">public</a>
<a id="4103" class="Keyword">unquoteDecl</a> <a id="DecEq-CreatureStats"></a><a id="4115" href="Types.html#4115" class="Function">DecEq-CreatureStats</a> <a id="4135" class="Symbol">=</a> <a id="4137" href="Prelude.Generics.html#9474" class="Function">DERIVE</a> <a id="4144" href="Prelude.DecEq.Core.html#97" class="Record">DecEq</a> <a id="4150" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="4152" class="Keyword">quote</a> <a id="4158" href="Types.html#3988" class="Record">CreatureStats</a> <a id="4172" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4174" href="Types.html#4115" class="Function">DecEq-CreatureStats</a> <a id="4194" href="Data.List.Base.html#5025" class="Function Operator">]</a>

<a id="4197" class="Keyword">data</a> <a id="Card"></a><a id="4202" href="Types.html#4202" class="Datatype">Card</a> <a id="4207" class="Symbol">:</a> <a id="4209" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="4214" class="Keyword">where</a>
  <a id="Card.BasicLand"></a><a id="4222" href="Types.html#4222" class="InductiveConstructor">BasicLand</a> <a id="4232" class="Symbol">:</a> <a id="4234" href="Types.html#513" class="Datatype">Colour</a> <a id="4241" class="Symbol">→</a> <a id="4243" href="Types.html#4202" class="Datatype">Card</a>
  <a id="Card.Creature"></a><a id="4250" href="Types.html#4250" class="InductiveConstructor">Creature</a>  <a id="4260" class="Symbol">:</a> <a id="4262" href="Types.html#931" class="Function">CardCost</a> <a id="4271" class="Symbol">→</a> <a id="4273" href="Prelude.Sets.Concrete.html#7514" class="Record">S.Set⁺⟨</a> <a id="4281" href="Types.html#3806" class="Datatype">CreatureType</a> <a id="4294" href="Prelude.Sets.Concrete.html#7514" class="Record">⟩</a> <a id="4296" class="Symbol">→</a> <a id="4298" href="Types.html#3988" class="Record">CreatureStats</a> <a id="4312" class="Symbol">→</a> <a id="4314" href="Types.html#4202" class="Datatype">Card</a>
<a id="4319" class="Keyword">unquoteDecl</a> <a id="DecEq-Card"></a><a id="4331" href="Types.html#4331" class="Function">DecEq-Card</a> <a id="4342" class="Symbol">=</a> <a id="4344" href="Prelude.Generics.html#9474" class="Function">DERIVE</a> <a id="4351" href="Prelude.DecEq.Core.html#97" class="Record">DecEq</a> <a id="4357" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="4359" class="Keyword">quote</a> <a id="4365" href="Types.html#4202" class="Datatype">Card</a> <a id="4370" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4372" href="Types.html#4331" class="Function">DecEq-Card</a> <a id="4383" href="Data.List.Base.html#5025" class="Function Operator">]</a>

<a id="Mountain"></a><a id="4386" href="Types.html#4386" class="Function">Mountain</a> <a id="4395" class="Symbol">=</a> <a id="4397" href="Types.html#4222" class="InductiveConstructor">BasicLand</a> <a id="4407" href="Types.html#535" class="InductiveConstructor">Red</a>
<a id="Forest"></a><a id="4411" href="Types.html#4411" class="Function">Forest</a>   <a id="4420" class="Symbol">=</a> <a id="4422" href="Types.html#4222" class="InductiveConstructor">BasicLand</a> <a id="4432" href="Types.html#539" class="InductiveConstructor">Green</a>
<a id="Plains"></a><a id="4438" href="Types.html#4438" class="Function">Plains</a>   <a id="4447" class="Symbol">=</a> <a id="4449" href="Types.html#4222" class="InductiveConstructor">BasicLand</a> <a id="4459" href="Types.html#545" class="InductiveConstructor">White</a>
<a id="Island"></a><a id="4465" href="Types.html#4465" class="Function">Island</a>   <a id="4474" class="Symbol">=</a> <a id="4476" href="Types.html#4222" class="InductiveConstructor">BasicLand</a> <a id="4486" href="Types.html#551" class="InductiveConstructor">Blue</a>
<a id="Swamp"></a><a id="4491" href="Types.html#4491" class="Function">Swamp</a>    <a id="4500" class="Symbol">=</a> <a id="4502" href="Types.html#4222" class="InductiveConstructor">BasicLand</a> <a id="4512" href="Types.html#556" class="InductiveConstructor">Black</a>

<a id="GlorySeeker"></a><a id="4519" href="Types.html#4519" class="Function">GlorySeeker</a> <a id="4531" class="Symbol">=</a> <a id="4533" href="Types.html#4202" class="Datatype">Card</a> <a id="4538" href="Function.Base.html#4562" class="Function Operator">∋</a> <a id="4540" href="Types.html#4250" class="InductiveConstructor">Creature</a>
  <a id="4551" class="Symbol">(</a><a id="4552" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="4564" class="Symbol">(</a><a id="4565" href="Types.html#858" class="InductiveConstructor">C</a> <a id="4567" href="Types.html#1073" class="Function Operator">↦</a> <a id="4569" class="Number">1</a> <a id="4571" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="4573" href="Types.html#781" class="InductiveConstructor">W</a> <a id="4575" href="Types.html#1073" class="Function Operator">↦</a> <a id="4577" class="Number">1</a><a id="4578" class="Symbol">))</a>
  <a id="4583" class="Symbol">(</a><a id="4584" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="4596" href="Prelude.Nary.html#207" class="Function Operator">⟦</a> <a id="4598" href="Types.html#3834" class="InductiveConstructor">Human</a> <a id="4604" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4606" href="Types.html#3840" class="InductiveConstructor">Soldier</a> <a id="4614" href="Prelude.Nary.html#207" class="Function Operator">⟧</a><a id="4615" class="Symbol">)</a>
  <a id="4619" class="Symbol">(</a><a id="4620" class="Number">2</a> <a id="4622" href="Types.html#4029" class="InductiveConstructor Operator">/</a> <a id="4624" class="Number">2</a><a id="4625" class="Symbol">)</a>

<a id="StaunchShieldmate"></a><a id="4628" href="Types.html#4628" class="Function">StaunchShieldmate</a> <a id="4646" class="Symbol">=</a> <a id="4648" href="Types.html#4202" class="Datatype">Card</a> <a id="4653" href="Function.Base.html#4562" class="Function Operator">∋</a> <a id="4655" href="Types.html#4250" class="InductiveConstructor">Creature</a>
  <a id="4666" class="Symbol">(</a><a id="4667" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="4679" class="Symbol">(</a><a id="4680" href="Types.html#781" class="InductiveConstructor">W</a> <a id="4682" href="Types.html#1073" class="Function Operator">↦</a> <a id="4684" class="Number">1</a><a id="4685" class="Symbol">))</a>
  <a id="4690" class="Symbol">(</a><a id="4691" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="4703" href="Prelude.Nary.html#207" class="Function Operator">⟦</a> <a id="4705" href="Types.html#3848" class="InductiveConstructor">Dwarf</a> <a id="4711" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4713" href="Types.html#3840" class="InductiveConstructor">Soldier</a> <a id="4721" href="Prelude.Nary.html#207" class="Function Operator">⟧</a><a id="4722" class="Symbol">)</a>
  <a id="4726" class="Symbol">(</a><a id="4727" class="Number">1</a> <a id="4729" href="Types.html#4029" class="InductiveConstructor Operator">/</a> <a id="4731" class="Number">3</a><a id="4732" class="Symbol">)</a>

<a id="FalkenrathReaver"></a><a id="4735" href="Types.html#4735" class="Function">FalkenrathReaver</a> <a id="4752" class="Symbol">=</a> <a id="4754" href="Types.html#4202" class="Datatype">Card</a> <a id="4759" href="Function.Base.html#4562" class="Function Operator">∋</a> <a id="4761" href="Types.html#4250" class="InductiveConstructor">Creature</a>
  <a id="4772" class="Symbol">(</a><a id="4773" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="4785" class="Symbol">(</a><a id="4786" href="Types.html#858" class="InductiveConstructor">C</a> <a id="4788" href="Types.html#1073" class="Function Operator">↦</a> <a id="4790" class="Number">1</a> <a id="4792" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="4794" href="Types.html#731" class="InductiveConstructor">R</a> <a id="4796" href="Types.html#1073" class="Function Operator">↦</a> <a id="4798" class="Number">1</a><a id="4799" class="Symbol">))</a>
  <a id="4804" class="Symbol">(</a><a id="4805" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="4817" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="4819" href="Types.html#3854" class="InductiveConstructor">Vampire</a> <a id="4827" href="Data.List.Base.html#5025" class="Function Operator">]</a><a id="4828" class="Symbol">)</a>
  <a id="4832" class="Symbol">(</a><a id="4833" class="Number">2</a> <a id="4835" href="Types.html#4029" class="InductiveConstructor Operator">/</a> <a id="4837" class="Number">2</a><a id="4838" class="Symbol">)</a>

<a id="OnakkeOgre"></a><a id="4841" href="Types.html#4841" class="Function">OnakkeOgre</a> <a id="4852" class="Symbol">=</a> <a id="4854" href="Types.html#4202" class="Datatype">Card</a> <a id="4859" href="Function.Base.html#4562" class="Function Operator">∋</a> <a id="4861" href="Types.html#4250" class="InductiveConstructor">Creature</a>
  <a id="4872" class="Symbol">(</a><a id="4873" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="4885" class="Symbol">(</a><a id="4886" href="Types.html#858" class="InductiveConstructor">C</a> <a id="4888" href="Types.html#1073" class="Function Operator">↦</a> <a id="4890" class="Number">2</a> <a id="4892" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="4894" href="Types.html#731" class="InductiveConstructor">R</a> <a id="4896" href="Types.html#1073" class="Function Operator">↦</a> <a id="4898" class="Number">1</a><a id="4899" class="Symbol">))</a>
  <a id="4904" class="Symbol">(</a><a id="4905" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="4917" href="Prelude.Nary.html#207" class="Function Operator">⟦</a> <a id="4919" href="Types.html#3862" class="InductiveConstructor">Ogre</a> <a id="4924" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4926" href="Types.html#3867" class="InductiveConstructor">Warrior</a> <a id="4934" href="Prelude.Nary.html#207" class="Function Operator">⟧</a><a id="4935" class="Symbol">)</a>
  <a id="4939" class="Symbol">(</a><a id="4940" class="Number">4</a> <a id="4942" href="Types.html#4029" class="InductiveConstructor Operator">/</a> <a id="4944" class="Number">2</a><a id="4945" class="Symbol">)</a>

<a id="4948" class="Comment">-- IsLand IsCreature : Pred₀ Card</a>
<a id="4982" class="Comment">-- IsLand = λ where</a>
<a id="5002" class="Comment">--   (BasicLand _) → ⊤</a>
<a id="5025" class="Comment">--   _ → ⊥</a>
<a id="5036" class="Comment">-- IsCreature = λ where</a>
<a id="5060" class="Comment">--   (Creature _ _ _) → ⊤</a>
<a id="5086" class="Comment">--   _ → ⊥</a>

<a id="5098" class="Comment">-- properties : Card → Type</a>
<a id="5126" class="Comment">-- properties = λ where</a>
<a id="5150" class="Comment">--   (BasicLand _) → LandProperties</a>
<a id="5186" class="Comment">--   (Creature _ _ _) → CreatureProperties</a>

<a id="5230" class="Keyword">record</a> <a id="CreatureProperties"></a><a id="5237" href="Types.html#5237" class="Record">CreatureProperties</a> <a id="5256" class="Symbol">:</a> <a id="5258" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="5263" class="Keyword">where</a>
  <a id="5271" class="Keyword">field</a>
    <a id="CreatureProperties.summoningSickness"></a><a id="5281" href="Types.html#5281" class="Field">summoningSickness</a> <a id="5299" class="Symbol">:</a> <a id="5301" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="5306" class="Keyword">open</a> <a id="5311" href="Types.html#5237" class="Module">CreatureProperties</a> <a id="5330" class="Keyword">public</a>

<a id="5338" class="Keyword">record</a> <a id="CardInstance"></a><a id="5345" href="Types.html#5345" class="Record">CardInstance</a> <a id="5358" class="Symbol">:</a> <a id="5360" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="5365" class="Keyword">where</a>
  <a id="5373" class="Keyword">field</a>
    <a id="CardInstance.card"></a><a id="5383" href="Types.html#5383" class="Field">card</a> <a id="5388" class="Symbol">:</a> <a id="5390" href="Types.html#4202" class="Datatype">Card</a>
    <a id="CardInstance.tapped"></a><a id="5399" href="Types.html#5399" class="Field">tapped</a> <a id="5406" class="Symbol">:</a> <a id="5408" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
    <a id="5417" class="Comment">-- properties : properties card</a>
    <a id="CardInstance.properties"></a><a id="5453" href="Types.html#5453" class="Field">properties</a> <a id="5464" class="Symbol">:</a> <a id="5466" href="Function.Base.html#4121" class="Function Operator">case</a> <a id="5471" href="Types.html#5383" class="Field">card</a> <a id="5476" href="Function.Base.html#4121" class="Function Operator">of</a> <a id="5479" class="Symbol">λ</a> <a id="5481" class="Keyword">where</a>
      <a id="5493" class="Symbol">(</a><a id="5494" href="Types.html#4222" class="InductiveConstructor">BasicLand</a> <a id="5504" class="Symbol">_)</a> <a id="5507" class="Symbol">→</a> <a id="5509" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
      <a id="5517" class="Symbol">(</a><a id="5518" href="Types.html#4250" class="InductiveConstructor">Creature</a> <a id="5527" class="Symbol">_</a> <a id="5529" class="Symbol">_</a> <a id="5531" class="Symbol">_)</a> <a id="5534" class="Symbol">→</a> <a id="5536" href="Types.html#5237" class="Record">CreatureProperties</a>
<a id="5555" class="Keyword">open</a> <a id="5560" href="Types.html#5345" class="Module">CardInstance</a> <a id="5573" class="Keyword">public</a>

<a id="goProps"></a><a id="5581" href="Types.html#5581" class="Function">goProps</a> <a id="5589" class="Symbol">:</a> <a id="5591" href="Algebra.Core.html#475" class="Function">Op₁</a> <a id="5595" href="Types.html#5237" class="Record">CreatureProperties</a>
<a id="5614" href="Types.html#5581" class="Function">goProps</a> <a id="5622" href="Types.html#5622" class="Bound">ps</a> <a id="5625" class="Symbol">=</a> <a id="5627" class="Keyword">record</a> <a id="5634" href="Types.html#5622" class="Bound">ps</a> <a id="5637" class="Symbol">{</a><a id="5638" href="Types.html#5281" class="Field">summoningSickness</a> <a id="5656" class="Symbol">=</a> <a id="5658" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a><a id="5663" class="Symbol">}</a>

<a id="5666" class="Comment">-- go : Op₁ CardInstance</a>
<a id="5691" class="Comment">-- go ci@(record {card = c; properties = ps})</a>
<a id="5737" class="Comment">--   with ci .card</a>
<a id="5756" class="Comment">-- ... | BasicLand _    = ci</a>
<a id="5785" class="Comment">-- ... | Creature _ _ _ = ? -- record ci {properties = goProps ps}</a>


<a id="5854" class="Comment">{-
Cards = List Card
Deck = Cards
Hand = Cards

record Player : Type where
  constructor mkPlayer
  field
    library : Cards
    hand : Hand
    graveyard : Cards
    exile : Cards
    life : ℕ
    control : List CardInstance
open Player public

removeSummoningSickness : Player → Player
removeSummoningSickness p = p {control = go &lt;$&gt; p .control}
  where
    goProps : Op₁ CreatureProperties
    goProps ps = record ps {summoningSickness = false}

    go : Op₁ CardInstance
    go ci@(record {card = c; properties = ps})
      with ci .card
    ... | BasicLand _    = ci
    ... | Creature _ _ _ = ? -- record ci {properties = goProps ps}
-}</a>

<a id="6499" class="Comment">-- data DRAW⟨_↝_⟩ : Player → Maybe Player → Type where</a>

<a id="6555" class="Comment">--   drawFail :</a>

<a id="6572" class="Comment">--     p .library ≡ []</a>
<a id="6595" class="Comment">--     ───────────────────</a>
<a id="6622" class="Comment">--     DRAW⟨ p ↝ nothing ⟩</a>

<a id="6650" class="Comment">--   drawSuccess :</a>

<a id="6670" class="Comment">--     p .library ≡ c ∷ cs</a>
<a id="6697" class="Comment">--     ─────────────────────────────────────────────────────────</a>
<a id="6762" class="Comment">--     DRAW⟨ p ↝ just (p { library = cs; hand = c ∷ p .hand } ⟩</a>

<a id="6827" class="Comment">-- data MAIN⟨_↝_⟩ : Player → Maybe Player → Type where</a>

<a id="6883" class="Comment">--    curState .players ≡ p ∷ ps</a>
<a id="6916" class="Comment">--   DRAW⟨ p ↝ nothing ⟩</a>
<a id="6941" class="Comment">--   ─────────────────────────────────────────────────────────</a>
<a id="7004" class="Comment">--   FinalState</a>


<a id="7022" class="Comment">-- data Outcome : Type where</a>
<a id="7051" class="Comment">--   draw firstWins secondWins : Outcome</a>



<a id="7095" class="Comment">-- record GameState : Type where</a>
<a id="7128" class="Comment">--   field</a>
<a id="7139" class="Comment">--     finished : Maybe Outcome</a>
<a id="7171" class="Comment">--     player₁  : Player</a>
<a id="7196" class="Comment">--     player₂  : Player</a>


<a id="7223" class="Comment">-- prepare : GameState → GameState</a>
<a id="7258" class="Comment">-- prepare st = st {players = removeSummoningSickness &lt;$&gt; st .players}</a>
<a id="7329" class="Comment">--   where</a>


<a id="7342" class="Comment">-- data _↝_ : Rel₀ GameState where</a>

<a id="7378" class="Comment">--   executeAllPhases :</a>

<a id="7403" class="Comment">--     ∙ DRAW⟨ st₀ ↝ st₁ ⟩</a>
<a id="7430" class="Comment">--     ∙ MAIN⟨ st₁ ↝ st₂ ⟩</a>
<a id="7457" class="Comment">--     ∙ ATTACK⟨ st₂ ↝ st₃ ⟩</a>
<a id="7486" class="Comment">--     -- ∙ POST⟨ st₃ ↝ st₄ ⟩</a>
<a id="7516" class="Comment">--     -- ∙ END⟨  ⟩</a>
<a id="7536" class="Comment">--       ─────────────────</a>
<a id="7563" class="Comment">--       st₀ ↝ st₄</a>

<a id="7583" class="Comment">-- _↝_ : Rel₀ GameState</a>

<a id="7608" class="Comment">-- _↝∗_ : Rel₀ GameState -- reflexive transitive _↝_</a>

<a id="7662" class="Comment">-- Game = ∃ λ s₀ sₙ → s₀ ↝∗ sₙ</a>

<a id="7694" class="Comment">-- _ : {players = ⟦ st₁ , st₂ ⟧}</a>
<a id="7727" class="Comment">--   ↝ {players = p₁{life=20}, p₂{life=2}}</a>
<a id="7770" class="Comment">--   ↝ { players = p₁{life=20}, p₂{life=0}</a>
<a id="7813" class="Comment">--     , outcome = just first wins</a>
<a id="7848" class="Comment">--     }</a>
<a id="7857" class="Comment">-- _ = drawSuccess , attack₁ , main₁ , drawSuccess , ...</a>


<a id="7916" class="Comment">{- ** Parsing/pretty-printing: interface to the outside world.
  instance
    Parser ManaCost : String → Maybe ManaCost
    Show ManaCost : ManaCost → String

  -- Input —— parse ——→ Semiring/Monoid
  --                         ∣
  --                    -—  show
  --                      \  ∣
  --                       \ ↓
  --                         String

  0) Input: 5W(U|B)
  1) Parse: 5*Any ◇ 1*W ◇ 1*(U|B)
  2) ... analysis ...
  3) Show: 5W(U|B)

  1) Given a cost, 5*Any ◇ 1*W ◇ 1*(U|B) ◇ 1*W
  2) ... analysis ...
  3) Show: 5W(U|B)W or Show⁺⁺: 5W(U|B)--
-}</a>
</pre></body></html>