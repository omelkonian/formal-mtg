<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Types</title><link rel="stylesheet" href="css/Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="Types.html" class="Module">Types</a> <a id="14" class="Keyword">where</a>

<a id="21" class="Keyword">open</a> <a id="26" class="Keyword">import</a> <a id="33" href="Prelude.Init.html" class="Module">Prelude.Init</a>
<a id="46" class="Keyword">open</a> <a id="51" href="Prelude.Init.html#35" class="Module">SetAsType</a>
<a id="61" class="Keyword">open</a> <a id="66" href="Prelude.Init.html#5775" class="Module">L</a> <a id="68" class="Keyword">using</a> <a id="74" class="Symbol">(</a><a id="75" href="Data.List.Base.html#9308" class="Function Operator">_[_]%=_</a><a id="82" class="Symbol">)</a>
<a id="84" class="Keyword">open</a> <a id="89" href="Prelude.Init.html#9081" class="Module">Unary</a> <a id="95" class="Keyword">using</a> <a id="101" class="Symbol">()</a> <a id="104" class="Keyword">renaming</a> <a id="113" class="Symbol">(</a><a id="114" href="Relation.Unary.html#4503" class="Function Operator">_∩_</a> <a id="118" class="Symbol">to</a> <a id="121" class="Function Operator">_∩¹_</a><a id="125" class="Symbol">)</a>
<a id="127" class="Keyword">open</a> <a id="132" class="Keyword">import</a> <a id="139" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="153" class="Keyword">open</a> <a id="158" class="Keyword">import</a> <a id="165" href="Prelude.Semigroup.html" class="Module">Prelude.Semigroup</a>
<a id="183" class="Keyword">open</a> <a id="188" class="Keyword">import</a> <a id="195" href="Prelude.Maps.Concrete.html" class="Module">Prelude.Maps.Concrete</a>
<a id="217" class="Keyword">open</a> <a id="222" class="Keyword">import</a> <a id="229" href="Prelude.Sets.Concrete.html" class="Module">Prelude.Sets.Concrete</a> <a id="251" class="Keyword">using</a> <a id="257" class="Symbol">(</a><a id="258" href="Prelude.Sets.Concrete.html#1710" class="Function Operator">_∈ˢ_</a><a id="262" class="Symbol">)</a>
<a id="264" class="Keyword">import</a> <a id="271" href="Prelude.Sets.Concrete.html" class="Module">Prelude.Sets.Concrete</a> <a id="293" class="Symbol">as</a> <a id="296" class="Module">S</a>
<a id="298" class="Keyword">open</a> <a id="303" class="Keyword">import</a> <a id="310" href="Prelude.DecLists.html" class="Module">Prelude.DecLists</a>
<a id="327" class="Keyword">open</a> <a id="332" class="Keyword">import</a> <a id="339" href="Prelude.FromList.html" class="Module">Prelude.FromList</a>
<a id="356" class="Keyword">open</a> <a id="361" class="Keyword">import</a> <a id="368" href="Prelude.ToList.html" class="Module">Prelude.ToList</a>
<a id="383" class="Keyword">open</a> <a id="388" class="Keyword">import</a> <a id="395" href="Prelude.Nary.html" class="Module">Prelude.Nary</a>
<a id="408" class="Keyword">open</a> <a id="413" class="Keyword">import</a> <a id="420" href="Prelude.Functor.html" class="Module">Prelude.Functor</a>
<a id="436" class="Keyword">open</a> <a id="441" class="Keyword">import</a> <a id="448" href="Prelude.Decidable.html" class="Module">Prelude.Decidable</a>
<a id="466" class="Keyword">open</a> <a id="471" class="Keyword">import</a> <a id="478" href="Prelude.Ord.html" class="Module">Prelude.Ord</a>
<a id="490" class="Keyword">open</a> <a id="495" class="Keyword">import</a> <a id="502" href="Prelude.Monoid.html" class="Module">Prelude.Monoid</a>
<a id="517" class="Keyword">open</a> <a id="522" class="Keyword">import</a> <a id="529" href="Prelude.InferenceRules.html" class="Module">Prelude.InferenceRules</a>
<a id="552" class="Keyword">open</a> <a id="557" class="Keyword">import</a> <a id="564" href="Prelude.Closures.html" class="Module">Prelude.Closures</a>
<a id="581" class="Keyword">open</a> <a id="586" class="Keyword">import</a> <a id="593" href="Prelude.Lenses.html" class="Module">Prelude.Lenses</a>
<a id="608" class="Keyword">open</a> <a id="613" class="Keyword">import</a> <a id="620" href="Prelude.Default.html" class="Module">Prelude.Default</a> <a id="636" class="Keyword">hiding</a> <a id="643" class="Symbol">(</a><a id="644" href="Prelude.Default.html#1424" class="Function">Default-→</a><a id="653" class="Symbol">)</a>
<a id="655" class="Keyword">open</a> <a id="660" class="Keyword">import</a> <a id="667" href="Prelude.Lists.html" class="Module">Prelude.Lists</a> <a id="681" class="Keyword">hiding</a> <a id="688" class="Symbol">(</a><a id="689" href="Prelude.Lists.Mappings.html#692" class="Function Operator">_↦_</a><a id="692" class="Symbol">)</a>
<a id="694" class="Keyword">open</a> <a id="699" class="Keyword">import</a> <a id="706" href="Prelude.Lists.Sublists.html" class="Module">Prelude.Lists.Sublists</a>
<a id="729" class="Keyword">open</a> <a id="734" class="Keyword">import</a> <a id="741" href="Prelude.Membership.html" class="Module">Prelude.Membership</a>
<a id="760" class="Keyword">open</a> <a id="765" class="Keyword">import</a> <a id="772" href="Prelude.Show.html" class="Module">Prelude.Show</a>


<a id="787" class="Keyword">data</a> <a id="Colour"></a><a id="792" href="Types.html#792" class="Datatype">Colour</a> <a id="799" class="Symbol">:</a> <a id="801" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="806" class="Keyword">where</a>
  <a id="Colour.Red"></a><a id="814" href="Types.html#814" class="InductiveConstructor">Red</a> <a id="Colour.Green"></a><a id="818" href="Types.html#818" class="InductiveConstructor">Green</a> <a id="Colour.White"></a><a id="824" href="Types.html#824" class="InductiveConstructor">White</a> <a id="Colour.Blue"></a><a id="830" href="Types.html#830" class="InductiveConstructor">Blue</a> <a id="Colour.Black"></a><a id="835" href="Types.html#835" class="InductiveConstructor">Black</a> <a id="841" class="Symbol">:</a> <a id="843" href="Types.html#792" class="Datatype">Colour</a>
<a id="850" class="Keyword">unquoteDecl</a> <a id="DecEq-Colour"></a><a id="862" href="Types.html#862" class="Function">DecEq-Colour</a> <a id="875" class="Symbol">=</a> <a id="877" href="Prelude.Generics.html#9852" class="Function">DERIVE</a> <a id="884" href="Prelude.DecEq.Core.html#97" class="Record">DecEq</a> <a id="890" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="892" class="Keyword">quote</a> <a id="898" href="Types.html#792" class="Datatype">Colour</a> <a id="905" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="907" href="Types.html#862" class="Function">DecEq-Colour</a> <a id="920" href="Data.List.Base.html#5025" class="Function Operator">]</a>

<a id="Colour⁇"></a><a id="923" href="Types.html#923" class="Function">Colour⁇</a> <a id="931" class="Symbol">=</a> <a id="933" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="939" href="Types.html#792" class="Datatype">Colour</a>

<a id="947" class="Keyword">pattern</a> <a id="colorless"></a><a id="955" href="Types.html#955" class="InductiveConstructor">colorless</a> <a id="965" class="Symbol">=</a> <a id="967" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
<a id="975" class="Keyword">pattern</a> <a id="colored"></a><a id="983" href="Types.html#983" class="InductiveConstructor">colored</a> <a id="991" href="Types.html#1000" class="Bound">x</a> <a id="993" class="Symbol">=</a> <a id="995" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="1000" href="Types.html#1000" class="Bound">x</a>
<a id="1002" class="Keyword">pattern</a> <a id="R"></a><a id="1010" href="Types.html#1010" class="InductiveConstructor">R</a> <a id="1012" class="Symbol">=</a> <a id="1014" href="Types.html#983" class="InductiveConstructor">colored</a> <a id="1022" href="Types.html#814" class="InductiveConstructor">Red</a>
<a id="1026" class="Keyword">pattern</a> <a id="G"></a><a id="1034" href="Types.html#1034" class="InductiveConstructor">G</a> <a id="1036" class="Symbol">=</a> <a id="1038" href="Types.html#983" class="InductiveConstructor">colored</a> <a id="1046" href="Types.html#818" class="InductiveConstructor">Green</a>
<a id="1052" class="Keyword">pattern</a> <a id="W"></a><a id="1060" href="Types.html#1060" class="InductiveConstructor">W</a> <a id="1062" class="Symbol">=</a> <a id="1064" href="Types.html#983" class="InductiveConstructor">colored</a> <a id="1072" href="Types.html#824" class="InductiveConstructor">White</a>
<a id="1078" class="Keyword">pattern</a> <a id="U"></a><a id="1086" href="Types.html#1086" class="InductiveConstructor">U</a> <a id="1088" class="Symbol">=</a> <a id="1090" href="Types.html#983" class="InductiveConstructor">colored</a> <a id="1098" href="Types.html#830" class="InductiveConstructor">Blue</a>
<a id="1103" class="Keyword">pattern</a> <a id="B"></a><a id="1111" href="Types.html#1111" class="InductiveConstructor">B</a> <a id="1113" class="Symbol">=</a> <a id="1115" href="Types.html#983" class="InductiveConstructor">colored</a> <a id="1123" href="Types.html#835" class="InductiveConstructor">Black</a>
<a id="1129" class="Keyword">pattern</a> <a id="C"></a><a id="1137" href="Types.html#1137" class="InductiveConstructor">C</a> <a id="1139" class="Symbol">=</a> <a id="1141" href="Types.html#955" class="InductiveConstructor">colorless</a>

<a id="Mana"></a><a id="1152" href="Types.html#1152" class="Function">Mana</a> <a id="1157" class="Symbol">=</a> <a id="1159" href="Prelude.Maps.Concrete.html#517" class="Record">Map⟨</a> <a id="1164" href="Types.html#923" class="Function">Colour⁇</a> <a id="1172" href="Prelude.Maps.Concrete.html#517" class="Record">↦</a> <a id="1174" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1176" href="Prelude.Maps.Concrete.html#517" class="Record">⟩</a>
<a id="ManaPool"></a><a id="1178" href="Types.html#1178" class="Function">ManaPool</a> <a id="1187" class="Symbol">=</a> <a id="1189" href="Types.html#1152" class="Function">Mana</a>
<a id="ManaCost"></a><a id="1194" href="Types.html#1194" class="Function">ManaCost</a> <a id="1203" class="Symbol">=</a> <a id="1205" href="Types.html#1152" class="Function">Mana</a>
<a id="CardCost"></a><a id="1210" href="Types.html#1210" class="Function">CardCost</a> <a id="1219" class="Symbol">=</a> <a id="1221" href="Prelude.Sets.Concrete.html#933" class="Record">S.Set⟨</a> <a id="1228" href="Types.html#1194" class="Function">ManaCost</a> <a id="1237" href="Prelude.Sets.Concrete.html#933" class="Record">⟩</a>
<a id="ManaCostChoices"></a><a id="1239" href="Types.html#1239" class="Function">ManaCostChoices</a> <a id="1255" class="Symbol">=</a> <a id="1257" href="Prelude.Maps.Concrete.html#517" class="Record">Map⟨</a> <a id="1262" href="Prelude.Sets.Concrete.html#7514" class="Record">S.Set⁺⟨</a> <a id="1270" href="Types.html#923" class="Function">Colour⁇</a> <a id="1278" href="Prelude.Sets.Concrete.html#7514" class="Record">⟩</a> <a id="1280" href="Prelude.Maps.Concrete.html#517" class="Record">↦</a> <a id="1282" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1284" href="Prelude.Maps.Concrete.html#517" class="Record">⟩</a>
<a id="1286" class="Keyword">private</a> <a id="1294" class="Keyword">variable</a>
  <a id="1305" href="Types.html#1305" class="Generalizable">mp</a> <a id="1308" href="Types.html#1308" class="Generalizable">mp′</a> <a id="1312" class="Symbol">:</a> <a id="1314" href="Types.html#1178" class="Function">ManaPool</a>
  <a id="1325" href="Types.html#1325" class="Generalizable">mc</a> <a id="1328" href="Types.html#1328" class="Generalizable">mc′</a> <a id="1332" class="Symbol">:</a> <a id="1334" href="Types.html#1194" class="Function">ManaCost</a>
  <a id="1345" href="Types.html#1345" class="Generalizable">cc</a> <a id="1348" href="Types.html#1348" class="Generalizable">cc′</a> <a id="1352" class="Symbol">:</a> <a id="1354" href="Types.html#1210" class="Function">CardCost</a>
  <a id="1365" href="Types.html#1365" class="Generalizable">mcc</a> <a id="1369" href="Types.html#1369" class="Generalizable">mcc′</a> <a id="1374" class="Symbol">:</a> <a id="1376" href="Types.html#1239" class="Function">ManaCostChoices</a>

<a id="1393" class="Keyword">instance</a> <a id="1402" href="Types.html#1402" class="Function">_</a> <a id="1404" class="Symbol">=</a> <a id="1406" href="Prelude.Semigroup.html#2115" class="Function">Semigroup-ℕ-+</a>
<a id="1420" class="Keyword">instance</a> <a id="1429" href="Types.html#1429" class="Function">_</a> <a id="1431" class="Symbol">=</a> <a id="1433" href="Prelude.Monoid.html#1340" class="Function">Monoid-ℕ-+</a>

<a id="_─ᵐ_"></a><a id="1445" href="Types.html#1445" class="Function Operator">_─ᵐ_</a> <a id="1450" class="Symbol">:</a> <a id="1452" href="Types.html#1152" class="Function">Mana</a> <a id="1457" class="Symbol">→</a> <a id="1459" href="Types.html#1152" class="Function">Mana</a> <a id="1464" class="Symbol">→</a> <a id="1466" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="1472" href="Types.html#1152" class="Function">Mana</a>
<a id="1477" href="Types.html#1445" class="Function Operator">_─ᵐ_</a> <a id="1482" class="Symbol">=</a> <a id="1484" href="Prelude.Maps.Concrete.html#3822" class="Function Operator">_-ᵐ_</a> <a id="1489" href="Data.Nat.Base.html#2874" class="Primitive Operator">_∸_</a>

<a id="1494" class="Keyword">infix</a> <a id="1500" class="Number">10</a> <a id="1503" href="Types.html#1507" class="Function Operator">_↦_</a>
<a id="_↦_"></a><a id="1507" href="Types.html#1507" class="Function Operator">_↦_</a> <a id="1511" class="Symbol">=</a> <a id="1513" class="Symbol">(</a><a id="1514" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="1520" href="Types.html#792" class="Datatype">Colour</a> <a id="1527" class="Symbol">→</a> <a id="1529" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1531" class="Symbol">→</a> <a id="1533" href="Types.html#1152" class="Function">Mana</a><a id="1537" class="Symbol">)</a> <a id="1539" href="Function.Base.html#4562" class="Function Operator">∋</a> <a id="1541" href="Prelude.Maps.Concrete.html#930" class="Function">singleton</a> <a id="1551" href="Function.Base.html#1219" class="Function Operator">∘₂</a> <a id="1554" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a>

<a id="calculateCost"></a><a id="1559" href="Types.html#1559" class="Function">calculateCost</a> <a id="1573" class="Symbol">:</a> <a id="1575" href="Types.html#1239" class="Function">ManaCostChoices</a> <a id="1591" class="Symbol">→</a> <a id="1593" href="Types.html#1210" class="Function">CardCost</a>
<a id="1602" href="Types.html#1559" class="Function">calculateCost</a> <a id="1616" class="Symbol">=</a> <a id="1618" href="Types.html#1806" class="Function">go∗</a> <a id="1622" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1624" href="Prelude.ToList.html#173" class="Function Operator">_∙toList</a>
  <a id="1635" class="Keyword">where</a>
    <a id="1645" href="Types.html#1645" class="Function">go</a> <a id="1648" class="Symbol">:</a> <a id="1650" href="Data.List.NonEmpty.Base.html#1079" class="Record">List⁺</a> <a id="1656" href="Types.html#923" class="Function">Colour⁇</a> <a id="1664" class="Symbol">→</a> <a id="1666" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1668" class="Symbol">→</a> <a id="1670" href="Types.html#1210" class="Function">CardCost</a>
    <a id="1683" href="Types.html#1645" class="Function">go</a> <a id="1686" class="Symbol">(</a><a id="1687" href="Types.html#1687" class="Bound">x</a> <a id="1689" href="Data.List.NonEmpty.Base.html#1125" class="InductiveConstructor Operator">∷</a> <a id="1691" href="Types.html#1691" class="Bound">xs</a><a id="1693" class="Symbol">)</a> <a id="1695" href="Types.html#1695" class="Bound">n</a> <a id="1697" class="Keyword">with</a> <a id="1702" href="Types.html#1691" class="Bound">xs</a>
    <a id="1709" class="Symbol">...</a> <a id="1713" class="Symbol">|</a> <a id="1715" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>     <a id="1722" class="Symbol">=</a> <a id="1724" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="1736" class="Symbol">(</a><a id="1737" class="Bound">x</a> <a id="1739" href="Types.html#1507" class="Function Operator">↦</a> <a id="1741" class="Bound">n</a><a id="1742" class="Symbol">)</a>
    <a id="1748" class="Symbol">...</a> <a id="1752" class="Symbol">|</a> <a id="1754" href="Types.html#1754" class="Bound">y</a> <a id="1756" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1758" href="Types.html#1758" class="Bound">ys</a> <a id="1761" class="Symbol">=</a> <a id="1763" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="1775" class="Symbol">(</a><a id="1776" class="Bound">x</a> <a id="1778" href="Types.html#1507" class="Function Operator">↦</a> <a id="1780" class="Bound">n</a><a id="1781" class="Symbol">)</a> <a id="1783" href="Prelude.Sets.Concrete.html#2693" class="Function Operator">S.∪</a> <a id="1787" href="Types.html#1645" class="Function">go</a> <a id="1790" class="Symbol">(</a><a id="1791" href="Types.html#1754" class="Bound">y</a> <a id="1793" href="Data.List.NonEmpty.Base.html#1125" class="InductiveConstructor Operator">∷</a> <a id="1795" href="Types.html#1758" class="Bound">ys</a><a id="1797" class="Symbol">)</a> <a id="1799" class="Bound">n</a>

    <a id="1806" href="Types.html#1806" class="Function">go∗</a> <a id="1810" class="Symbol">:</a> <a id="1812" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1817" class="Symbol">(</a><a id="1818" href="Prelude.Sets.Concrete.html#7514" class="Record">S.Set⁺⟨</a> <a id="1826" href="Types.html#923" class="Function">Colour⁇</a> <a id="1834" href="Prelude.Sets.Concrete.html#7514" class="Record">⟩</a> <a id="1836" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1838" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1839" class="Symbol">)</a> <a id="1841" class="Symbol">→</a> <a id="1843" href="Types.html#1210" class="Function">CardCost</a>
    <a id="1856" href="Types.html#1806" class="Function">go∗</a> <a id="1860" class="Symbol">=</a> <a id="1862" class="Symbol">λ</a> <a id="1864" class="Keyword">where</a>
      <a id="1876" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="1879" class="Symbol">→</a> <a id="1881" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="1893" class="Symbol">(</a><a id="1894" href="Types.html#1137" class="InductiveConstructor">C</a> <a id="1896" href="Types.html#1507" class="Function Operator">↦</a> <a id="1898" class="Number">0</a><a id="1899" class="Symbol">)</a>
      <a id="1907" class="Symbol">((</a><a id="1909" href="Types.html#1909" class="Bound">s⁺</a> <a id="1912" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1914" href="Types.html#1914" class="Bound">n</a><a id="1915" class="Symbol">)</a> <a id="1917" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1919" href="Types.html#1919" class="Bound">kvs</a><a id="1922" class="Symbol">)</a> <a id="1924" class="Symbol">→</a> <a id="1926" href="Prelude.FromList.html#155" class="Field">fromList</a>
                       <a id="1958" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="1960" href="Data.List.Base.html#4394" class="Function">L.concat</a>
                       <a id="1992" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="1994" class="Symbol">(</a><a id="1995" href="Types.html#2095" class="Function Operator">_⊗</a> <a id="1998" class="Symbol">(</a><a id="1999" href="Types.html#1806" class="Function">go∗</a> <a id="2003" href="Types.html#1919" class="Bound">kvs</a> <a id="2007" href="Prelude.ToList.html#173" class="Function Operator">∙toList</a><a id="2014" class="Symbol">))</a>
                     <a id="2038" href="Prelude.Functor.html#301" class="Field Operator">&lt;$&gt;</a> <a id="2042" href="Types.html#1645" class="Function">go</a> <a id="2045" class="Symbol">(</a><a id="2046" href="Prelude.Sets.Concrete.html#7984" class="Function">S.toList&#39;⁺</a> <a id="2057" href="Types.html#1909" class="Bound">s⁺</a><a id="2059" class="Symbol">)</a> <a id="2061" href="Types.html#1914" class="Bound">n</a> <a id="2063" href="Prelude.ToList.html#173" class="Function Operator">∙toList</a>
        <a id="2079" class="Keyword">where</a>
          <a id="2095" href="Types.html#2095" class="Function Operator">_⊗_</a> <a id="2099" class="Symbol">:</a> <a id="2101" href="Types.html#1194" class="Function">ManaCost</a> <a id="2110" class="Symbol">→</a> <a id="2112" href="Algebra.Core.html#475" class="Function">Op₁</a> <a id="2116" class="Symbol">(</a><a id="2117" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2122" href="Types.html#1194" class="Function">ManaCost</a><a id="2130" class="Symbol">)</a>
          <a id="2142" href="Types.html#2142" class="Bound">m</a> <a id="2144" href="Types.html#2095" class="Function Operator">⊗</a> <a id="2146" href="Types.html#2146" class="Bound">cur</a> <a id="2150" class="Symbol">=</a> <a id="2152" href="Data.List.Base.html#1544" class="Function">map</a> <a id="2156" class="Symbol">(</a><a id="2157" href="Prelude.Semigroup.html#158" class="Field Operator">_◇</a> <a id="2160" href="Types.html#2142" class="Bound">m</a><a id="2161" class="Symbol">)</a> <a id="2163" href="Types.html#2146" class="Bound">cur</a>

<a id="2168" class="Keyword">private</a>
  <a id="2178" href="Types.html#2178" class="Function">_</a> <a id="2180" class="Symbol">:</a> <a id="2182" href="Types.html#1152" class="Function">Mana</a> <a id="2187" class="Comment">-- 0</a>
  <a id="2194" class="Symbol">_</a> <a id="2196" class="Symbol">=</a> <a id="2198" href="Prelude.Maps.Concrete.html#906" class="Function">∅</a>

  <a id="m"></a><a id="2203" href="Types.html#2203" class="Function">m</a> <a id="2205" class="Symbol">:</a> <a id="2207" href="Types.html#1152" class="Function">Mana</a>
  <a id="2214" href="Types.html#2203" class="Function">m</a> <a id="2216" class="Symbol">=</a> <a id="2218" href="Types.html#1137" class="InductiveConstructor">C</a> <a id="2220" href="Types.html#1507" class="Function Operator">↦</a> <a id="2222" class="Number">2</a> <a id="2224" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2226" href="Types.html#1060" class="InductiveConstructor">W</a> <a id="2228" href="Types.html#1507" class="Function Operator">↦</a> <a id="2230" class="Number">2</a>

  <a id="m′"></a><a id="2235" href="Types.html#2235" class="Function">m′</a> <a id="2238" class="Symbol">:</a> <a id="2240" href="Types.html#1152" class="Function">Mana</a>
  <a id="2247" href="Types.html#2235" class="Function">m′</a> <a id="2250" class="Symbol">=</a> <a id="2252" href="Types.html#1137" class="InductiveConstructor">C</a> <a id="2254" href="Types.html#1507" class="Function Operator">↦</a> <a id="2256" class="Number">4</a> <a id="2258" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2260" href="Types.html#1060" class="InductiveConstructor">W</a> <a id="2262" href="Types.html#1507" class="Function Operator">↦</a> <a id="2264" class="Number">2</a>

  <a id="2269" href="Types.html#2269" class="Function">_</a> <a id="2271" class="Symbol">:</a> <a id="2273" href="Types.html#2203" class="Function">m</a> <a id="2275" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2277" href="Types.html#2235" class="Function">m′</a>
    <a id="2284" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2286" href="Types.html#1060" class="InductiveConstructor">W</a> <a id="2288" href="Types.html#1507" class="Function Operator">↦</a> <a id="2290" class="Number">4</a> <a id="2292" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2294" href="Types.html#1137" class="InductiveConstructor">C</a> <a id="2296" href="Types.html#1507" class="Function Operator">↦</a> <a id="2298" class="Number">6</a>
  <a id="2302" class="Symbol">_</a> <a id="2304" class="Symbol">=</a> <a id="2306" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

  <a id="2314" class="Comment">-- this is *not* setoid equality</a>
  <a id="2349" href="Types.html#2349" class="Function">_</a> <a id="2351" class="Symbol">:</a> <a id="2353" href="Types.html#2203" class="Function">m</a> <a id="2355" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2357" href="Types.html#2235" class="Function">m′</a>
    <a id="2364" href="Relation.Binary.PropositionalEquality.Core.html#830" class="Function Operator">≢</a> <a id="2366" href="Types.html#1137" class="InductiveConstructor">C</a> <a id="2368" href="Types.html#1507" class="Function Operator">↦</a> <a id="2370" class="Number">6</a> <a id="2372" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2374" href="Types.html#1060" class="InductiveConstructor">W</a> <a id="2376" href="Types.html#1507" class="Function Operator">↦</a> <a id="2378" class="Number">4</a>
  <a id="2382" class="Symbol">_</a> <a id="2384" class="Symbol">=</a> <a id="2386" class="Symbol">λ</a> <a id="2388" class="Symbol">()</a>

  <a id="2394" class="Comment">-- this *is* setoid equality</a>
  <a id="2425" href="Types.html#2425" class="Function">_</a> <a id="2427" class="Symbol">:</a> <a id="2429" class="Symbol">(</a><a id="2430" href="Types.html#2203" class="Function">m</a> <a id="2432" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2434" href="Types.html#2235" class="Function">m′</a><a id="2436" class="Symbol">)</a>
   <a id="2441" href="Prelude.Maps.Concrete.html#3647" class="Function Operator">≈ᵐ</a> <a id="2444" class="Symbol">(</a><a id="2445" href="Types.html#1137" class="InductiveConstructor">C</a> <a id="2447" href="Types.html#1507" class="Function Operator">↦</a> <a id="2449" class="Number">6</a> <a id="2451" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2453" href="Types.html#1060" class="InductiveConstructor">W</a> <a id="2455" href="Types.html#1507" class="Function Operator">↦</a> <a id="2457" class="Number">4</a><a id="2458" class="Symbol">)</a>
  <a id="2462" class="Symbol">_</a> <a id="2464" class="Symbol">=</a> <a id="2466" href="Prelude.Decidable.html#212" class="Function">auto</a>

  <a id="2474" href="Types.html#2474" class="Function">_</a> <a id="2476" class="Symbol">:</a> <a id="2478" href="Types.html#1178" class="Function">ManaPool</a>
  <a id="2489" class="Symbol">_</a> <a id="2491" class="Symbol">=</a> <a id="2493" href="Types.html#1137" class="InductiveConstructor">C</a> <a id="2495" href="Types.html#1507" class="Function Operator">↦</a> <a id="2497" class="Number">2</a> <a id="2499" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2501" href="Types.html#1060" class="InductiveConstructor">W</a> <a id="2503" href="Types.html#1507" class="Function Operator">↦</a> <a id="2505" class="Number">2</a> <a id="2507" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2509" href="Types.html#1010" class="InductiveConstructor">R</a> <a id="2511" href="Types.html#1507" class="Function Operator">↦</a> <a id="2513" class="Number">1</a>

  <a id="1BBB"></a><a id="2518" href="Types.html#2518" class="Function">1BBB</a> <a id="2523" class="Symbol">=</a> <a id="2525" href="Types.html#1194" class="Function">ManaCost</a> <a id="2534" class="Comment">-- 1BBB</a>
    <a id="2546" href="Function.Base.html#4562" class="Function Operator">∋</a> <a id="2548" href="Types.html#1137" class="InductiveConstructor">C</a> <a id="2550" href="Types.html#1507" class="Function Operator">↦</a> <a id="2552" class="Number">1</a> <a id="2554" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2556" href="Types.html#1111" class="InductiveConstructor">B</a> <a id="2558" href="Types.html#1507" class="Function Operator">↦</a> <a id="2560" class="Number">3</a>
  <a id="2WW"></a><a id="2564" href="Types.html#2564" class="Function">2WW</a> <a id="2568" class="Symbol">=</a> <a id="2570" href="Types.html#1194" class="Function">ManaCost</a> <a id="2579" class="Comment">-- 2WW</a>
    <a id="2590" href="Function.Base.html#4562" class="Function Operator">∋</a> <a id="2592" href="Types.html#1137" class="InductiveConstructor">C</a> <a id="2594" href="Types.html#1507" class="Function Operator">↦</a> <a id="2596" class="Number">2</a> <a id="2598" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2600" href="Types.html#1060" class="InductiveConstructor">W</a> <a id="2602" href="Types.html#1507" class="Function Operator">↦</a> <a id="2604" class="Number">2</a>
  <a id="2WW/1BBB"></a><a id="2608" href="Types.html#2608" class="Function">2WW/1BBB</a> <a id="2617" class="Symbol">=</a> <a id="2619" href="Types.html#1210" class="Function">CardCost</a> <a id="2628" class="Comment">-- 2WW/1BBB</a>
    <a id="2644" href="Function.Base.html#4562" class="Function Operator">∋</a> <a id="2646" href="Prelude.FromList.html#155" class="Field">fromList</a> <a id="2655" href="Prelude.Nary.html#207" class="Function Operator">⟦</a> <a id="2657" href="Types.html#2564" class="Function">2WW</a> <a id="2661" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2663" href="Types.html#2518" class="Function">1BBB</a> <a id="2668" href="Prelude.Nary.html#207" class="Function Operator">⟧</a>

  <a id="2673" href="Types.html#2673" class="Function">_</a> <a id="2675" class="Symbol">=</a> <a id="2677" href="Types.html#1210" class="Function">CardCost</a> <a id="2686" class="Comment">-- 2WW(R|G) aka 2WWR|2WWG)</a>
    <a id="2717" href="Function.Base.html#4562" class="Function Operator">∋</a> <a id="2719" href="Prelude.FromList.html#155" class="Field">fromList</a>
        <a id="2736" href="Prelude.Nary.html#207" class="Function Operator">⟦</a> <a id="2738" href="Types.html#1137" class="InductiveConstructor">C</a> <a id="2740" href="Types.html#1507" class="Function Operator">↦</a> <a id="2742" class="Number">2</a> <a id="2744" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2746" href="Types.html#1060" class="InductiveConstructor">W</a> <a id="2748" href="Types.html#1507" class="Function Operator">↦</a> <a id="2750" class="Number">2</a> <a id="2752" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2754" href="Types.html#1010" class="InductiveConstructor">R</a> <a id="2756" href="Types.html#1507" class="Function Operator">↦</a> <a id="2758" class="Number">1</a>
        <a id="2768" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2770" href="Types.html#1137" class="InductiveConstructor">C</a> <a id="2772" href="Types.html#1507" class="Function Operator">↦</a> <a id="2774" class="Number">2</a> <a id="2776" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2778" href="Types.html#1060" class="InductiveConstructor">W</a> <a id="2780" href="Types.html#1507" class="Function Operator">↦</a> <a id="2782" class="Number">2</a> <a id="2784" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2786" href="Types.html#1034" class="InductiveConstructor">G</a> <a id="2788" href="Types.html#1507" class="Function Operator">↦</a> <a id="2790" class="Number">1</a>
        <a id="2800" href="Prelude.Nary.html#207" class="Function Operator">⟧</a>

  <a id="2805" href="Types.html#2805" class="Function">_</a> <a id="2807" class="Symbol">=</a> <a id="2809" href="Types.html#1239" class="Function">ManaCostChoices</a> <a id="2825" class="Comment">-- 2WW(R|G)</a>
    <a id="2841" href="Function.Base.html#4562" class="Function Operator">∋</a> <a id="2843" href="Prelude.Maps.Concrete.html#930" class="Function">singleton</a> <a id="2853" class="Symbol">(</a><a id="2854" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="2866" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="2868" href="Types.html#1137" class="InductiveConstructor">C</a> <a id="2870" href="Data.List.Base.html#5025" class="Function Operator">]</a>     <a id="2876" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2878" class="Number">2</a><a id="2879" class="Symbol">)</a>
    <a id="2885" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2887" href="Prelude.Maps.Concrete.html#930" class="Function">singleton</a> <a id="2897" class="Symbol">(</a><a id="2898" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="2910" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="2912" href="Types.html#1060" class="InductiveConstructor">W</a> <a id="2914" href="Data.List.Base.html#5025" class="Function Operator">]</a>     <a id="2920" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2922" class="Number">2</a><a id="2923" class="Symbol">)</a>
    <a id="2929" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="2931" href="Prelude.Maps.Concrete.html#930" class="Function">singleton</a> <a id="2941" class="Symbol">(</a><a id="2942" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="2954" href="Prelude.Nary.html#207" class="Function Operator">⟦</a> <a id="2956" href="Types.html#1010" class="InductiveConstructor">R</a> <a id="2958" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2960" href="Types.html#1034" class="InductiveConstructor">G</a> <a id="2962" href="Prelude.Nary.html#207" class="Function Operator">⟧</a> <a id="2964" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2966" class="Number">1</a><a id="2967" class="Symbol">)</a>

  <a id="2972" href="Types.html#2972" class="Function">_</a> <a id="2974" class="Symbol">:</a> <a id="2976" href="Types.html#1559" class="Function">calculateCost</a> <a id="2990" href="Prelude.Maps.Concrete.html#906" class="Function">∅</a>
    <a id="2996" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2998" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="3010" class="Symbol">(</a><a id="3011" href="Types.html#1137" class="InductiveConstructor">C</a> <a id="3013" href="Types.html#1507" class="Function Operator">↦</a> <a id="3015" class="Number">0</a><a id="3016" class="Symbol">)</a>
  <a id="3020" class="Symbol">_</a> <a id="3022" class="Symbol">=</a> <a id="3024" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

  <a id="3032" href="Types.html#3032" class="Function">_</a> <a id="3034" class="Symbol">:</a> <a id="3036" href="Types.html#1559" class="Function">calculateCost</a> <a id="3050" class="Symbol">(</a><a id="3051" href="Prelude.Maps.Concrete.html#930" class="Function">singleton</a> <a id="3061" class="Symbol">(</a><a id="3062" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="3074" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="3076" href="Types.html#1137" class="InductiveConstructor">C</a> <a id="3078" href="Data.List.Base.html#5025" class="Function Operator">]</a> <a id="3080" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3082" class="Number">0</a><a id="3083" class="Symbol">))</a>
    <a id="3090" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="3092" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="3104" class="Symbol">(</a><a id="3105" href="Types.html#1137" class="InductiveConstructor">C</a> <a id="3107" href="Types.html#1507" class="Function Operator">↦</a> <a id="3109" class="Number">0</a><a id="3110" class="Symbol">)</a>
  <a id="3114" class="Symbol">_</a> <a id="3116" class="Symbol">=</a> <a id="3118" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

  <a id="3126" href="Types.html#3126" class="Function">_</a> <a id="3128" class="Symbol">:</a> <a id="3130" href="Types.html#1559" class="Function">calculateCost</a> <a id="3144" class="Symbol">(</a><a id="3145" href="Prelude.Maps.Concrete.html#930" class="Function">singleton</a> <a id="3155" class="Symbol">(</a><a id="3156" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="3168" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="3170" href="Types.html#1010" class="InductiveConstructor">R</a> <a id="3172" href="Data.List.Base.html#5025" class="Function Operator">]</a> <a id="3174" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3176" class="Number">1</a><a id="3177" class="Symbol">))</a>
    <a id="3184" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="3186" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="3198" class="Symbol">(</a><a id="3199" href="Types.html#1137" class="InductiveConstructor">C</a> <a id="3201" href="Types.html#1507" class="Function Operator">↦</a> <a id="3203" class="Number">0</a> <a id="3205" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3207" href="Types.html#1010" class="InductiveConstructor">R</a> <a id="3209" href="Types.html#1507" class="Function Operator">↦</a> <a id="3211" class="Number">1</a><a id="3212" class="Symbol">)</a>
  <a id="3216" class="Symbol">_</a> <a id="3218" class="Symbol">=</a> <a id="3220" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

  <a id="3228" href="Types.html#3228" class="Function">_</a> <a id="3230" class="Symbol">:</a> <a id="3232" href="Types.html#1559" class="Function">calculateCost</a> <a id="3246" class="Symbol">(</a><a id="3247" href="Prelude.Maps.Concrete.html#930" class="Function">singleton</a> <a id="3257" class="Symbol">(</a><a id="3258" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="3270" class="Symbol">(</a><a id="3271" href="Types.html#1010" class="InductiveConstructor">R</a> <a id="3273" class="InductiveConstructor Operator">∷</a> <a id="3275" href="Types.html#1034" class="InductiveConstructor">G</a> <a id="3277" class="InductiveConstructor Operator">∷</a> <a id="3279" class="InductiveConstructor">[]</a><a id="3281" class="Symbol">)</a> <a id="3283" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3285" class="Number">1</a><a id="3286" class="Symbol">))</a>
    <a id="3293" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a>   <a id="3297" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="3309" class="Symbol">(</a><a id="3310" href="Types.html#1137" class="InductiveConstructor">C</a> <a id="3312" href="Types.html#1507" class="Function Operator">↦</a> <a id="3314" class="Number">0</a> <a id="3316" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3318" href="Types.html#1010" class="InductiveConstructor">R</a> <a id="3320" href="Types.html#1507" class="Function Operator">↦</a> <a id="3322" class="Number">1</a><a id="3323" class="Symbol">)</a>
    <a id="3329" href="Prelude.Sets.Concrete.html#2693" class="Function Operator">S.∪</a> <a id="3333" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="3345" class="Symbol">(</a><a id="3346" href="Types.html#1137" class="InductiveConstructor">C</a> <a id="3348" href="Types.html#1507" class="Function Operator">↦</a> <a id="3350" class="Number">0</a> <a id="3352" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3354" href="Types.html#1034" class="InductiveConstructor">G</a> <a id="3356" href="Types.html#1507" class="Function Operator">↦</a> <a id="3358" class="Number">1</a><a id="3359" class="Symbol">)</a>
  <a id="3363" class="Symbol">_</a> <a id="3365" class="Symbol">=</a> <a id="3367" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

  <a id="3375" href="Types.html#3375" class="Function">_</a> <a id="3377" class="Symbol">:</a> <a id="3379" href="Types.html#1559" class="Function">calculateCost</a> <a id="3393" class="Symbol">(</a> <a id="3395" href="Prelude.Maps.Concrete.html#930" class="Function">singleton</a> <a id="3405" class="Symbol">(</a><a id="3406" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="3418" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="3420" href="Types.html#1137" class="InductiveConstructor">C</a> <a id="3422" href="Data.List.Base.html#5025" class="Function Operator">]</a> <a id="3424" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3426" class="Number">2</a><a id="3427" class="Symbol">)</a>
                    <a id="3449" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3451" href="Prelude.Maps.Concrete.html#930" class="Function">singleton</a> <a id="3461" class="Symbol">(</a><a id="3462" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="3474" class="Symbol">(</a><a id="3475" href="Types.html#1010" class="InductiveConstructor">R</a> <a id="3477" class="InductiveConstructor Operator">∷</a> <a id="3479" href="Types.html#1034" class="InductiveConstructor">G</a> <a id="3481" class="InductiveConstructor Operator">∷</a> <a id="3483" class="InductiveConstructor">[]</a><a id="3485" class="Symbol">)</a> <a id="3487" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3489" class="Number">1</a><a id="3490" class="Symbol">))</a>
    <a id="3497" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a>   <a id="3501" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="3513" class="Symbol">(</a><a id="3514" href="Types.html#1010" class="InductiveConstructor">R</a> <a id="3516" href="Types.html#1507" class="Function Operator">↦</a> <a id="3518" class="Number">1</a> <a id="3520" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3522" href="Types.html#1137" class="InductiveConstructor">C</a> <a id="3524" href="Types.html#1507" class="Function Operator">↦</a> <a id="3526" class="Number">2</a><a id="3527" class="Symbol">)</a>
    <a id="3533" href="Prelude.Sets.Concrete.html#2693" class="Function Operator">S.∪</a> <a id="3537" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="3549" class="Symbol">(</a><a id="3550" href="Types.html#1034" class="InductiveConstructor">G</a> <a id="3552" href="Types.html#1507" class="Function Operator">↦</a> <a id="3554" class="Number">1</a> <a id="3556" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3558" href="Types.html#1137" class="InductiveConstructor">C</a> <a id="3560" href="Types.html#1507" class="Function Operator">↦</a> <a id="3562" class="Number">2</a><a id="3563" class="Symbol">)</a>
  <a id="3567" class="Symbol">_</a> <a id="3569" class="Symbol">=</a> <a id="3571" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

  <a id="3579" href="Types.html#3579" class="Function">_</a> <a id="3581" class="Symbol">:</a> <a id="3583" href="Types.html#1559" class="Function">calculateCost</a> <a id="3597" class="Symbol">(</a> <a id="3599" href="Prelude.Maps.Concrete.html#930" class="Function">singleton</a> <a id="3609" class="Symbol">(</a><a id="3610" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="3622" class="Symbol">(</a><a id="3623" href="Types.html#1111" class="InductiveConstructor">B</a> <a id="3625" class="InductiveConstructor Operator">∷</a> <a id="3627" href="Types.html#1086" class="InductiveConstructor">U</a> <a id="3629" class="InductiveConstructor Operator">∷</a> <a id="3631" class="InductiveConstructor">[]</a><a id="3633" class="Symbol">)</a> <a id="3635" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3637" class="Number">1</a><a id="3638" class="Symbol">)</a>
                    <a id="3660" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3662" href="Prelude.Maps.Concrete.html#930" class="Function">singleton</a> <a id="3672" class="Symbol">(</a><a id="3673" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="3685" class="Symbol">(</a><a id="3686" href="Types.html#1010" class="InductiveConstructor">R</a> <a id="3688" class="InductiveConstructor Operator">∷</a> <a id="3690" href="Types.html#1034" class="InductiveConstructor">G</a> <a id="3692" class="InductiveConstructor Operator">∷</a> <a id="3694" class="InductiveConstructor">[]</a><a id="3696" class="Symbol">)</a> <a id="3698" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3700" class="Number">1</a><a id="3701" class="Symbol">))</a>
    <a id="3708" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a>   <a id="3712" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="3724" class="Symbol">(</a><a id="3725" href="Types.html#1137" class="InductiveConstructor">C</a> <a id="3727" href="Types.html#1507" class="Function Operator">↦</a> <a id="3729" class="Number">0</a> <a id="3731" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3733" href="Types.html#1111" class="InductiveConstructor">B</a> <a id="3735" href="Types.html#1507" class="Function Operator">↦</a> <a id="3737" class="Number">1</a> <a id="3739" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3741" href="Types.html#1010" class="InductiveConstructor">R</a> <a id="3743" href="Types.html#1507" class="Function Operator">↦</a> <a id="3745" class="Number">1</a><a id="3746" class="Symbol">)</a>
    <a id="3752" href="Prelude.Sets.Concrete.html#2693" class="Function Operator">S.∪</a> <a id="3756" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="3768" class="Symbol">(</a><a id="3769" href="Types.html#1137" class="InductiveConstructor">C</a> <a id="3771" href="Types.html#1507" class="Function Operator">↦</a> <a id="3773" class="Number">0</a> <a id="3775" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3777" href="Types.html#1111" class="InductiveConstructor">B</a> <a id="3779" href="Types.html#1507" class="Function Operator">↦</a> <a id="3781" class="Number">1</a> <a id="3783" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3785" href="Types.html#1034" class="InductiveConstructor">G</a> <a id="3787" href="Types.html#1507" class="Function Operator">↦</a> <a id="3789" class="Number">1</a><a id="3790" class="Symbol">)</a>
    <a id="3796" href="Prelude.Sets.Concrete.html#2693" class="Function Operator">S.∪</a> <a id="3800" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="3812" class="Symbol">(</a><a id="3813" href="Types.html#1137" class="InductiveConstructor">C</a> <a id="3815" href="Types.html#1507" class="Function Operator">↦</a> <a id="3817" class="Number">0</a> <a id="3819" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3821" href="Types.html#1086" class="InductiveConstructor">U</a> <a id="3823" href="Types.html#1507" class="Function Operator">↦</a> <a id="3825" class="Number">1</a> <a id="3827" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3829" href="Types.html#1010" class="InductiveConstructor">R</a> <a id="3831" href="Types.html#1507" class="Function Operator">↦</a> <a id="3833" class="Number">1</a><a id="3834" class="Symbol">)</a>
    <a id="3840" href="Prelude.Sets.Concrete.html#2693" class="Function Operator">S.∪</a> <a id="3844" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="3856" class="Symbol">(</a><a id="3857" href="Types.html#1137" class="InductiveConstructor">C</a> <a id="3859" href="Types.html#1507" class="Function Operator">↦</a> <a id="3861" class="Number">0</a> <a id="3863" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3865" href="Types.html#1086" class="InductiveConstructor">U</a> <a id="3867" href="Types.html#1507" class="Function Operator">↦</a> <a id="3869" class="Number">1</a> <a id="3871" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3873" href="Types.html#1034" class="InductiveConstructor">G</a> <a id="3875" href="Types.html#1507" class="Function Operator">↦</a> <a id="3877" class="Number">1</a><a id="3878" class="Symbol">)</a>
  <a id="3882" class="Symbol">_</a> <a id="3884" class="Symbol">=</a> <a id="3886" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

  <a id="3894" href="Types.html#3894" class="Function">_</a> <a id="3896" class="Symbol">:</a> <a id="3898" href="Types.html#1559" class="Function">calculateCost</a> <a id="3912" class="Symbol">(</a> <a id="3914" href="Prelude.Maps.Concrete.html#930" class="Function">singleton</a> <a id="3924" class="Symbol">(</a><a id="3925" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="3937" class="Symbol">(</a><a id="3938" href="Types.html#1010" class="InductiveConstructor">R</a> <a id="3940" class="InductiveConstructor Operator">∷</a> <a id="3942" href="Types.html#1086" class="InductiveConstructor">U</a> <a id="3944" class="InductiveConstructor Operator">∷</a> <a id="3946" class="InductiveConstructor">[]</a><a id="3948" class="Symbol">)</a> <a id="3950" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3952" class="Number">1</a><a id="3953" class="Symbol">)</a>
                    <a id="3975" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="3977" href="Prelude.Maps.Concrete.html#930" class="Function">singleton</a> <a id="3987" class="Symbol">(</a><a id="3988" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="4000" class="Symbol">(</a><a id="4001" href="Types.html#1010" class="InductiveConstructor">R</a> <a id="4003" class="InductiveConstructor Operator">∷</a> <a id="4005" href="Types.html#1034" class="InductiveConstructor">G</a> <a id="4007" class="InductiveConstructor Operator">∷</a> <a id="4009" class="InductiveConstructor">[]</a><a id="4011" class="Symbol">)</a> <a id="4013" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4015" class="Number">1</a><a id="4016" class="Symbol">))</a>
    <a id="4023" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a>   <a id="4027" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="4039" class="Symbol">(</a><a id="4040" href="Types.html#1137" class="InductiveConstructor">C</a> <a id="4042" href="Types.html#1507" class="Function Operator">↦</a> <a id="4044" class="Number">0</a> <a id="4046" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="4048" href="Types.html#1010" class="InductiveConstructor">R</a> <a id="4050" href="Types.html#1507" class="Function Operator">↦</a> <a id="4052" class="Number">2</a><a id="4053" class="Symbol">)</a>
    <a id="4059" href="Prelude.Sets.Concrete.html#2693" class="Function Operator">S.∪</a> <a id="4063" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="4075" class="Symbol">(</a><a id="4076" href="Types.html#1137" class="InductiveConstructor">C</a> <a id="4078" href="Types.html#1507" class="Function Operator">↦</a> <a id="4080" class="Number">0</a> <a id="4082" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="4084" href="Types.html#1010" class="InductiveConstructor">R</a> <a id="4086" href="Types.html#1507" class="Function Operator">↦</a> <a id="4088" class="Number">1</a> <a id="4090" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="4092" href="Types.html#1034" class="InductiveConstructor">G</a> <a id="4094" href="Types.html#1507" class="Function Operator">↦</a> <a id="4096" class="Number">1</a><a id="4097" class="Symbol">)</a>
    <a id="4103" href="Prelude.Sets.Concrete.html#2693" class="Function Operator">S.∪</a> <a id="4107" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="4119" class="Symbol">(</a><a id="4120" href="Types.html#1137" class="InductiveConstructor">C</a> <a id="4122" href="Types.html#1507" class="Function Operator">↦</a> <a id="4124" class="Number">0</a> <a id="4126" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="4128" href="Types.html#1086" class="InductiveConstructor">U</a> <a id="4130" href="Types.html#1507" class="Function Operator">↦</a> <a id="4132" class="Number">1</a> <a id="4134" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="4136" href="Types.html#1010" class="InductiveConstructor">R</a> <a id="4138" href="Types.html#1507" class="Function Operator">↦</a> <a id="4140" class="Number">1</a><a id="4141" class="Symbol">)</a>
    <a id="4147" href="Prelude.Sets.Concrete.html#2693" class="Function Operator">S.∪</a> <a id="4151" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="4163" class="Symbol">(</a><a id="4164" href="Types.html#1137" class="InductiveConstructor">C</a> <a id="4166" href="Types.html#1507" class="Function Operator">↦</a> <a id="4168" class="Number">0</a> <a id="4170" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="4172" href="Types.html#1086" class="InductiveConstructor">U</a> <a id="4174" href="Types.html#1507" class="Function Operator">↦</a> <a id="4176" class="Number">1</a> <a id="4178" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="4180" href="Types.html#1034" class="InductiveConstructor">G</a> <a id="4182" href="Types.html#1507" class="Function Operator">↦</a> <a id="4184" class="Number">1</a><a id="4185" class="Symbol">)</a>
  <a id="4189" class="Symbol">_</a> <a id="4191" class="Symbol">=</a> <a id="4193" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="4199" class="Comment">-- Cost = ManaCost ⊎ SacrificeCost</a>

<a id="4235" class="Keyword">data</a> <a id="CreatureType"></a><a id="4240" href="Types.html#4240" class="Datatype">CreatureType</a> <a id="4253" class="Symbol">:</a> <a id="4255" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="4260" class="Keyword">where</a>
  <a id="CreatureType.Human"></a><a id="4268" href="Types.html#4268" class="InductiveConstructor">Human</a> <a id="CreatureType.Soldier"></a><a id="4274" href="Types.html#4274" class="InductiveConstructor">Soldier</a> <a id="CreatureType.Dwarf"></a><a id="4282" href="Types.html#4282" class="InductiveConstructor">Dwarf</a> <a id="CreatureType.Vampire"></a><a id="4288" href="Types.html#4288" class="InductiveConstructor">Vampire</a> <a id="CreatureType.Ogre"></a><a id="4296" href="Types.html#4296" class="InductiveConstructor">Ogre</a> <a id="CreatureType.Warrior"></a><a id="4301" href="Types.html#4301" class="InductiveConstructor">Warrior</a> <a id="4309" class="Symbol">:</a> <a id="4311" href="Types.html#4240" class="Datatype">CreatureType</a>
<a id="4324" class="Keyword">unquoteDecl</a> <a id="DecEq-CreatureType"></a><a id="4336" href="Types.html#4336" class="Function">DecEq-CreatureType</a> <a id="4355" class="Symbol">=</a> <a id="4357" href="Prelude.Generics.html#9852" class="Function">DERIVE</a> <a id="4364" href="Prelude.DecEq.Core.html#97" class="Record">DecEq</a> <a id="4370" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="4372" class="Keyword">quote</a> <a id="4378" href="Types.html#4240" class="Datatype">CreatureType</a> <a id="4391" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4393" href="Types.html#4336" class="Function">DecEq-CreatureType</a> <a id="4412" href="Data.List.Base.html#5025" class="Function Operator">]</a>

<a id="4415" class="Keyword">record</a> <a id="CreatureStats"></a><a id="4422" href="Types.html#4422" class="Record">CreatureStats</a> <a id="4436" class="Symbol">:</a> <a id="4438" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="4443" class="Keyword">where</a>
  <a id="4451" class="Keyword">constructor</a> <a id="_/_"></a><a id="4463" href="Types.html#4463" class="InductiveConstructor Operator">_/_</a>
  <a id="4469" class="Keyword">field</a> <a id="CreatureStats.power"></a><a id="4475" href="Types.html#4475" class="Field">power</a>     <a id="4485" class="Symbol">:</a> <a id="4487" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
        <a id="CreatureStats.toughness"></a><a id="4497" href="Types.html#4497" class="Field">toughness</a> <a id="4507" class="Symbol">:</a> <a id="4509" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="4511" class="Keyword">open</a> <a id="4516" href="Types.html#4422" class="Module">CreatureStats</a> <a id="4530" class="Keyword">public</a>
<a id="4537" class="Keyword">unquoteDecl</a> <a id="DecEq-CreatureStats"></a><a id="4549" href="Types.html#4549" class="Function">DecEq-CreatureStats</a> <a id="4569" class="Symbol">=</a> <a id="4571" href="Prelude.Generics.html#9852" class="Function">DERIVE</a> <a id="4578" href="Prelude.DecEq.Core.html#97" class="Record">DecEq</a> <a id="4584" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="4586" class="Keyword">quote</a> <a id="4592" href="Types.html#4422" class="Record">CreatureStats</a> <a id="4606" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4608" href="Types.html#4549" class="Function">DecEq-CreatureStats</a> <a id="4628" href="Data.List.Base.html#5025" class="Function Operator">]</a>

<a id="4631" class="Keyword">data</a> <a id="Card"></a><a id="4636" href="Types.html#4636" class="Datatype">Card</a> <a id="4641" class="Symbol">:</a> <a id="4643" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="4648" class="Keyword">where</a>
  <a id="Card.BasicLand"></a><a id="4656" href="Types.html#4656" class="InductiveConstructor">BasicLand</a> <a id="4666" class="Symbol">:</a> <a id="4668" href="Types.html#792" class="Datatype">Colour</a> <a id="4675" class="Symbol">→</a> <a id="4677" href="Types.html#4636" class="Datatype">Card</a>
  <a id="Card.Creature"></a><a id="4684" href="Types.html#4684" class="InductiveConstructor">Creature</a>  <a id="4694" class="Symbol">:</a> <a id="4696" href="Types.html#1210" class="Function">CardCost</a> <a id="4705" class="Symbol">→</a> <a id="4707" href="Prelude.Sets.Concrete.html#7514" class="Record">S.Set⁺⟨</a> <a id="4715" href="Types.html#4240" class="Datatype">CreatureType</a> <a id="4728" href="Prelude.Sets.Concrete.html#7514" class="Record">⟩</a> <a id="4730" class="Symbol">→</a> <a id="4732" href="Types.html#4422" class="Record">CreatureStats</a> <a id="4746" class="Symbol">→</a> <a id="4748" href="Types.html#4636" class="Datatype">Card</a>
<a id="4753" class="Keyword">unquoteDecl</a> <a id="DecEq-Card"></a><a id="4765" href="Types.html#4765" class="Function">DecEq-Card</a> <a id="4776" class="Symbol">=</a> <a id="4778" href="Prelude.Generics.html#9852" class="Function">DERIVE</a> <a id="4785" href="Prelude.DecEq.Core.html#97" class="Record">DecEq</a> <a id="4791" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="4793" class="Keyword">quote</a> <a id="4799" href="Types.html#4636" class="Datatype">Card</a> <a id="4804" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4806" href="Types.html#4765" class="Function">DecEq-Card</a> <a id="4817" href="Data.List.Base.html#5025" class="Function Operator">]</a>
<a id="4819" class="Keyword">private</a> <a id="4827" class="Keyword">variable</a> <a id="4836" href="Types.html#4836" class="Generalizable">c</a> <a id="4838" href="Types.html#4838" class="Generalizable">c′</a> <a id="4841" href="Types.html#4841" class="Generalizable">c″</a> <a id="4844" class="Symbol">:</a> <a id="4846" href="Types.html#4636" class="Datatype">Card</a>

<a id="4852" class="Comment">-- T0D0 lenses for Cards?</a>
<a id="_∙cost"></a><a id="4878" href="Types.html#4878" class="Function Operator">_∙cost</a> <a id="4885" class="Symbol">:</a> <a id="4887" href="Types.html#4636" class="Datatype">Card</a> <a id="4892" class="Symbol">→</a> <a id="4894" href="Types.html#1210" class="Function">CardCost</a>
<a id="4903" href="Types.html#4878" class="Function Operator">_∙cost</a> <a id="4910" class="Symbol">=</a> <a id="4912" class="Symbol">λ</a> <a id="4914" class="Keyword">where</a>
  <a id="4922" class="Symbol">(</a><a id="4923" href="Types.html#4656" class="InductiveConstructor">BasicLand</a> <a id="4933" class="Symbol">_)</a>    <a id="4939" class="Symbol">→</a> <a id="4941" href="Prelude.Sets.Concrete.html#2374" class="Function">S.∅</a>
  <a id="4947" class="Symbol">(</a><a id="4948" href="Types.html#4684" class="InductiveConstructor">Creature</a> <a id="4957" href="Types.html#4957" class="Bound">c</a> <a id="4959" class="Symbol">_</a> <a id="4961" class="Symbol">_)</a> <a id="4964" class="Symbol">→</a> <a id="4966" href="Types.html#4957" class="Bound">c</a>

<a id="_∙mana"></a><a id="4969" href="Types.html#4969" class="Function Operator">_∙mana</a> <a id="4976" class="Symbol">:</a> <a id="4978" href="Types.html#4636" class="Datatype">Card</a> <a id="4983" class="Symbol">→</a> <a id="4985" href="Types.html#1152" class="Function">Mana</a>
<a id="4990" href="Types.html#4969" class="Function Operator">_∙mana</a> <a id="4997" class="Symbol">=</a> <a id="4999" class="Symbol">λ</a> <a id="5001" class="Keyword">where</a>
  <a id="5009" class="Symbol">(</a><a id="5010" href="Types.html#4656" class="InductiveConstructor">BasicLand</a> <a id="5020" href="Types.html#5020" class="Bound">c</a><a id="5021" class="Symbol">)</a>    <a id="5026" class="Symbol">→</a> <a id="5028" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="5033" href="Types.html#5020" class="Bound">c</a> <a id="5035" href="Types.html#1507" class="Function Operator">↦</a> <a id="5037" class="Number">1</a>
  <a id="5041" class="Symbol">(</a><a id="5042" href="Types.html#4684" class="InductiveConstructor">Creature</a> <a id="5051" class="Symbol">_</a> <a id="5053" class="Symbol">_</a> <a id="5055" class="Symbol">_)</a> <a id="5058" class="Symbol">→</a> <a id="5060" href="Prelude.Maps.Concrete.html#906" class="Function">∅</a>

<a id="Mountain"></a><a id="5063" href="Types.html#5063" class="Function">Mountain</a> <a id="5072" class="Symbol">=</a> <a id="5074" href="Types.html#4656" class="InductiveConstructor">BasicLand</a> <a id="5084" href="Types.html#814" class="InductiveConstructor">Red</a>
<a id="Forest"></a><a id="5088" href="Types.html#5088" class="Function">Forest</a>   <a id="5097" class="Symbol">=</a> <a id="5099" href="Types.html#4656" class="InductiveConstructor">BasicLand</a> <a id="5109" href="Types.html#818" class="InductiveConstructor">Green</a>
<a id="Plains"></a><a id="5115" href="Types.html#5115" class="Function">Plains</a>   <a id="5124" class="Symbol">=</a> <a id="5126" href="Types.html#4656" class="InductiveConstructor">BasicLand</a> <a id="5136" href="Types.html#824" class="InductiveConstructor">White</a>
<a id="Island"></a><a id="5142" href="Types.html#5142" class="Function">Island</a>   <a id="5151" class="Symbol">=</a> <a id="5153" href="Types.html#4656" class="InductiveConstructor">BasicLand</a> <a id="5163" href="Types.html#830" class="InductiveConstructor">Blue</a>
<a id="Swamp"></a><a id="5168" href="Types.html#5168" class="Function">Swamp</a>    <a id="5177" class="Symbol">=</a> <a id="5179" href="Types.html#4656" class="InductiveConstructor">BasicLand</a> <a id="5189" href="Types.html#835" class="InductiveConstructor">Black</a>

<a id="GlorySeeker"></a><a id="5196" href="Types.html#5196" class="Function">GlorySeeker</a> <a id="5208" class="Symbol">=</a> <a id="5210" href="Types.html#4636" class="Datatype">Card</a> <a id="5215" href="Function.Base.html#4562" class="Function Operator">∋</a> <a id="5217" href="Types.html#4684" class="InductiveConstructor">Creature</a>
  <a id="5228" class="Symbol">(</a><a id="5229" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="5241" class="Symbol">(</a><a id="5242" href="Types.html#1137" class="InductiveConstructor">C</a> <a id="5244" href="Types.html#1507" class="Function Operator">↦</a> <a id="5246" class="Number">1</a> <a id="5248" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="5250" href="Types.html#1060" class="InductiveConstructor">W</a> <a id="5252" href="Types.html#1507" class="Function Operator">↦</a> <a id="5254" class="Number">1</a><a id="5255" class="Symbol">))</a>
  <a id="5260" class="Symbol">(</a><a id="5261" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="5273" href="Prelude.Nary.html#207" class="Function Operator">⟦</a> <a id="5275" href="Types.html#4268" class="InductiveConstructor">Human</a> <a id="5281" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5283" href="Types.html#4274" class="InductiveConstructor">Soldier</a> <a id="5291" href="Prelude.Nary.html#207" class="Function Operator">⟧</a><a id="5292" class="Symbol">)</a>
  <a id="5296" class="Symbol">(</a><a id="5297" class="Number">2</a> <a id="5299" href="Types.html#4463" class="InductiveConstructor Operator">/</a> <a id="5301" class="Number">2</a><a id="5302" class="Symbol">)</a>

<a id="StaunchShieldmate"></a><a id="5305" href="Types.html#5305" class="Function">StaunchShieldmate</a> <a id="5323" class="Symbol">=</a> <a id="5325" href="Types.html#4636" class="Datatype">Card</a> <a id="5330" href="Function.Base.html#4562" class="Function Operator">∋</a> <a id="5332" href="Types.html#4684" class="InductiveConstructor">Creature</a>
  <a id="5343" class="Symbol">(</a><a id="5344" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="5356" class="Symbol">(</a><a id="5357" href="Types.html#1060" class="InductiveConstructor">W</a> <a id="5359" href="Types.html#1507" class="Function Operator">↦</a> <a id="5361" class="Number">1</a><a id="5362" class="Symbol">))</a>
  <a id="5367" class="Symbol">(</a><a id="5368" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="5380" href="Prelude.Nary.html#207" class="Function Operator">⟦</a> <a id="5382" href="Types.html#4282" class="InductiveConstructor">Dwarf</a> <a id="5388" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5390" href="Types.html#4274" class="InductiveConstructor">Soldier</a> <a id="5398" href="Prelude.Nary.html#207" class="Function Operator">⟧</a><a id="5399" class="Symbol">)</a>
  <a id="5403" class="Symbol">(</a><a id="5404" class="Number">1</a> <a id="5406" href="Types.html#4463" class="InductiveConstructor Operator">/</a> <a id="5408" class="Number">3</a><a id="5409" class="Symbol">)</a>

<a id="FalkenrathReaver"></a><a id="5412" href="Types.html#5412" class="Function">FalkenrathReaver</a> <a id="5429" class="Symbol">=</a> <a id="5431" href="Types.html#4636" class="Datatype">Card</a> <a id="5436" href="Function.Base.html#4562" class="Function Operator">∋</a> <a id="5438" href="Types.html#4684" class="InductiveConstructor">Creature</a>
  <a id="5449" class="Symbol">(</a><a id="5450" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="5462" class="Symbol">(</a><a id="5463" href="Types.html#1137" class="InductiveConstructor">C</a> <a id="5465" href="Types.html#1507" class="Function Operator">↦</a> <a id="5467" class="Number">1</a> <a id="5469" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="5471" href="Types.html#1010" class="InductiveConstructor">R</a> <a id="5473" href="Types.html#1507" class="Function Operator">↦</a> <a id="5475" class="Number">1</a><a id="5476" class="Symbol">))</a>
  <a id="5481" class="Symbol">(</a><a id="5482" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="5494" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="5496" href="Types.html#4288" class="InductiveConstructor">Vampire</a> <a id="5504" href="Data.List.Base.html#5025" class="Function Operator">]</a><a id="5505" class="Symbol">)</a>
  <a id="5509" class="Symbol">(</a><a id="5510" class="Number">2</a> <a id="5512" href="Types.html#4463" class="InductiveConstructor Operator">/</a> <a id="5514" class="Number">2</a><a id="5515" class="Symbol">)</a>

<a id="OnakkeOgre"></a><a id="5518" href="Types.html#5518" class="Function">OnakkeOgre</a> <a id="5529" class="Symbol">=</a> <a id="5531" href="Types.html#4636" class="Datatype">Card</a> <a id="5536" href="Function.Base.html#4562" class="Function Operator">∋</a> <a id="5538" href="Types.html#4684" class="InductiveConstructor">Creature</a>
  <a id="5549" class="Symbol">(</a><a id="5550" href="Prelude.Sets.Concrete.html#2396" class="Function">S.singleton</a> <a id="5562" class="Symbol">(</a><a id="5563" href="Types.html#1137" class="InductiveConstructor">C</a> <a id="5565" href="Types.html#1507" class="Function Operator">↦</a> <a id="5567" class="Number">2</a> <a id="5569" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="5571" href="Types.html#1010" class="InductiveConstructor">R</a> <a id="5573" href="Types.html#1507" class="Function Operator">↦</a> <a id="5575" class="Number">1</a><a id="5576" class="Symbol">))</a>
  <a id="5581" class="Symbol">(</a><a id="5582" href="Prelude.Sets.Concrete.html#7883" class="Function">S.fromList⁺</a> <a id="5594" href="Prelude.Nary.html#207" class="Function Operator">⟦</a> <a id="5596" href="Types.html#4296" class="InductiveConstructor">Ogre</a> <a id="5601" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5603" href="Types.html#4301" class="InductiveConstructor">Warrior</a> <a id="5611" href="Prelude.Nary.html#207" class="Function Operator">⟧</a><a id="5612" class="Symbol">)</a>
  <a id="5616" class="Symbol">(</a><a id="5617" class="Number">4</a> <a id="5619" href="Types.html#4463" class="InductiveConstructor Operator">/</a> <a id="5621" class="Number">2</a><a id="5622" class="Symbol">)</a>

<a id="IsLand"></a><a id="5625" href="Types.html#5625" class="Function">IsLand</a> <a id="IsCreature"></a><a id="5632" href="Types.html#5632" class="Function">IsCreature</a> <a id="5643" class="Symbol">:</a> <a id="5645" href="Prelude.Init.html#11891" class="Function">Pred₀</a> <a id="5651" href="Types.html#4636" class="Datatype">Card</a>
<a id="5656" href="Types.html#5625" class="Function">IsLand</a> <a id="5663" class="Symbol">=</a> <a id="5665" class="Symbol">λ</a> <a id="5667" class="Keyword">where</a>
  <a id="5675" class="Symbol">(</a><a id="5676" href="Types.html#4656" class="InductiveConstructor">BasicLand</a> <a id="5686" class="Symbol">_)</a> <a id="5689" class="Symbol">→</a> <a id="5691" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
  <a id="5695" class="CatchallClause Symbol">_</a> <a id="5697" class="Symbol">→</a> <a id="5699" href="Data.Empty.html#526" class="Datatype">⊥</a>
<a id="5701" href="Types.html#5632" class="Function">IsCreature</a> <a id="5712" class="Symbol">=</a> <a id="5714" class="Symbol">λ</a> <a id="5716" class="Keyword">where</a>
  <a id="5724" class="Symbol">(</a><a id="5725" href="Types.html#4684" class="InductiveConstructor">Creature</a> <a id="5734" class="Symbol">_</a> <a id="5736" class="Symbol">_</a> <a id="5738" class="Symbol">_)</a> <a id="5741" class="Symbol">→</a> <a id="5743" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
  <a id="5747" class="CatchallClause Symbol">_</a> <a id="5749" class="Symbol">→</a> <a id="5751" href="Data.Empty.html#526" class="Datatype">⊥</a>

<a id="LandProperties"></a><a id="5754" href="Types.html#5754" class="Function">LandProperties</a> <a id="5769" class="Symbol">=</a> <a id="5771" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>

<a id="5774" class="Keyword">record</a> <a id="CreatureProperties"></a><a id="5781" href="Types.html#5781" class="Record">CreatureProperties</a> <a id="5800" class="Symbol">:</a> <a id="5802" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="5807" class="Keyword">where</a>
  <a id="5815" class="Keyword">field</a> <a id="CreatureProperties.summoningSickness"></a><a id="5821" href="Types.html#5821" class="Field">summoningSickness</a> <a id="5839" class="Symbol">:</a> <a id="5841" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="5846" class="Keyword">open</a> <a id="5851" href="Types.html#5781" class="Module">CreatureProperties</a> <a id="5870" class="Keyword">public</a>

<a id="Properties"></a><a id="5878" href="Types.html#5878" class="Function">Properties</a> <a id="5889" class="Symbol">:</a> <a id="5891" href="Types.html#4636" class="Datatype">Card</a> <a id="5896" class="Symbol">→</a> <a id="5898" href="Agda.Primitive.html#326" class="Primitive">Type</a>
<a id="5903" href="Types.html#5878" class="Function">Properties</a> <a id="5914" class="Symbol">=</a> <a id="5916" class="Symbol">λ</a> <a id="5918" class="Keyword">where</a>
  <a id="5926" class="Symbol">(</a><a id="5927" href="Types.html#4656" class="InductiveConstructor">BasicLand</a> <a id="5937" class="Symbol">_)</a>    <a id="5943" class="Symbol">→</a> <a id="5945" href="Types.html#5754" class="Function">LandProperties</a>
  <a id="5962" class="Symbol">(</a><a id="5963" href="Types.html#4684" class="InductiveConstructor">Creature</a> <a id="5972" class="Symbol">_</a> <a id="5974" class="Symbol">_</a> <a id="5976" class="Symbol">_)</a> <a id="5979" class="Symbol">→</a> <a id="5981" href="Types.html#5781" class="Record">CreatureProperties</a>

<a id="6001" class="Keyword">record</a> <a id="CardInstance"></a><a id="6008" href="Types.html#6008" class="Record">CardInstance</a> <a id="6021" class="Symbol">:</a> <a id="6023" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="6028" class="Keyword">where</a>
  <a id="6036" class="Keyword">field</a>
    <a id="CardInstance.card"></a><a id="6046" href="Types.html#6046" class="Field">card</a> <a id="6051" class="Symbol">:</a> <a id="6053" href="Types.html#4636" class="Datatype">Card</a>
    <a id="CardInstance.tapped"></a><a id="6062" href="Types.html#6062" class="Field">tapped</a> <a id="6069" class="Symbol">:</a> <a id="6071" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
    <a id="CardInstance.properties"></a><a id="6080" href="Types.html#6080" class="Field">properties</a> <a id="6091" class="Symbol">:</a> <a id="6093" href="Types.html#5878" class="Function">Properties</a> <a id="6104" href="Types.html#6046" class="Field">card</a>
  <a id="CardInstance._∙card"></a><a id="6111" href="Types.html#6111" class="Function Operator">_∙card</a> <a id="6118" class="Symbol">=</a> <a id="6120" href="Types.html#6046" class="Field">card</a>
<a id="6125" class="Keyword">open</a> <a id="6130" href="Types.html#6008" class="Module">CardInstance</a> <a id="6143" class="Keyword">public</a>
<a id="6150" class="Comment">-- unquoteDecl DecEq-CardInstance = DERIVE DecEq [ quote CardInstance , DecEq-CardInstance ]</a>
<a id="6243" class="Keyword">private</a> <a id="6251" class="Keyword">variable</a> <a id="6260" href="Types.html#6260" class="Generalizable">ci</a> <a id="6263" href="Types.html#6263" class="Generalizable">ci′</a> <a id="6267" class="Symbol">:</a> <a id="6269" href="Types.html#6008" class="Record">CardInstance</a>

<a id="_∙tap"></a><a id="6283" href="Types.html#6283" class="Function Operator">_∙tap</a> <a id="_∙untap"></a><a id="6289" href="Types.html#6289" class="Function Operator">_∙untap</a> <a id="6297" class="Symbol">:</a> <a id="6299" href="Algebra.Core.html#475" class="Function">Op₁</a> <a id="6303" href="Types.html#6008" class="Record">CardInstance</a>
<a id="6316" href="Types.html#6316" class="Bound">ci</a> <a id="6319" href="Types.html#6283" class="Function Operator">∙tap</a> <a id="6324" class="Symbol">=</a> <a id="6326" class="Keyword">record</a> <a id="6333" href="Types.html#6316" class="Bound">ci</a> <a id="6336" class="Symbol">{</a><a id="6337" href="Types.html#6062" class="Field">tapped</a> <a id="6344" class="Symbol">=</a> <a id="6346" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a><a id="6350" class="Symbol">}</a>
<a id="6352" href="Types.html#6352" class="Bound">ci</a> <a id="6355" href="Types.html#6289" class="Function Operator">∙untap</a> <a id="6362" class="Symbol">=</a> <a id="6364" class="Keyword">record</a> <a id="6371" href="Types.html#6352" class="Bound">ci</a> <a id="6374" class="Symbol">{</a><a id="6375" href="Types.html#6062" class="Field">tapped</a> <a id="6382" class="Symbol">=</a> <a id="6384" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a><a id="6389" class="Symbol">}</a>

<a id="IsTapped"></a><a id="6392" href="Types.html#6392" class="Function">IsTapped</a> <a id="IsUntapped"></a><a id="6401" href="Types.html#6401" class="Function">IsUntapped</a> <a id="6412" class="Symbol">:</a> <a id="6414" href="Prelude.Init.html#11891" class="Function">Pred₀</a> <a id="6420" href="Types.html#6008" class="Record">CardInstance</a>
<a id="6433" href="Types.html#6392" class="Function">IsTapped</a> <a id="6442" class="Symbol">=</a> <a id="6444" href="Data.Bool.Base.html#1451" class="Function">T</a> <a id="6446" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="6448" href="Types.html#6062" class="Field">tapped</a>
<a id="6455" href="Types.html#6401" class="Function">IsUntapped</a> <a id="6466" class="Symbol">=</a> <a id="6468" href="Relation.Nullary.html#656" class="Function Operator">¬_</a> <a id="6471" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="6473" href="Types.html#6392" class="Function">IsTapped</a>

<a id="6483" class="Keyword">private</a>
  <a id="unsummon"></a><a id="6493" href="Types.html#6493" class="Function">unsummon</a> <a id="6502" class="Symbol">:</a> <a id="6504" href="Algebra.Core.html#475" class="Function">Op₁</a> <a id="6508" href="Types.html#5781" class="Record">CreatureProperties</a>
  <a id="6529" href="Types.html#6493" class="Function">unsummon</a> <a id="6538" href="Types.html#6538" class="Bound">ps</a> <a id="6541" class="Symbol">=</a> <a id="6543" class="Keyword">record</a> <a id="6550" href="Types.html#6538" class="Bound">ps</a> <a id="6553" class="Symbol">{</a><a id="6554" href="Types.html#5821" class="Field">summoningSickness</a> <a id="6572" class="Symbol">=</a> <a id="6574" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a><a id="6579" class="Symbol">}</a>

  <a id="liftProp"></a><a id="6584" href="Types.html#6584" class="Function">liftProp</a> <a id="6593" class="Symbol">:</a> <a id="6595" href="Algebra.Core.html#475" class="Function">Op₁</a> <a id="6599" href="Types.html#5781" class="Record">CreatureProperties</a> <a id="6618" class="Symbol">→</a> <a id="6620" href="Algebra.Core.html#475" class="Function">Op₁</a> <a id="6624" class="Symbol">(</a><a id="6625" href="Types.html#5878" class="Function">Properties</a> <a id="6636" href="Types.html#4836" class="Generalizable">c</a><a id="6637" class="Symbol">)</a>
  <a id="6641" href="Types.html#6584" class="Function">liftProp</a> <a id="6650" class="Symbol">{</a><a id="6651" class="Argument">c</a> <a id="6653" class="Symbol">=</a> <a id="6655" href="Types.html#6655" class="Bound">c</a><a id="6656" class="Symbol">}</a> <a id="6658" href="Types.html#6658" class="Bound">go</a> <a id="6661" href="Types.html#6661" class="Bound">ps</a> <a id="6664" class="Keyword">with</a> <a id="6669" href="Types.html#6655" class="Bound">c</a>
  <a id="6673" class="Symbol">...</a> <a id="6677" class="Symbol">|</a> <a id="6679" href="Types.html#4656" class="InductiveConstructor">BasicLand</a> <a id="6689" class="Symbol">_</a>    <a id="6694" class="Symbol">=</a> <a id="6696" class="Bound">ps</a>
  <a id="6701" class="Symbol">...</a> <a id="6705" class="Symbol">|</a> <a id="6707" href="Types.html#4684" class="InductiveConstructor">Creature</a> <a id="6716" class="Symbol">_</a> <a id="6718" class="Symbol">_</a> <a id="6720" class="Symbol">_</a> <a id="6722" class="Symbol">=</a> <a id="6724" class="Bound">go</a> <a id="6727" class="Bound">ps</a>

  <a id="liftProp′"></a><a id="6733" href="Types.html#6733" class="Function">liftProp′</a> <a id="6743" class="Symbol">:</a> <a id="6745" href="Algebra.Core.html#475" class="Function">Op₁</a> <a id="6749" href="Types.html#6008" class="Record">CardInstance</a>
  <a id="6764" href="Types.html#6733" class="Function">liftProp′</a> <a id="6774" href="Types.html#6774" class="Bound">ci</a><a id="6776" class="Symbol">@(</a><a id="6778" class="Keyword">record</a> <a id="6785" class="Symbol">{</a><a id="6786" href="Types.html#6046" class="Field">card</a> <a id="6791" class="Symbol">=</a> <a id="6793" href="Types.html#6793" class="Bound">c</a><a id="6794" class="Symbol">;</a> <a id="6796" href="Types.html#6062" class="Field">tapped</a> <a id="6803" class="Symbol">=</a> <a id="6805" href="Types.html#6805" class="Bound">tp</a><a id="6807" class="Symbol">;</a> <a id="6809" href="Types.html#6080" class="Field">properties</a> <a id="6820" class="Symbol">=</a> <a id="6822" href="Types.html#6822" class="Bound">ps</a><a id="6824" class="Symbol">})</a>
    <a id="6831" class="Symbol">=</a> <a id="6833" class="Keyword">record</a> <a id="6840" class="Symbol">{</a><a id="6841" href="Types.html#6046" class="Field">card</a> <a id="6846" class="Symbol">=</a> <a id="6848" href="Types.html#6793" class="Bound">c</a><a id="6849" class="Symbol">;</a> <a id="6851" href="Types.html#6062" class="Field">tapped</a> <a id="6858" class="Symbol">=</a> <a id="6860" href="Types.html#6805" class="Bound">tp</a><a id="6862" class="Symbol">;</a> <a id="6864" href="Types.html#6080" class="Field">properties</a> <a id="6875" class="Symbol">=</a> <a id="6877" href="Types.html#6584" class="Function">liftProp</a> <a id="6886" href="Types.html#6493" class="Function">unsummon</a> <a id="6895" href="Types.html#6822" class="Bound">ps</a><a id="6897" class="Symbol">}</a>

<a id="Cards"></a><a id="6900" href="Types.html#6900" class="Function">Cards</a> <a id="6906" class="Symbol">=</a> <a id="6908" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="6913" href="Types.html#4636" class="Datatype">Card</a>
<a id="Deck"></a><a id="6918" href="Types.html#6918" class="Function">Deck</a> <a id="6923" class="Symbol">=</a> <a id="6925" href="Types.html#6900" class="Function">Cards</a>
<a id="Library"></a><a id="6931" href="Types.html#6931" class="Function">Library</a> <a id="6939" class="Symbol">=</a> <a id="6941" href="Types.html#6900" class="Function">Cards</a>
<a id="Hand"></a><a id="6947" href="Types.html#6947" class="Function">Hand</a> <a id="6952" class="Symbol">=</a> <a id="6954" href="Types.html#6900" class="Function">Cards</a>

<a id="6961" class="Keyword">private</a> <a id="6969" class="Keyword">variable</a>
  <a id="6980" href="Types.html#6980" class="Generalizable">cs</a> <a id="6983" href="Types.html#6983" class="Generalizable">cs′</a> <a id="6987" href="Types.html#6987" class="Generalizable">cs″</a> <a id="6991" class="Symbol">:</a> <a id="6993" href="Types.html#6900" class="Function">Cards</a>
  <a id="7001" href="Types.html#7001" class="Generalizable">d</a> <a id="7003" href="Types.html#7003" class="Generalizable">d′</a> <a id="7006" href="Types.html#7006" class="Generalizable">d″</a> <a id="7009" class="Symbol">:</a> <a id="7011" href="Types.html#6918" class="Function">Deck</a>
  <a id="7018" href="Types.html#7018" class="Generalizable">lib</a> <a id="7022" href="Types.html#7022" class="Generalizable">lib′</a> <a id="7027" href="Types.html#7027" class="Generalizable">lib″</a> <a id="7032" class="Symbol">:</a> <a id="7034" href="Types.html#6931" class="Function">Library</a>
  <a id="7044" href="Types.html#7044" class="Generalizable">h</a> <a id="7046" href="Types.html#7046" class="Generalizable">h′</a> <a id="7049" href="Types.html#7049" class="Generalizable">h″</a> <a id="7052" class="Symbol">:</a> <a id="7054" href="Types.html#6947" class="Function">Hand</a>

<a id="7060" class="Keyword">record</a> <a id="Player"></a><a id="7067" href="Types.html#7067" class="Record">Player</a> <a id="7074" class="Symbol">:</a> <a id="7076" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="7081" class="Keyword">where</a>
  <a id="7089" class="Keyword">constructor</a> <a id="mkPlayer"></a><a id="7101" href="Types.html#7101" class="InductiveConstructor">mkPlayer</a>
  <a id="7112" class="Keyword">field</a>
    <a id="Player.name"></a><a id="7122" href="Types.html#7122" class="Field">name</a> <a id="7127" class="Symbol">:</a> <a id="7129" href="Agda.Builtin.String.html#336" class="Postulate">String</a>
    <a id="Player.library"></a><a id="7140" href="Types.html#7140" class="Field">library</a> <a id="7148" class="Symbol">:</a> <a id="7150" href="Types.html#6900" class="Function">Cards</a>
    <a id="Player.hand"></a><a id="7160" href="Types.html#7160" class="Field">hand</a> <a id="7165" class="Symbol">:</a> <a id="7167" href="Types.html#6947" class="Function">Hand</a>
    <a id="Player.graveyard"></a><a id="7176" href="Types.html#7176" class="Field">graveyard</a> <a id="7186" class="Symbol">:</a> <a id="7188" href="Types.html#6900" class="Function">Cards</a>
    <a id="Player.exile"></a><a id="7198" href="Types.html#7198" class="Field">exile</a> <a id="7204" class="Symbol">:</a> <a id="7206" href="Types.html#6900" class="Function">Cards</a>
    <a id="Player.life"></a><a id="7216" href="Types.html#7216" class="Field">life</a> <a id="7221" class="Symbol">:</a> <a id="7223" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="Player.control"></a><a id="7229" href="Types.html#7229" class="Field">control</a> <a id="7237" class="Symbol">:</a> <a id="7239" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="7244" href="Types.html#6008" class="Record">CardInstance</a>
    <a id="Player.manaPool"></a><a id="7261" href="Types.html#7261" class="Field">manaPool</a> <a id="7270" class="Symbol">:</a> <a id="7272" href="Types.html#1178" class="Function">ManaPool</a>
<a id="7281" class="Keyword">open</a> <a id="7286" href="Types.html#7067" class="Module">Player</a> <a id="7293" class="Keyword">public</a>
<a id="7300" class="Keyword">unquoteDecl</a> <a id="$name"></a><a id="7312" href="Types.html#7312" class="Function">$name</a> <a id="_∙name"></a><a id="7318" href="Types.html#7318" class="Function Operator">_∙name</a> <a id="_∙name=_"></a><a id="7325" href="Types.html#7325" class="Function Operator">_∙name=_</a> <a id="_∙name↝_"></a><a id="7334" href="Types.html#7334" class="Function Operator">_∙name↝_</a>
            <a id="$library"></a><a id="7355" href="Types.html#7355" class="Function">$library</a> <a id="_∙library"></a><a id="7364" href="Types.html#7364" class="Function Operator">_∙library</a> <a id="_∙library=_"></a><a id="7374" href="Types.html#7374" class="Function Operator">_∙library=_</a> <a id="_∙library↝_"></a><a id="7386" href="Types.html#7386" class="Function Operator">_∙library↝_</a>
            <a id="$hand"></a><a id="7410" href="Types.html#7410" class="Function">$hand</a> <a id="_∙hand"></a><a id="7416" href="Types.html#7416" class="Function Operator">_∙hand</a> <a id="_∙hand=_"></a><a id="7423" href="Types.html#7423" class="Function Operator">_∙hand=_</a> <a id="_∙hand↝_"></a><a id="7432" href="Types.html#7432" class="Function Operator">_∙hand↝_</a>
            <a id="$graveyard"></a><a id="7453" href="Types.html#7453" class="Function">$graveyard</a> <a id="_∙graveyard"></a><a id="7464" href="Types.html#7464" class="Function Operator">_∙graveyard</a> <a id="_∙graveyard=_"></a><a id="7476" href="Types.html#7476" class="Function Operator">_∙graveyard=_</a> <a id="_∙graveyard↝_"></a><a id="7490" href="Types.html#7490" class="Function Operator">_∙graveyard↝_</a>
            <a id="$exile"></a><a id="7516" href="Types.html#7516" class="Function">$exile</a> <a id="_∙exile"></a><a id="7523" href="Types.html#7523" class="Function Operator">_∙exile</a> <a id="_∙exile=_"></a><a id="7531" href="Types.html#7531" class="Function Operator">_∙exile=_</a> <a id="_∙exile↝_"></a><a id="7541" href="Types.html#7541" class="Function Operator">_∙exile↝_</a>
            <a id="$life"></a><a id="7563" href="Types.html#7563" class="Function">$life</a> <a id="_∙life"></a><a id="7569" href="Types.html#7569" class="Function Operator">_∙life</a> <a id="_∙life=_"></a><a id="7576" href="Types.html#7576" class="Function Operator">_∙life=_</a> <a id="_∙life↝_"></a><a id="7585" href="Types.html#7585" class="Function Operator">_∙life↝_</a>
            <a id="$control"></a><a id="7606" href="Types.html#7606" class="Function">$control</a> <a id="_∙control"></a><a id="7615" href="Types.html#7615" class="Function Operator">_∙control</a> <a id="_∙control=_"></a><a id="7625" href="Types.html#7625" class="Function Operator">_∙control=_</a> <a id="_∙control↝_"></a><a id="7637" href="Types.html#7637" class="Function Operator">_∙control↝_</a>
            <a id="$manaPool"></a><a id="7661" href="Types.html#7661" class="Function">$manaPool</a> <a id="_∙manaPool"></a><a id="7671" href="Types.html#7671" class="Function Operator">_∙manaPool</a> <a id="_∙manaPool=_"></a><a id="7682" href="Types.html#7682" class="Function Operator">_∙manaPool=_</a> <a id="_∙manaPool↝_"></a><a id="7695" href="Types.html#7695" class="Function Operator">_∙manaPool↝_</a>
  <a id="7710" class="Symbol">=</a> <a id="7712" href="Prelude.Lenses.Derive.html#270" class="Function">deriveLenses</a> <a id="7725" class="Symbol">(</a><a id="7726" class="Keyword">quote</a> <a id="7732" href="Types.html#7067" class="Record">Player</a><a id="7738" class="Symbol">)</a>
  <a id="7742" class="Symbol">(</a> <a id="7744" class="Symbol">(</a><a id="7745" href="Types.html#7312" class="Function">$name</a> <a id="7751" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7753" href="Types.html#7318" class="Function Operator">_∙name</a> <a id="7760" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7762" href="Types.html#7325" class="Function Operator">_∙name=_</a> <a id="7771" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7773" href="Types.html#7334" class="Function Operator">_∙name↝_</a><a id="7781" class="Symbol">)</a>
  <a id="7785" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7787" class="Symbol">(</a><a id="7788" href="Types.html#7355" class="Function">$library</a> <a id="7797" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7799" href="Types.html#7364" class="Function Operator">_∙library</a> <a id="7809" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7811" href="Types.html#7374" class="Function Operator">_∙library=_</a> <a id="7823" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7825" href="Types.html#7386" class="Function Operator">_∙library↝_</a><a id="7836" class="Symbol">)</a>
  <a id="7840" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7842" class="Symbol">(</a><a id="7843" href="Types.html#7410" class="Function">$hand</a> <a id="7849" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7851" href="Types.html#7416" class="Function Operator">_∙hand</a> <a id="7858" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7860" href="Types.html#7423" class="Function Operator">_∙hand=_</a> <a id="7869" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7871" href="Types.html#7432" class="Function Operator">_∙hand↝_</a><a id="7879" class="Symbol">)</a>
  <a id="7883" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7885" class="Symbol">(</a><a id="7886" href="Types.html#7453" class="Function">$graveyard</a> <a id="7897" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7899" href="Types.html#7464" class="Function Operator">_∙graveyard</a> <a id="7911" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7913" href="Types.html#7476" class="Function Operator">_∙graveyard=_</a> <a id="7927" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7929" href="Types.html#7490" class="Function Operator">_∙graveyard↝_</a><a id="7942" class="Symbol">)</a>
  <a id="7946" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7948" class="Symbol">(</a><a id="7949" href="Types.html#7516" class="Function">$exile</a> <a id="7956" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7958" href="Types.html#7523" class="Function Operator">_∙exile</a> <a id="7966" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7968" href="Types.html#7531" class="Function Operator">_∙exile=_</a> <a id="7978" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7980" href="Types.html#7541" class="Function Operator">_∙exile↝_</a><a id="7989" class="Symbol">)</a>
  <a id="7993" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7995" class="Symbol">(</a><a id="7996" href="Types.html#7563" class="Function">$life</a> <a id="8002" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8004" href="Types.html#7569" class="Function Operator">_∙life</a> <a id="8011" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8013" href="Types.html#7576" class="Function Operator">_∙life=_</a> <a id="8022" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8024" href="Types.html#7585" class="Function Operator">_∙life↝_</a><a id="8032" class="Symbol">)</a>
  <a id="8036" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8038" class="Symbol">(</a><a id="8039" href="Types.html#7606" class="Function">$control</a> <a id="8048" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8050" href="Types.html#7615" class="Function Operator">_∙control</a> <a id="8060" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8062" href="Types.html#7625" class="Function Operator">_∙control=_</a> <a id="8074" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8076" href="Types.html#7637" class="Function Operator">_∙control↝_</a><a id="8087" class="Symbol">)</a>
  <a id="8091" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8093" class="Symbol">(</a><a id="8094" href="Types.html#7661" class="Function">$manaPool</a> <a id="8104" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8106" href="Types.html#7671" class="Function Operator">_∙manaPool</a> <a id="8117" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8119" href="Types.html#7682" class="Function Operator">_∙manaPool=_</a> <a id="8132" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8134" href="Types.html#7695" class="Function Operator">_∙manaPool↝_</a><a id="8146" class="Symbol">)</a>
  <a id="8150" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8152" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="8154" class="Symbol">)</a>
<a id="8156" class="Keyword">infixl</a> <a id="8163" class="Number">10</a>
  <a id="8168" href="Types.html#7325" class="Function Operator">_∙name=_</a> <a id="8177" href="Types.html#7334" class="Function Operator">_∙name↝_</a>
  <a id="8188" href="Types.html#7374" class="Function Operator">_∙library=_</a> <a id="8200" href="Types.html#7386" class="Function Operator">_∙library↝_</a>
  <a id="8214" href="Types.html#7423" class="Function Operator">_∙hand=_</a> <a id="8223" href="Types.html#7432" class="Function Operator">_∙hand↝_</a>
  <a id="8234" href="Types.html#7476" class="Function Operator">_∙graveyard=_</a> <a id="8248" href="Types.html#7490" class="Function Operator">_∙graveyard↝_</a>
  <a id="8264" href="Types.html#7531" class="Function Operator">_∙exile=_</a> <a id="8274" href="Types.html#7541" class="Function Operator">_∙exile↝_</a>
  <a id="8286" href="Types.html#7576" class="Function Operator">_∙life=_</a> <a id="8295" href="Types.html#7585" class="Function Operator">_∙life↝_</a>
  <a id="8306" href="Types.html#7625" class="Function Operator">_∙control=_</a> <a id="8318" href="Types.html#7637" class="Function Operator">_∙control↝_</a>
  <a id="8332" href="Types.html#7682" class="Function Operator">_∙manaPool=_</a> <a id="8345" href="Types.html#7695" class="Function Operator">_∙manaPool↝_</a>

<a id="8359" class="Keyword">data</a> <a id="Turn"></a><a id="8364" href="Types.html#8364" class="Datatype">Turn</a> <a id="8369" class="Symbol">:</a> <a id="8371" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="8376" class="Keyword">where</a>
  <a id="Turn.on-the-play"></a><a id="8384" href="Types.html#8384" class="InductiveConstructor">on-the-play</a> <a id="Turn.on-the-draw"></a><a id="8396" href="Types.html#8396" class="InductiveConstructor">on-the-draw</a> <a id="8408" class="Symbol">:</a> <a id="8410" href="Types.html#8364" class="Datatype">Turn</a>

<a id="8416" class="Keyword">data</a> <a id="Phase"></a><a id="8421" href="Types.html#8421" class="Datatype">Phase</a> <a id="8427" class="Symbol">:</a> <a id="8429" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="8434" class="Keyword">where</a>
  <a id="Phase.draw"></a><a id="8442" href="Types.html#8442" class="InductiveConstructor">draw</a> <a id="Phase.main"></a><a id="8447" href="Types.html#8447" class="InductiveConstructor">main</a> <a id="Phase.attack"></a><a id="8452" href="Types.html#8452" class="InductiveConstructor">attack</a> <a id="Phase.end"></a><a id="8459" href="Types.html#8459" class="InductiveConstructor">end</a> <a id="8463" class="Symbol">:</a> <a id="8465" href="Types.html#8421" class="Datatype">Phase</a>

<a id="8472" class="Keyword">data</a> <a id="Outcome"></a><a id="8477" href="Types.html#8477" class="Datatype">Outcome</a> <a id="8485" class="Symbol">:</a> <a id="8487" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="8492" class="Keyword">where</a>
  <a id="Outcome.DRAW"></a><a id="8500" href="Types.html#8500" class="InductiveConstructor">DRAW</a> <a id="Outcome.𝟙-WINS"></a><a id="8505" href="Types.html#8505" class="InductiveConstructor">𝟙-WINS</a> <a id="Outcome.𝟚-WINS"></a><a id="8512" href="Types.html#8512" class="InductiveConstructor">𝟚-WINS</a> <a id="8519" class="Symbol">:</a> <a id="8521" href="Types.html#8477" class="Datatype">Outcome</a>

<a id="8530" class="Keyword">record</a> <a id="GameState"></a><a id="8537" href="Types.html#8537" class="Record">GameState</a> <a id="8547" class="Symbol">:</a> <a id="8549" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="8554" class="Keyword">where</a>
  <a id="8562" class="Keyword">field</a>
    <a id="GameState.player₁"></a><a id="8572" href="Types.html#8572" class="Field">player₁</a>  <a id="8581" class="Symbol">:</a> <a id="8583" href="Types.html#7067" class="Record">Player</a>
    <a id="GameState.player₂"></a><a id="8594" href="Types.html#8594" class="Field">player₂</a>  <a id="8603" class="Symbol">:</a> <a id="8605" href="Types.html#7067" class="Record">Player</a>

    <a id="GameState.curTurn"></a><a id="8617" href="Types.html#8617" class="Field">curTurn</a> <a id="8625" class="Symbol">:</a> <a id="8627" href="Types.html#8364" class="Datatype">Turn</a>
    <a id="GameState.nextTurn"></a><a id="8636" href="Types.html#8636" class="Field">nextTurn</a> <a id="8645" class="Symbol">:</a> <a id="8647" href="Algebra.Core.html#475" class="Function">Op₁</a> <a id="8651" href="Types.html#8364" class="Datatype">Turn</a>

    <a id="GameState.curPhase"></a><a id="8661" href="Types.html#8661" class="Field">curPhase</a> <a id="8670" class="Symbol">:</a> <a id="8672" href="Types.html#8421" class="Datatype">Phase</a>
    <a id="GameState.nextPhase"></a><a id="8682" href="Types.html#8682" class="Field">nextPhase</a> <a id="8692" class="Symbol">:</a> <a id="8694" href="Algebra.Core.html#475" class="Function">Op₁</a> <a id="8698" href="Types.html#8421" class="Datatype">Phase</a>

    <a id="GameState.hasPlayedLand"></a><a id="8709" href="Types.html#8709" class="Field">hasPlayedLand</a> <a id="8723" class="Symbol">:</a> <a id="8725" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
    <a id="GameState.outcome"></a><a id="8734" href="Types.html#8734" class="Field">outcome</a> <a id="8742" class="Symbol">:</a> <a id="8744" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="8750" href="Types.html#8477" class="Datatype">Outcome</a>
    <a id="GameState.attackers"></a><a id="8762" href="Types.html#8762" class="Field">attackers</a> <a id="8772" class="Symbol">:</a> <a id="8774" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="8780" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="8782" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="8787" href="Types.html#6008" class="Record">CardInstance</a>
    <a id="GameState.blockers"></a><a id="8804" href="Types.html#8804" class="Field">blockers</a>  <a id="8814" class="Symbol">:</a> <a id="8816" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="8822" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="8824" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="8829" href="Types.html#6008" class="Record">CardInstance</a>

  <a id="8845" class="Comment">-- private</a>
  <a id="8858" class="Comment">--   curPlayer = case curTurn of λ where</a>
  <a id="8901" class="Comment">--     on-the-play → player₁</a>
  <a id="8932" class="Comment">--     on-the-draw → player₂</a>
  <a id="8963" class="Comment">--   otherPlayer = case curTurn of λ where</a>
  <a id="9008" class="Comment">--     on-the-play → player₂</a>
  <a id="9039" class="Comment">--     on-the-draw → player₁</a>

  <a id="9071" class="Comment">-- field</a>
  <a id="9082" class="Comment">--   attackers : Maybe $ ∃ (_⊑ (curPlayer ∙control))</a>
  <a id="9137" class="Comment">--   blockers  : Maybe $ ∃ (  (_⊑ (otherPlayer ∙control))</a>
  <a id="9197" class="Comment">--                         ∩¹ (_⊆ (curPlayer ∙control)))</a>

    <a id="9259" class="Comment">-- attackers : Maybe $ ∃ (_⊑ (player₁ ∙control))</a>
    <a id="9312" class="Comment">-- blockers  : Maybe $ ∃ (_⊑ (player₂ ∙control))</a>

<a id="9362" class="Keyword">open</a> <a id="9367" href="Types.html#8537" class="Module">GameState</a> <a id="9377" class="Keyword">public</a>
<a id="9384" class="Keyword">private</a> <a id="9392" class="Keyword">variable</a> <a id="9401" href="Types.html#9401" class="Generalizable">s</a> <a id="9403" href="Types.html#9403" class="Generalizable">s′</a> <a id="9406" href="Types.html#9406" class="Generalizable">s″</a> <a id="9409" class="Symbol">:</a> <a id="9411" href="Types.html#8537" class="Record">GameState</a>

<a id="9422" class="Keyword">unquoteDecl</a> <a id="𝕃"></a><a id="9434" href="Types.html#9434" class="Function">𝕃</a> <a id="_∙l"></a><a id="9436" href="Types.html#9436" class="Function Operator">_∙l</a> <a id="_∙l=_"></a><a id="9440" href="Types.html#9440" class="Function Operator">_∙l=_</a> <a id="_∙l↝_"></a><a id="9446" href="Types.html#9446" class="Function Operator">_∙l↝_</a>
            <a id="ℝ"></a><a id="9464" href="Types.html#9464" class="Function">ℝ</a> <a id="_∙r"></a><a id="9466" href="Types.html#9466" class="Function Operator">_∙r</a> <a id="_∙r=_"></a><a id="9470" href="Types.html#9470" class="Function Operator">_∙r=_</a> <a id="_∙r↝_"></a><a id="9476" href="Types.html#9476" class="Function Operator">_∙r↝_</a>
            <a id="$curTurn"></a><a id="9494" href="Types.html#9494" class="Function">$curTurn</a> <a id="_∙curTurn"></a><a id="9503" href="Types.html#9503" class="Function Operator">_∙curTurn</a> <a id="_∙curTurn=_"></a><a id="9513" href="Types.html#9513" class="Function Operator">_∙curTurn=_</a> <a id="_∙curTurn↝_"></a><a id="9525" href="Types.html#9525" class="Function Operator">_∙curTurn↝_</a>
            <a id="$nextTurn"></a><a id="9549" href="Types.html#9549" class="Function">$nextTurn</a> <a id="_∙nextTurn"></a><a id="9559" href="Types.html#9559" class="Function Operator">_∙nextTurn</a> <a id="_∙nextTurn=_"></a><a id="9570" href="Types.html#9570" class="Function Operator">_∙nextTurn=_</a> <a id="_∙nextTurn↝_"></a><a id="9583" href="Types.html#9583" class="Function Operator">_∙nextTurn↝_</a>
            <a id="$curPhase"></a><a id="9608" href="Types.html#9608" class="Function">$curPhase</a> <a id="_∙curPhase"></a><a id="9618" href="Types.html#9618" class="Function Operator">_∙curPhase</a> <a id="_∙curPhase=_"></a><a id="9629" href="Types.html#9629" class="Function Operator">_∙curPhase=_</a> <a id="_∙curPhase↝_"></a><a id="9642" href="Types.html#9642" class="Function Operator">_∙curPhase↝_</a>
            <a id="$nextPhase"></a><a id="9667" href="Types.html#9667" class="Function">$nextPhase</a> <a id="_∙nextPhase"></a><a id="9678" href="Types.html#9678" class="Function Operator">_∙nextPhase</a> <a id="_∙nextPhase=_"></a><a id="9690" href="Types.html#9690" class="Function Operator">_∙nextPhase=_</a> <a id="_∙nextPhase↝_"></a><a id="9704" href="Types.html#9704" class="Function Operator">_∙nextPhase↝_</a>
            <a id="$hasPlayedLand"></a><a id="9730" href="Types.html#9730" class="Function">$hasPlayedLand</a> <a id="_∙hasPlayedLand"></a><a id="9745" href="Types.html#9745" class="Function Operator">_∙hasPlayedLand</a> <a id="_∙hasPlayedLand=_"></a><a id="9761" href="Types.html#9761" class="Function Operator">_∙hasPlayedLand=_</a> <a id="_∙hasPlayedLand↝_"></a><a id="9779" href="Types.html#9779" class="Function Operator">_∙hasPlayedLand↝_</a>
            <a id="$outcome"></a><a id="9809" href="Types.html#9809" class="Function">$outcome</a> <a id="_∙outcome"></a><a id="9818" href="Types.html#9818" class="Function Operator">_∙outcome</a> <a id="_∙outcome=_"></a><a id="9828" href="Types.html#9828" class="Function Operator">_∙outcome=_</a> <a id="_∙outcome↝_"></a><a id="9840" href="Types.html#9840" class="Function Operator">_∙outcome↝_</a>
            <a id="$attackers"></a><a id="9864" href="Types.html#9864" class="Function">$attackers</a> <a id="_∙attackers"></a><a id="9875" href="Types.html#9875" class="Function Operator">_∙attackers</a> <a id="_∙attackers=_"></a><a id="9887" href="Types.html#9887" class="Function Operator">_∙attackers=_</a> <a id="_∙attackers↝_"></a><a id="9901" href="Types.html#9901" class="Function Operator">_∙attackers↝_</a>
            <a id="$blockers"></a><a id="9927" href="Types.html#9927" class="Function">$blockers</a> <a id="_∙blockers"></a><a id="9937" href="Types.html#9937" class="Function Operator">_∙blockers</a> <a id="_∙blockers=_"></a><a id="9948" href="Types.html#9948" class="Function Operator">_∙blockers=_</a> <a id="_∙blockers↝_"></a><a id="9961" href="Types.html#9961" class="Function Operator">_∙blockers↝_</a>
  <a id="9976" class="Symbol">=</a> <a id="9978" href="Prelude.Lenses.Derive.html#270" class="Function">deriveLenses</a> <a id="9991" class="Symbol">(</a><a id="9992" class="Keyword">quote</a> <a id="9998" href="Types.html#8537" class="Record">GameState</a><a id="10007" class="Symbol">)</a>
    <a id="10013" class="Symbol">(</a> <a id="10015" class="Symbol">(</a><a id="10016" href="Types.html#9434" class="Function">𝕃</a> <a id="10018" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10020" href="Types.html#9436" class="Function Operator">_∙l</a> <a id="10024" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10026" href="Types.html#9440" class="Function Operator">_∙l=_</a> <a id="10032" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10034" href="Types.html#9446" class="Function Operator">_∙l↝_</a><a id="10039" class="Symbol">)</a>
    <a id="10045" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="10047" class="Symbol">(</a><a id="10048" href="Types.html#9464" class="Function">ℝ</a> <a id="10050" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10052" href="Types.html#9466" class="Function Operator">_∙r</a> <a id="10056" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10058" href="Types.html#9470" class="Function Operator">_∙r=_</a> <a id="10064" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10066" href="Types.html#9476" class="Function Operator">_∙r↝_</a><a id="10071" class="Symbol">)</a>
    <a id="10077" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="10079" class="Symbol">(</a><a id="10080" href="Types.html#9494" class="Function">$curTurn</a> <a id="10089" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10091" href="Types.html#9503" class="Function Operator">_∙curTurn</a> <a id="10101" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10103" href="Types.html#9513" class="Function Operator">_∙curTurn=_</a> <a id="10115" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10117" href="Types.html#9525" class="Function Operator">_∙curTurn↝_</a><a id="10128" class="Symbol">)</a>
    <a id="10134" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="10136" class="Symbol">(</a><a id="10137" href="Types.html#9549" class="Function">$nextTurn</a> <a id="10147" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10149" href="Types.html#9559" class="Function Operator">_∙nextTurn</a> <a id="10160" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10162" href="Types.html#9570" class="Function Operator">_∙nextTurn=_</a> <a id="10175" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10177" href="Types.html#9583" class="Function Operator">_∙nextTurn↝_</a><a id="10189" class="Symbol">)</a>
    <a id="10195" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="10197" class="Symbol">(</a><a id="10198" href="Types.html#9608" class="Function">$curPhase</a> <a id="10208" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10210" href="Types.html#9618" class="Function Operator">_∙curPhase</a> <a id="10221" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10223" href="Types.html#9629" class="Function Operator">_∙curPhase=_</a> <a id="10236" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10238" href="Types.html#9642" class="Function Operator">_∙curPhase↝_</a><a id="10250" class="Symbol">)</a>
    <a id="10256" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="10258" class="Symbol">(</a><a id="10259" href="Types.html#9667" class="Function">$nextPhase</a> <a id="10270" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10272" href="Types.html#9678" class="Function Operator">_∙nextPhase</a> <a id="10284" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10286" href="Types.html#9690" class="Function Operator">_∙nextPhase=_</a> <a id="10300" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10302" href="Types.html#9704" class="Function Operator">_∙nextPhase↝_</a><a id="10315" class="Symbol">)</a>
    <a id="10321" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="10323" class="Symbol">(</a><a id="10324" href="Types.html#9730" class="Function">$hasPlayedLand</a> <a id="10339" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10341" href="Types.html#9745" class="Function Operator">_∙hasPlayedLand</a> <a id="10357" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10359" href="Types.html#9761" class="Function Operator">_∙hasPlayedLand=_</a> <a id="10377" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10379" href="Types.html#9779" class="Function Operator">_∙hasPlayedLand↝_</a><a id="10396" class="Symbol">)</a>
    <a id="10402" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="10404" class="Symbol">(</a><a id="10405" href="Types.html#9809" class="Function">$outcome</a> <a id="10414" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10416" href="Types.html#9818" class="Function Operator">_∙outcome</a> <a id="10426" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10428" href="Types.html#9828" class="Function Operator">_∙outcome=_</a> <a id="10440" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10442" href="Types.html#9840" class="Function Operator">_∙outcome↝_</a><a id="10453" class="Symbol">)</a>
    <a id="10459" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="10461" class="Symbol">(</a><a id="10462" href="Types.html#9864" class="Function">$attackers</a> <a id="10473" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10475" href="Types.html#9875" class="Function Operator">_∙attackers</a> <a id="10487" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10489" href="Types.html#9887" class="Function Operator">_∙attackers=_</a> <a id="10503" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10505" href="Types.html#9901" class="Function Operator">_∙attackers↝_</a><a id="10518" class="Symbol">)</a>
    <a id="10524" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="10526" class="Symbol">(</a><a id="10527" href="Types.html#9927" class="Function">$blockers</a> <a id="10537" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10539" href="Types.html#9937" class="Function Operator">_∙blockers</a> <a id="10550" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10552" href="Types.html#9948" class="Function Operator">_∙blockers=_</a> <a id="10565" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10567" href="Types.html#9961" class="Function Operator">_∙blockers↝_</a><a id="10579" class="Symbol">)</a>
    <a id="10585" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="10587" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="10589" class="Symbol">)</a>
<a id="10591" class="Keyword">infixl</a> <a id="10598" class="Number">9.9</a>
  <a id="10604" href="Types.html#9436" class="Function Operator">_∙l</a>
  <a id="10610" href="Types.html#9466" class="Function Operator">_∙r</a>
  <a id="10616" href="Types.html#9503" class="Function Operator">_∙curTurn</a>
  <a id="10628" href="Types.html#9559" class="Function Operator">_∙nextTurn</a>
  <a id="10641" href="Types.html#9618" class="Function Operator">_∙curPhase</a>
  <a id="10654" href="Types.html#9678" class="Function Operator">_∙nextPhase</a>
  <a id="10668" href="Types.html#9745" class="Function Operator">_∙hasPlayedLand</a>
  <a id="10686" href="Types.html#9818" class="Function Operator">_∙outcome</a>
  <a id="10698" href="Types.html#9875" class="Function Operator">_∙attackers</a>
  <a id="10712" href="Types.html#9937" class="Function Operator">_∙blockers</a>
<a id="10723" class="Keyword">infixl</a> <a id="10730" class="Number">10</a>
  <a id="10735" href="Types.html#9440" class="Function Operator">_∙l=_</a> <a id="10741" href="Types.html#9446" class="Function Operator">_∙l↝_</a>
  <a id="10749" href="Types.html#9470" class="Function Operator">_∙r=_</a> <a id="10755" href="Types.html#9476" class="Function Operator">_∙r↝_</a>
  <a id="10763" href="Types.html#9513" class="Function Operator">_∙curTurn=_</a> <a id="10775" href="Types.html#9525" class="Function Operator">_∙curTurn↝_</a>
  <a id="10789" href="Types.html#9570" class="Function Operator">_∙nextTurn=_</a> <a id="10802" href="Types.html#9583" class="Function Operator">_∙nextTurn↝_</a>
  <a id="10817" href="Types.html#9629" class="Function Operator">_∙curPhase=_</a> <a id="10830" href="Types.html#9642" class="Function Operator">_∙curPhase↝_</a>
  <a id="10845" href="Types.html#9690" class="Function Operator">_∙nextPhase=_</a> <a id="10859" href="Types.html#9704" class="Function Operator">_∙nextPhase↝_</a>
  <a id="10875" href="Types.html#9761" class="Function Operator">_∙hasPlayedLand=_</a> <a id="10893" href="Types.html#9779" class="Function Operator">_∙hasPlayedLand↝_</a>
  <a id="10913" href="Types.html#9828" class="Function Operator">_∙outcome=_</a> <a id="10925" href="Types.html#9840" class="Function Operator">_∙outcome↝_</a>
  <a id="10939" href="Types.html#9887" class="Function Operator">_∙attackers=_</a> <a id="10953" href="Types.html#9901" class="Function Operator">_∙attackers↝_</a>
  <a id="10969" href="Types.html#9948" class="Function Operator">_∙blockers=_</a> <a id="10982" href="Types.html#9961" class="Function Operator">_∙blockers↝_</a>

  <a id="10998" href="Types.html#11282" class="Function Operator">_∘curPlayer↝_</a> <a id="11012" href="Types.html#11296" class="Function Operator">_∘otherPlayer↝_</a>
  <a id="11030" href="Types.html#11443" class="Function Operator">_∙curPlayer=_</a> <a id="11044" href="Types.html#11457" class="Function Operator">_∙otherPlayer=_</a>

<a id="_∘curPlayer"></a><a id="11061" href="Types.html#11061" class="Function Operator">_∘curPlayer</a> <a id="_∘otherPlayer"></a><a id="11073" href="Types.html#11073" class="Function Operator">_∘otherPlayer</a> <a id="11087" class="Symbol">:</a> <a id="11089" href="Types.html#8537" class="Record">GameState</a> <a id="11099" class="Symbol">→</a> <a id="11101" href="Prelude.Lenses.Core.html#374" class="Record">Lens</a> <a id="11106" href="Types.html#8537" class="Record">GameState</a> <a id="11116" href="Types.html#7067" class="Record">Player</a>
<a id="11123" href="Types.html#11123" class="Bound">s</a> <a id="11125" href="Types.html#11061" class="Function Operator">∘curPlayer</a> <a id="11136" class="Symbol">=</a> <a id="11138" href="Function.Base.html#4121" class="Function Operator">case</a> <a id="11143" href="Types.html#11123" class="Bound">s</a> <a id="11145" href="Types.html#9503" class="Function Operator">∙curTurn</a> <a id="11154" href="Function.Base.html#4121" class="Function Operator">of</a> <a id="11157" class="Symbol">λ</a> <a id="11159" class="Keyword">where</a>
  <a id="11167" href="Types.html#8384" class="InductiveConstructor">on-the-play</a> <a id="11179" class="Symbol">→</a> <a id="11181" href="Types.html#9434" class="Function">𝕃</a>
  <a id="11185" href="Types.html#8396" class="InductiveConstructor">on-the-draw</a> <a id="11197" class="Symbol">→</a> <a id="11199" href="Types.html#9464" class="Function">ℝ</a>
<a id="11201" href="Types.html#11201" class="Bound">s</a> <a id="11203" href="Types.html#11073" class="Function Operator">∘otherPlayer</a> <a id="11216" class="Symbol">=</a> <a id="11218" href="Function.Base.html#4121" class="Function Operator">case</a> <a id="11223" href="Types.html#11201" class="Bound">s</a> <a id="11225" href="Types.html#9503" class="Function Operator">∙curTurn</a> <a id="11234" href="Function.Base.html#4121" class="Function Operator">of</a> <a id="11237" class="Symbol">λ</a> <a id="11239" class="Keyword">where</a>
  <a id="11247" href="Types.html#8384" class="InductiveConstructor">on-the-play</a> <a id="11259" class="Symbol">→</a> <a id="11261" href="Types.html#9464" class="Function">ℝ</a>
  <a id="11265" href="Types.html#8396" class="InductiveConstructor">on-the-draw</a> <a id="11277" class="Symbol">→</a> <a id="11279" href="Types.html#9434" class="Function">𝕃</a>

<a id="_∘curPlayer↝_"></a><a id="11282" href="Types.html#11282" class="Function Operator">_∘curPlayer↝_</a> <a id="_∘otherPlayer↝_"></a><a id="11296" href="Types.html#11296" class="Function Operator">_∘otherPlayer↝_</a> <a id="11312" class="Symbol">:</a> <a id="11314" href="Prelude.Lenses.Core.html#193" class="Function">Modifier</a> <a id="11323" href="Types.html#8537" class="Record">GameState</a> <a id="11333" href="Types.html#7067" class="Record">Player</a>
<a id="11340" href="Types.html#11340" class="Bound">s</a> <a id="11342" href="Types.html#11282" class="Function Operator">∘curPlayer↝</a>   <a id="11356" href="Types.html#11356" class="Bound">f</a> <a id="11358" class="Symbol">=</a> <a id="11360" class="Symbol">((</a><a id="11362" href="Types.html#11340" class="Bound">s</a> <a id="11364" href="Types.html#11061" class="Function Operator">∘curPlayer</a><a id="11374" class="Symbol">)</a>   <a id="11378" href="Prelude.Lenses.Core.html#496" class="Function Operator">∙modify</a><a id="11385" class="Symbol">)</a> <a id="11387" href="Types.html#11340" class="Bound">s</a> <a id="11389" href="Types.html#11356" class="Bound">f</a>
<a id="11391" href="Types.html#11391" class="Bound">s</a> <a id="11393" href="Types.html#11296" class="Function Operator">∘otherPlayer↝</a> <a id="11407" href="Types.html#11407" class="Bound">f</a> <a id="11409" class="Symbol">=</a> <a id="11411" class="Symbol">((</a><a id="11413" href="Types.html#11391" class="Bound">s</a> <a id="11415" href="Types.html#11073" class="Function Operator">∘otherPlayer</a><a id="11427" class="Symbol">)</a> <a id="11429" href="Prelude.Lenses.Core.html#496" class="Function Operator">∙modify</a><a id="11436" class="Symbol">)</a> <a id="11438" href="Types.html#11391" class="Bound">s</a> <a id="11440" href="Types.html#11407" class="Bound">f</a>

<a id="_∙curPlayer=_"></a><a id="11443" href="Types.html#11443" class="Function Operator">_∙curPlayer=_</a> <a id="_∙otherPlayer=_"></a><a id="11457" href="Types.html#11457" class="Function Operator">_∙otherPlayer=_</a> <a id="11473" class="Symbol">:</a> <a id="11475" href="Prelude.Lenses.Core.html#157" class="Function">Setter</a> <a id="11482" href="Types.html#8537" class="Record">GameState</a> <a id="11492" href="Types.html#7067" class="Record">Player</a>
<a id="11499" href="Types.html#11499" class="Bound">s</a> <a id="11501" href="Types.html#11443" class="Function Operator">∙curPlayer=</a>   <a id="11515" href="Types.html#11515" class="Bound">p</a> <a id="11517" class="Symbol">=</a> <a id="11519" class="Symbol">(</a><a id="11520" href="Types.html#11499" class="Bound">s</a> <a id="11522" href="Types.html#11061" class="Function Operator">∘curPlayer</a><a id="11532" class="Symbol">)</a>   <a id="11536" class="Symbol">.</a><a id="11537" href="Prelude.Lenses.Core.html#424" class="Field">set</a> <a id="11541" href="Types.html#11499" class="Bound">s</a> <a id="11543" href="Types.html#11515" class="Bound">p</a>
<a id="11545" href="Types.html#11545" class="Bound">s</a> <a id="11547" href="Types.html#11457" class="Function Operator">∙otherPlayer=</a> <a id="11561" href="Types.html#11561" class="Bound">p</a> <a id="11563" class="Symbol">=</a> <a id="11565" class="Symbol">(</a><a id="11566" href="Types.html#11545" class="Bound">s</a> <a id="11568" href="Types.html#11073" class="Function Operator">∘otherPlayer</a><a id="11580" class="Symbol">)</a> <a id="11582" class="Symbol">.</a><a id="11583" href="Prelude.Lenses.Core.html#424" class="Field">set</a> <a id="11587" href="Types.html#11545" class="Bound">s</a> <a id="11589" href="Types.html#11561" class="Bound">p</a>

<a id="_∙curPlayer"></a><a id="11592" href="Types.html#11592" class="Function Operator">_∙curPlayer</a> <a id="_∙otherPlayer"></a><a id="11604" href="Types.html#11604" class="Function Operator">_∙otherPlayer</a> <a id="11618" class="Symbol">:</a> <a id="11620" href="Prelude.Lenses.Core.html#125" class="Function">Getter</a> <a id="11627" href="Types.html#8537" class="Record">GameState</a> <a id="11637" href="Types.html#7067" class="Record">Player</a>
<a id="11644" href="Types.html#11644" class="Bound">s</a> <a id="11646" href="Types.html#11592" class="Function Operator">∙curPlayer</a> <a id="11657" class="Symbol">=</a> <a id="11659" href="Function.Base.html#4121" class="Function Operator">case</a> <a id="11664" href="Types.html#11644" class="Bound">s</a> <a id="11666" href="Types.html#9503" class="Function Operator">∙curTurn</a> <a id="11675" href="Function.Base.html#4121" class="Function Operator">of</a> <a id="11678" class="Symbol">λ</a> <a id="11680" class="Keyword">where</a>
  <a id="11688" href="Types.html#8384" class="InductiveConstructor">on-the-play</a> <a id="11700" class="Symbol">→</a> <a id="11702" href="Types.html#11644" class="Bound">s</a> <a id="11704" href="Types.html#9436" class="Function Operator">∙l</a>
  <a id="11709" href="Types.html#8396" class="InductiveConstructor">on-the-draw</a> <a id="11721" class="Symbol">→</a> <a id="11723" href="Types.html#11644" class="Bound">s</a> <a id="11725" href="Types.html#9466" class="Function Operator">∙r</a>
<a id="11728" href="Types.html#11728" class="Bound">s</a> <a id="11730" href="Types.html#11604" class="Function Operator">∙otherPlayer</a> <a id="11743" class="Symbol">=</a> <a id="11745" href="Function.Base.html#4121" class="Function Operator">case</a> <a id="11750" href="Types.html#11728" class="Bound">s</a> <a id="11752" href="Types.html#9503" class="Function Operator">∙curTurn</a> <a id="11761" href="Function.Base.html#4121" class="Function Operator">of</a> <a id="11764" class="Symbol">λ</a> <a id="11766" class="Keyword">where</a>
  <a id="11774" href="Types.html#8384" class="InductiveConstructor">on-the-play</a> <a id="11786" class="Symbol">→</a> <a id="11788" href="Types.html#11728" class="Bound">s</a> <a id="11790" href="Types.html#9466" class="Function Operator">∙r</a>
  <a id="11795" href="Types.html#8396" class="InductiveConstructor">on-the-draw</a> <a id="11807" class="Symbol">→</a> <a id="11809" href="Types.html#11728" class="Bound">s</a> <a id="11811" href="Types.html#9436" class="Function Operator">∙l</a>

<a id="11815" class="Keyword">infix</a> <a id="11821" class="Number">9.9</a> <a id="11825" href="Types.html#11839" class="Function Operator">_∙proceedTurn</a>
<a id="_∙proceedTurn"></a><a id="11839" href="Types.html#11839" class="Function Operator">_∙proceedTurn</a> <a id="11853" class="Symbol">:</a> <a id="11855" href="Algebra.Core.html#475" class="Function">Op₁</a> <a id="11859" href="Types.html#8537" class="Record">GameState</a>
<a id="11869" href="Types.html#11869" class="Bound">s</a> <a id="11871" href="Types.html#11839" class="Function Operator">∙proceedTurn</a> <a id="11884" class="Symbol">=</a> <a id="11886" href="Types.html#11932" class="Function">reset</a> <a id="11892" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="11894" href="Types.html#11869" class="Bound">s</a> <a id="11896" href="Types.html#9525" class="Function Operator">∙curTurn↝</a> <a id="11906" class="Symbol">(</a><a id="11907" href="Types.html#11869" class="Bound">s</a> <a id="11909" href="Types.html#9559" class="Function Operator">∙nextTurn</a><a id="11918" class="Symbol">)</a>
  <a id="11922" class="Keyword">where</a>
    <a id="11932" href="Types.html#11932" class="Function">reset</a> <a id="11938" class="Symbol">:</a> <a id="11940" href="Algebra.Core.html#475" class="Function">Op₁</a> <a id="11944" href="Types.html#8537" class="Record">GameState</a>
    <a id="11958" href="Types.html#11932" class="Function">reset</a> <a id="11964" href="Types.html#11964" class="Bound">s</a> <a id="11966" class="Symbol">=</a> <a id="11968" href="Types.html#11964" class="Bound">s</a> <a id="11970" href="Types.html#9761" class="Function Operator">∙hasPlayedLand=</a> <a id="11986" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a>
             <a id="12005" class="Comment">-- ∙nextPhase= (Default-NextPhase .def)</a>
             <a id="12058" class="Comment">-- ∙nextTurn= (Default-TurnPhase .def)</a>
                <a id="12113" href="Types.html#11282" class="Function Operator">∘curPlayer↝</a>   <a id="12127" class="Symbol">(</a><a id="12128" href="Types.html#7637" class="Function Operator">_∙control↝</a> <a id="12139" href="Data.List.Base.html#1544" class="Function">map</a> <a id="12143" href="Types.html#6289" class="Function Operator">_∙untap</a><a id="12150" class="Symbol">)</a>
                <a id="12168" href="Types.html#11296" class="Function Operator">∘otherPlayer↝</a> <a id="12182" class="Symbol">(</a><a id="12183" href="Types.html#7637" class="Function Operator">_∙control↝</a> <a id="12194" href="Data.List.Base.html#1544" class="Function">map</a> <a id="12198" href="Types.html#6289" class="Function Operator">_∙untap</a><a id="12205" class="Symbol">)</a>

<a id="12208" class="Keyword">infix</a> <a id="12214" class="Number">9.9</a> <a id="12218" href="Types.html#12233" class="Function Operator">_∙proceedPhase</a>
<a id="_∙proceedPhase"></a><a id="12233" href="Types.html#12233" class="Function Operator">_∙proceedPhase</a> <a id="12248" class="Symbol">:</a> <a id="12250" href="Algebra.Core.html#475" class="Function">Op₁</a> <a id="12254" href="Types.html#8537" class="Record">GameState</a>
<a id="12264" href="Types.html#12264" class="Bound">s</a> <a id="12266" href="Types.html#12233" class="Function Operator">∙proceedPhase</a> <a id="12280" class="Symbol">=</a> <a id="12282" href="Types.html#12264" class="Bound">s</a> <a id="12284" href="Types.html#9642" class="Function Operator">∙curPhase↝</a> <a id="12295" class="Symbol">(</a><a id="12296" href="Types.html#12264" class="Bound">s</a> <a id="12298" href="Types.html#9678" class="Function Operator">∙nextPhase</a><a id="12308" class="Symbol">)</a>
                    <a id="12330" href="Types.html#11282" class="Function Operator">∘curPlayer↝</a>   <a id="12344" class="Symbol">(</a><a id="12345" href="Types.html#7682" class="Function Operator">_∙manaPool=</a> <a id="12357" href="Prelude.Maps.Concrete.html#906" class="Function">∅</a><a id="12358" class="Symbol">)</a>
                    <a id="12380" href="Types.html#11296" class="Function Operator">∘otherPlayer↝</a> <a id="12394" class="Symbol">(</a><a id="12395" href="Types.html#7682" class="Function Operator">_∙manaPool=</a> <a id="12407" href="Prelude.Maps.Concrete.html#906" class="Function">∅</a><a id="12408" class="Symbol">)</a>
<a id="proceedPhase"></a><a id="12410" href="Types.html#12410" class="Function">proceedPhase</a> <a id="12423" class="Symbol">=</a> <a id="12425" href="Types.html#12233" class="Function Operator">_∙proceedPhase</a>

<a id="12441" class="Keyword">instance</a>
  <a id="Default-Player"></a><a id="12452" href="Types.html#12452" class="Function">Default-Player</a> <a id="12467" class="Symbol">:</a> <a id="12469" href="Prelude.Default.html#676" class="Record">Default</a> <a id="12477" href="Types.html#7067" class="Record">Player</a>
  <a id="12486" href="Types.html#12452" class="Function">Default-Player</a> <a id="12501" class="Symbol">.</a><a id="12502" href="Prelude.Default.html#736" class="Field">def</a> <a id="12506" class="Symbol">=</a> <a id="12508" class="Symbol">λ</a> <a id="12510" class="Keyword">where</a>
    <a id="12520" class="Symbol">.</a><a id="12521" href="Types.html#7122" class="Field">name</a> <a id="12526" class="Symbol">→</a> <a id="12528" href="Prelude.Monoid.html#178" class="Field">ε</a>
    <a id="12534" class="Symbol">.</a><a id="12535" href="Types.html#7140" class="Field">library</a> <a id="12543" class="Symbol">→</a> <a id="12545" href="Prelude.Monoid.html#178" class="Field">ε</a>
    <a id="12551" class="Symbol">.</a><a id="12552" href="Types.html#7160" class="Field">hand</a> <a id="12557" class="Symbol">→</a> <a id="12559" href="Prelude.Monoid.html#178" class="Field">ε</a>
    <a id="12565" class="Symbol">.</a><a id="12566" href="Types.html#7176" class="Field">graveyard</a> <a id="12576" class="Symbol">→</a> <a id="12578" href="Prelude.Monoid.html#178" class="Field">ε</a>
    <a id="12584" class="Symbol">.</a><a id="12585" href="Types.html#7198" class="Field">exile</a> <a id="12591" class="Symbol">→</a> <a id="12593" href="Prelude.Monoid.html#178" class="Field">ε</a>
    <a id="12599" class="Symbol">.</a><a id="12600" href="Types.html#7216" class="Field">life</a> <a id="12605" class="Symbol">→</a> <a id="12607" href="Prelude.Monoid.html#178" class="Field">ε</a>
    <a id="12613" class="Symbol">.</a><a id="12614" href="Types.html#7229" class="Field">control</a> <a id="12622" class="Symbol">→</a> <a id="12624" href="Prelude.Monoid.html#178" class="Field">ε</a>
    <a id="12630" class="Symbol">.</a><a id="12631" href="Types.html#7261" class="Field">manaPool</a> <a id="12640" class="Symbol">→</a> <a id="12642" href="Prelude.Maps.Concrete.html#906" class="Function">∅</a>

  <a id="Default-Turn"></a><a id="12647" href="Types.html#12647" class="Function">Default-Turn</a> <a id="12660" class="Symbol">:</a> <a id="12662" href="Prelude.Default.html#676" class="Record">Default</a> <a id="12670" href="Types.html#8364" class="Datatype">Turn</a>
  <a id="12677" href="Types.html#12647" class="Function">Default-Turn</a> <a id="12690" class="Symbol">.</a><a id="12691" href="Prelude.Default.html#736" class="Field">def</a> <a id="12695" class="Symbol">=</a> <a id="12697" href="Types.html#8384" class="InductiveConstructor">on-the-play</a>

  <a id="Default-NextTurn"></a><a id="12712" href="Types.html#12712" class="Function">Default-NextTurn</a> <a id="12729" class="Symbol">:</a> <a id="12731" href="Prelude.Default.html#676" class="Record">Default</a> <a id="12739" class="Symbol">(</a><a id="12740" href="Algebra.Core.html#475" class="Function">Op₁</a> <a id="12744" href="Types.html#8364" class="Datatype">Turn</a><a id="12748" class="Symbol">)</a>
  <a id="12752" href="Types.html#12712" class="Function">Default-NextTurn</a> <a id="12769" class="Symbol">.</a><a id="12770" href="Prelude.Default.html#736" class="Field">def</a> <a id="12774" class="Symbol">=</a> <a id="12776" class="Symbol">λ</a> <a id="12778" class="Keyword">where</a>
    <a id="12788" href="Types.html#8396" class="InductiveConstructor">on-the-draw</a> <a id="12800" class="Symbol">→</a> <a id="12802" href="Types.html#8384" class="InductiveConstructor">on-the-play</a>
    <a id="12818" href="Types.html#8384" class="InductiveConstructor">on-the-play</a> <a id="12830" class="Symbol">→</a> <a id="12832" href="Types.html#8396" class="InductiveConstructor">on-the-draw</a>

  <a id="Default-Phase"></a><a id="12847" href="Types.html#12847" class="Function">Default-Phase</a> <a id="12861" class="Symbol">:</a> <a id="12863" href="Prelude.Default.html#676" class="Record">Default</a> <a id="12871" href="Types.html#8421" class="Datatype">Phase</a>
  <a id="12879" href="Types.html#12847" class="Function">Default-Phase</a> <a id="12893" class="Symbol">.</a><a id="12894" href="Prelude.Default.html#736" class="Field">def</a> <a id="12898" class="Symbol">=</a> <a id="12900" href="Types.html#8442" class="InductiveConstructor">draw</a>

  <a id="Default-NextPhase"></a><a id="12908" href="Types.html#12908" class="Function">Default-NextPhase</a> <a id="12926" class="Symbol">:</a> <a id="12928" href="Prelude.Default.html#676" class="Record">Default</a> <a id="12936" class="Symbol">(</a><a id="12937" href="Algebra.Core.html#475" class="Function">Op₁</a> <a id="12941" href="Types.html#8421" class="Datatype">Phase</a><a id="12946" class="Symbol">)</a>
  <a id="12950" href="Types.html#12908" class="Function">Default-NextPhase</a> <a id="12968" class="Symbol">.</a><a id="12969" href="Prelude.Default.html#736" class="Field">def</a> <a id="12973" class="Symbol">=</a> <a id="12975" class="Symbol">λ</a> <a id="12977" class="Keyword">where</a>
    <a id="12987" href="Types.html#8442" class="InductiveConstructor">draw</a>   <a id="12994" class="Symbol">→</a> <a id="12996" href="Types.html#8447" class="InductiveConstructor">main</a>
    <a id="13005" href="Types.html#8447" class="InductiveConstructor">main</a>   <a id="13012" class="Symbol">→</a> <a id="13014" href="Types.html#8452" class="InductiveConstructor">attack</a>
    <a id="13025" href="Types.html#8452" class="InductiveConstructor">attack</a> <a id="13032" class="Symbol">→</a> <a id="13034" href="Types.html#8459" class="InductiveConstructor">end</a>
    <a id="13042" href="Types.html#8459" class="InductiveConstructor">end</a>    <a id="13049" class="Symbol">→</a> <a id="13051" href="Types.html#8442" class="InductiveConstructor">draw</a>

  <a id="Default-GameState"></a><a id="13059" href="Types.html#13059" class="Function">Default-GameState</a> <a id="13077" class="Symbol">:</a> <a id="13079" href="Prelude.Default.html#676" class="Record">Default</a> <a id="13087" href="Types.html#8537" class="Record">GameState</a>
  <a id="13099" href="Types.html#13059" class="Function">Default-GameState</a> <a id="13117" class="Symbol">.</a><a id="13118" href="Prelude.Default.html#736" class="Field">def</a> <a id="13122" class="Symbol">=</a> <a id="13124" class="Symbol">λ</a> <a id="13126" class="Keyword">where</a>
    <a id="13136" class="Symbol">.</a><a id="13137" href="Types.html#8572" class="Field">player₁</a> <a id="13145" class="Symbol">→</a> <a id="13147" href="Prelude.Default.html#736" class="Field">def</a>
    <a id="13155" class="Symbol">.</a><a id="13156" href="Types.html#8594" class="Field">player₂</a> <a id="13164" class="Symbol">→</a> <a id="13166" href="Prelude.Default.html#736" class="Field">def</a>
    <a id="13174" class="Symbol">.</a><a id="13175" href="Types.html#8617" class="Field">curTurn</a> <a id="13183" class="Symbol">→</a> <a id="13185" href="Prelude.Default.html#736" class="Field">def</a>
    <a id="13193" class="Symbol">.</a><a id="13194" href="Types.html#8636" class="Field">nextTurn</a> <a id="13203" class="Symbol">→</a> <a id="13205" href="Types.html#12712" class="Function">Default-NextTurn</a> <a id="13222" class="Symbol">.</a><a id="13223" href="Prelude.Default.html#736" class="Field">def</a>
    <a id="13231" class="Symbol">.</a><a id="13232" href="Types.html#8661" class="Field">curPhase</a> <a id="13241" class="Symbol">→</a> <a id="13243" href="Prelude.Default.html#736" class="Field">def</a>
    <a id="13251" class="Symbol">.</a><a id="13252" href="Types.html#8682" class="Field">nextPhase</a> <a id="13262" class="Symbol">→</a> <a id="13264" href="Types.html#12908" class="Function">Default-NextPhase</a> <a id="13282" class="Symbol">.</a><a id="13283" href="Prelude.Default.html#736" class="Field">def</a>
    <a id="13291" class="Symbol">.</a><a id="13292" href="Types.html#8709" class="Field">hasPlayedLand</a> <a id="13306" class="Symbol">→</a> <a id="13308" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a>
    <a id="13318" class="Symbol">.</a><a id="13319" href="Types.html#8734" class="Field">outcome</a> <a id="13327" class="Symbol">→</a> <a id="13329" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
    <a id="13341" class="Symbol">.</a><a id="13342" href="Types.html#8762" class="Field">attackers</a> <a id="13352" class="Symbol">→</a> <a id="13354" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
    <a id="13366" class="Symbol">.</a><a id="13367" href="Types.html#8804" class="Field">blockers</a> <a id="13376" class="Symbol">→</a> <a id="13378" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>

<a id="13387" class="Keyword">instance</a>
  <a id="Show-Player"></a><a id="13398" href="Types.html#13398" class="Function">Show-Player</a> <a id="13410" class="Symbol">:</a> <a id="13412" href="Prelude.Show.html#280" class="Record">Show</a> <a id="13417" href="Types.html#7067" class="Record">Player</a>
  <a id="13426" href="Types.html#13398" class="Function">Show-Player</a> <a id="13438" class="Symbol">.</a><a id="13439" href="Prelude.Show.html#315" class="Field">show</a> <a id="13444" href="Types.html#13444" class="Bound">p</a> <a id="13446" class="Symbol">=</a>
    <a id="13452" class="String">&quot;{name: &quot;</a> <a id="13462" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="13464" href="Prelude.Show.html#315" class="Field">show</a> <a id="13469" class="Symbol">(</a><a id="13470" href="Types.html#13444" class="Bound">p</a> <a id="13472" href="Types.html#7318" class="Function Operator">∙name</a><a id="13477" class="Symbol">)</a> <a id="13479" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="13481" class="String">&quot;,&quot;</a> <a id="13485" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a>
    <a id="13491" class="String">&quot;life: &quot;</a> <a id="13500" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="13502" href="Prelude.Show.html#315" class="Field">show</a> <a id="13507" class="Symbol">(</a><a id="13508" href="Types.html#13444" class="Bound">p</a> <a id="13510" href="Types.html#7569" class="Function Operator">∙life</a><a id="13515" class="Symbol">)</a> <a id="13517" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="13519" class="String">&quot;}&quot;</a>
    <a id="13527" class="Comment">-- &quot;hand: &quot; ◇</a>

  <a id="Show-Turn"></a><a id="13544" href="Types.html#13544" class="Function">Show-Turn</a> <a id="13554" class="Symbol">:</a> <a id="13556" href="Prelude.Show.html#280" class="Record">Show</a> <a id="13561" href="Types.html#8364" class="Datatype">Turn</a>
  <a id="13568" href="Types.html#13544" class="Function">Show-Turn</a> <a id="13578" class="Symbol">.</a><a id="13579" href="Prelude.Show.html#315" class="Field">show</a> <a id="13584" class="Symbol">=</a> <a id="13586" class="Symbol">λ</a> <a id="13588" class="Keyword">where</a>
    <a id="13598" href="Types.html#8384" class="InductiveConstructor">on-the-play</a> <a id="13610" class="Symbol">→</a> <a id="13612" class="String">&quot;on-the-play&quot;</a>
    <a id="13630" href="Types.html#8396" class="InductiveConstructor">on-the-draw</a> <a id="13642" class="Symbol">→</a> <a id="13644" class="String">&quot;on-the-draw&quot;</a>

  <a id="Show-Phase"></a><a id="13661" href="Types.html#13661" class="Function">Show-Phase</a> <a id="13672" class="Symbol">:</a> <a id="13674" href="Prelude.Show.html#280" class="Record">Show</a> <a id="13679" href="Types.html#8421" class="Datatype">Phase</a>
  <a id="13687" href="Types.html#13661" class="Function">Show-Phase</a> <a id="13698" class="Symbol">.</a><a id="13699" href="Prelude.Show.html#315" class="Field">show</a> <a id="13704" class="Symbol">=</a> <a id="13706" class="Symbol">λ</a> <a id="13708" class="Keyword">where</a>
    <a id="13718" href="Types.html#8442" class="InductiveConstructor">draw</a>   <a id="13725" class="Symbol">→</a> <a id="13727" class="String">&quot;draw&quot;</a>
    <a id="13738" href="Types.html#8447" class="InductiveConstructor">main</a>   <a id="13745" class="Symbol">→</a> <a id="13747" class="String">&quot;main&quot;</a>
    <a id="13758" href="Types.html#8452" class="InductiveConstructor">attack</a> <a id="13765" class="Symbol">→</a> <a id="13767" class="String">&quot;attack&quot;</a>
    <a id="13780" href="Types.html#8459" class="InductiveConstructor">end</a>    <a id="13787" class="Symbol">→</a> <a id="13789" class="String">&quot;end&quot;</a>

  <a id="Show-GameState"></a><a id="13798" href="Types.html#13798" class="Function">Show-GameState</a> <a id="13813" class="Symbol">:</a> <a id="13815" href="Prelude.Show.html#280" class="Record">Show</a> <a id="13820" href="Types.html#8537" class="Record">GameState</a>
  <a id="13832" href="Types.html#13798" class="Function">Show-GameState</a> <a id="13847" class="Symbol">.</a><a id="13848" href="Prelude.Show.html#315" class="Field">show</a> <a id="13853" href="Types.html#13853" class="Bound">s</a> <a id="13855" class="Symbol">=</a>
    <a id="13861" class="String">&quot;player₁: &quot;</a> <a id="13873" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="13875" href="Prelude.Show.html#315" class="Field">show</a> <a id="13880" class="Symbol">(</a><a id="13881" href="Types.html#13853" class="Bound">s</a> <a id="13883" href="Types.html#9436" class="Function Operator">∙l</a><a id="13885" class="Symbol">)</a> <a id="13887" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="13889" class="String">&quot;\n&quot;</a> <a id="13894" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a>
    <a id="13900" class="String">&quot;player₂: &quot;</a> <a id="13912" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="13914" href="Prelude.Show.html#315" class="Field">show</a> <a id="13919" class="Symbol">(</a><a id="13920" href="Types.html#13853" class="Bound">s</a> <a id="13922" href="Types.html#9466" class="Function Operator">∙r</a><a id="13924" class="Symbol">)</a> <a id="13926" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="13928" class="String">&quot;\n&quot;</a> <a id="13933" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a>
    <a id="13939" class="String">&quot;curTurn: &quot;</a> <a id="13951" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="13953" href="Prelude.Show.html#315" class="Field">show</a> <a id="13958" class="Symbol">(</a><a id="13959" href="Types.html#13853" class="Bound">s</a> <a id="13961" href="Types.html#9503" class="Function Operator">∙curTurn</a><a id="13969" class="Symbol">)</a> <a id="13971" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="13973" class="String">&quot;\n&quot;</a> <a id="13978" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a>
    <a id="13984" class="String">&quot;curPhase: &quot;</a> <a id="13997" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="13999" href="Prelude.Show.html#315" class="Field">show</a> <a id="14004" class="Symbol">(</a><a id="14005" href="Types.html#13853" class="Bound">s</a> <a id="14007" href="Types.html#9618" class="Function Operator">∙curPhase</a><a id="14016" class="Symbol">)</a> <a id="14018" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="14020" class="String">&quot;\n&quot;</a>

<a id="p₁≢p₂"></a><a id="14026" href="Types.html#14026" class="Function">p₁≢p₂</a> <a id="14032" class="Symbol">:</a> <a id="14034" href="Types.html#8572" class="Field">player₁</a> <a id="14042" href="Relation.Binary.PropositionalEquality.Core.html#830" class="Function Operator">≢</a> <a id="14044" href="Types.html#8594" class="Field">player₂</a>
<a id="14052" href="Types.html#14026" class="Function">p₁≢p₂</a> <a id="14058" href="Types.html#14058" class="Bound">eq</a> <a id="14061" class="Symbol">=</a>
  <a id="14065" href="Function.Base.html#4121" class="Function Operator">case</a> <a id="14070" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a> <a id="14075" class="Symbol">(</a><a id="14076" href="Types.html#7318" class="Function Operator">_∙name</a><a id="14082" class="Symbol">)</a>
     <a id="14089" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="14091" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a> <a id="14096" class="Symbol">(</a><a id="14097" href="Function.Base.html#1919" class="Function Operator">_$</a> <a id="14100" href="Prelude.Default.html#736" class="Field">def</a> <a id="14104" href="Types.html#9476" class="Function Operator">∙r↝</a> <a id="14108" class="Symbol">(</a><a id="14109" href="Types.html#7325" class="Function Operator">_∙name=</a> <a id="14117" class="String">&quot;sth&quot;</a><a id="14122" class="Symbol">))</a> <a id="14125" href="Types.html#14058" class="Bound">eq</a>
  <a id="14130" href="Function.Base.html#4121" class="Function Operator">of</a> <a id="14133" class="Symbol">λ</a> <a id="14135" class="Symbol">()</a>

<a id="𝕃≢ℝ"></a><a id="14139" href="Types.html#14139" class="Function">𝕃≢ℝ</a> <a id="14143" class="Symbol">:</a> <a id="14145" href="Types.html#9434" class="Function">𝕃</a> <a id="14147" href="Relation.Binary.PropositionalEquality.Core.html#830" class="Function Operator">≢</a> <a id="14149" href="Types.html#9464" class="Function">ℝ</a>
<a id="14151" href="Types.html#14139" class="Function">𝕃≢ℝ</a> <a id="14155" class="Symbol">=</a> <a id="14157" href="Types.html#14026" class="Function">p₁≢p₂</a> <a id="14163" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="14165" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a> <a id="14170" href="Prelude.Lenses.Core.html#403" class="Field">get</a>

<a id="mkLose"></a><a id="14175" href="Types.html#14175" class="Function">mkLose</a> <a id="mkWin"></a><a id="14182" href="Types.html#14182" class="Function">mkWin</a> <a id="14188" class="Symbol">:</a> <a id="14190" href="Types.html#8364" class="Datatype">Turn</a> <a id="14195" class="Symbol">→</a> <a id="14197" href="Types.html#8477" class="Datatype">Outcome</a>
<a id="14205" href="Types.html#14175" class="Function">mkLose</a> <a id="14212" class="Symbol">=</a> <a id="14214" class="Symbol">λ</a> <a id="14216" class="Keyword">where</a>
  <a id="14224" href="Types.html#8384" class="InductiveConstructor">on-the-play</a> <a id="14236" class="Symbol">→</a> <a id="14238" href="Types.html#8512" class="InductiveConstructor">𝟚-WINS</a>
  <a id="14247" href="Types.html#8396" class="InductiveConstructor">on-the-draw</a> <a id="14259" class="Symbol">→</a> <a id="14261" href="Types.html#8505" class="InductiveConstructor">𝟙-WINS</a>
<a id="14268" href="Types.html#14182" class="Function">mkWin</a> <a id="14274" class="Symbol">=</a> <a id="14276" class="Symbol">λ</a> <a id="14278" class="Keyword">where</a>
  <a id="14286" href="Types.html#8384" class="InductiveConstructor">on-the-play</a> <a id="14298" class="Symbol">→</a> <a id="14300" href="Types.html#8505" class="InductiveConstructor">𝟙-WINS</a>
  <a id="14309" href="Types.html#8396" class="InductiveConstructor">on-the-draw</a> <a id="14321" class="Symbol">→</a> <a id="14323" href="Types.html#8512" class="InductiveConstructor">𝟚-WINS</a>

<a id="toControl"></a><a id="14331" href="Types.html#14331" class="Function">toControl</a> <a id="14341" class="Symbol">:</a> <a id="14343" class="Symbol">∀</a> <a id="14345" href="Types.html#14345" class="Bound">c</a> <a id="14347" class="Symbol">→</a> <a id="14349" href="Types.html#5878" class="Function">Properties</a> <a id="14360" href="Types.html#14345" class="Bound">c</a>
<a id="14362" href="Types.html#14331" class="Function">toControl</a> <a id="14372" class="Symbol">=</a> <a id="14374" class="Symbol">λ</a> <a id="14376" class="Keyword">where</a>
  <a id="14384" class="Symbol">(</a><a id="14385" href="Types.html#4656" class="InductiveConstructor">BasicLand</a> <a id="14395" class="Symbol">_)</a>    <a id="14401" class="Symbol">→</a> <a id="14403" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a>
  <a id="14408" class="Symbol">(</a><a id="14409" href="Types.html#4684" class="InductiveConstructor">Creature</a> <a id="14418" class="Symbol">_</a> <a id="14420" class="Symbol">_</a> <a id="14422" class="Symbol">_)</a> <a id="14425" class="Symbol">→</a> <a id="14427" class="Keyword">record</a> <a id="14434" class="Symbol">{</a><a id="14435" href="Types.html#5821" class="Field">summoningSickness</a> <a id="14453" class="Symbol">=</a> <a id="14455" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a><a id="14459" class="Symbol">}</a>

<a id="defInstance"></a><a id="14462" href="Types.html#14462" class="Function">defInstance</a> <a id="14474" class="Symbol">:</a> <a id="14476" href="Types.html#4636" class="Datatype">Card</a> <a id="14481" class="Symbol">→</a> <a id="14483" href="Types.html#6008" class="Record">CardInstance</a>
<a id="14496" href="Types.html#14462" class="Function">defInstance</a> <a id="14508" href="Types.html#14508" class="Bound">c</a> <a id="14510" class="Symbol">=</a> <a id="14512" class="Keyword">record</a> <a id="14519" class="Symbol">{</a><a id="14520" href="Types.html#6046" class="Field">card</a> <a id="14525" class="Symbol">=</a> <a id="14527" href="Types.html#14508" class="Bound">c</a><a id="14528" class="Symbol">;</a> <a id="14530" href="Types.html#6062" class="Field">tapped</a> <a id="14537" class="Symbol">=</a> <a id="14539" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a><a id="14544" class="Symbol">;</a> <a id="14546" href="Types.html#6080" class="Field">properties</a> <a id="14557" class="Symbol">=</a> <a id="14559" href="Types.html#14331" class="Function">toControl</a> <a id="14569" href="Types.html#14508" class="Bound">c</a><a id="14570" class="Symbol">}</a>

<a id="14573" class="Keyword">infix</a> <a id="14579" class="Number">4</a> <a id="14581" href="Types.html#14590" class="Datatype Operator">_↝_</a>
<a id="14585" class="Keyword">data</a> <a id="_↝_"></a><a id="14590" href="Types.html#14590" class="Datatype Operator">_↝_</a> <a id="14594" class="Symbol">:</a> <a id="14596" href="Prelude.Init.html#11897" class="Function">Rel₀</a> <a id="14601" href="Types.html#8537" class="Record">GameState</a> <a id="14611" class="Keyword">where</a>

  <a id="14620" class="Comment">-- PHASE: draw</a>

  <a id="_↝_.DrawLose"></a><a id="14638" href="Types.html#14638" class="InductiveConstructor">DrawLose</a> <a id="14647" class="Symbol">:</a>
    <a id="14653" href="Prelude.InferenceRules.html#56066" class="Function Operator">∙</a> <a id="14655" href="Data.Maybe.html#852" class="Function">Is-nothing</a> <a id="14666" class="Symbol">(</a><a id="14667" href="Types.html#9401" class="Generalizable">s</a> <a id="14669" href="Types.html#9818" class="Function Operator">∙outcome</a><a id="14677" class="Symbol">)</a>
    <a id="14683" href="Prelude.InferenceRules.html#56000" class="Function Operator">∙</a> <a id="14685" class="Symbol">(</a><a id="14686" href="Types.html#9401" class="Generalizable">s</a> <a id="14688" href="Types.html#9618" class="Function Operator">∙curPhase</a> <a id="14698" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="14700" href="Types.html#8442" class="InductiveConstructor">draw</a><a id="14704" class="Symbol">)</a>
    <a id="14710" href="Prelude.InferenceRules.html#56000" class="Function Operator">∙</a> <a id="14712" class="Symbol">(</a><a id="14713" href="Types.html#9401" class="Generalizable">s</a> <a id="14715" href="Types.html#11592" class="Function Operator">∙curPlayer</a> <a id="14726" href="Types.html#7364" class="Function Operator">∙library</a> <a id="14735" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="14737" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="14739" class="Symbol">)</a>
      <a id="14747" href="Prelude.InferenceRules.html#13655" class="Function Operator">─────────────────────────────────</a>
      <a id="14787" href="Types.html#9401" class="Generalizable">s</a> <a id="14789" href="Types.html#14590" class="Datatype Operator">↝</a> <a id="14791" href="Types.html#9401" class="Generalizable">s</a> <a id="14793" href="Types.html#9828" class="Function Operator">∙outcome=</a> <a id="14803" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="14808" class="Symbol">(</a><a id="14809" href="Types.html#14175" class="Function">mkLose</a> <a id="14816" class="Symbol">(</a><a id="14817" href="Types.html#9401" class="Generalizable">s</a> <a id="14819" href="Types.html#9503" class="Function Operator">∙curTurn</a><a id="14827" class="Symbol">))</a>

  <a id="_↝_.Draw"></a><a id="14833" href="Types.html#14833" class="InductiveConstructor">Draw</a> <a id="14838" class="Symbol">:</a>
    <a id="14844" href="Prelude.InferenceRules.html#56066" class="Function Operator">∙</a> <a id="14846" href="Data.Maybe.html#852" class="Function">Is-nothing</a> <a id="14857" class="Symbol">(</a><a id="14858" href="Types.html#9401" class="Generalizable">s</a> <a id="14860" href="Types.html#9818" class="Function Operator">∙outcome</a><a id="14868" class="Symbol">)</a>
    <a id="14874" href="Prelude.InferenceRules.html#56000" class="Function Operator">∙</a> <a id="14876" class="Symbol">(</a><a id="14877" href="Types.html#9401" class="Generalizable">s</a> <a id="14879" href="Types.html#9618" class="Function Operator">∙curPhase</a> <a id="14889" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="14891" href="Types.html#8442" class="InductiveConstructor">draw</a><a id="14895" class="Symbol">)</a>
    <a id="14901" href="Prelude.InferenceRules.html#56000" class="Function Operator">∙</a> <a id="14903" class="Symbol">(</a><a id="14904" href="Types.html#9401" class="Generalizable">s</a> <a id="14906" href="Types.html#11592" class="Function Operator">∙curPlayer</a> <a id="14917" href="Types.html#7364" class="Function Operator">∙library</a> <a id="14926" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a>  <a id="14929" href="Types.html#4836" class="Generalizable">c</a> <a id="14931" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="14933" href="Types.html#7018" class="Generalizable">lib</a><a id="14936" class="Symbol">)</a>
      <a id="14944" href="Prelude.InferenceRules.html#13655" class="Function Operator">─────────────────────────────────</a>
      <a id="14984" href="Types.html#9401" class="Generalizable">s</a> <a id="14986" href="Types.html#14590" class="Datatype Operator">↝</a> <a id="14988" href="Types.html#9401" class="Generalizable">s</a> <a id="14990" href="Types.html#11282" class="Function Operator">∘curPlayer↝</a> <a id="15002" class="Symbol">(</a> <a id="15004" href="Types.html#7432" class="Function Operator">_∙hand↝</a>    <a id="15015" class="Symbol">(</a><a id="15016" href="Types.html#4836" class="Generalizable">c</a> <a id="15018" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷_</a><a id="15020" class="Symbol">)</a>
                        <a id="15046" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="15048" href="Types.html#7374" class="Function Operator">_∙library=</a> <a id="15059" href="Types.html#7018" class="Generalizable">lib</a> <a id="15063" class="Symbol">)</a>
            <a id="15077" href="Types.html#12233" class="Function Operator">∙proceedPhase</a> <a id="15091" class="Comment">-- T0D0: factor out to accommodate instants</a>

  <a id="15138" class="Comment">-- PHASE: main</a>

  <a id="_↝_.PlayLand"></a><a id="15156" href="Types.html#15156" class="InductiveConstructor">PlayLand</a> <a id="15165" class="Symbol">:</a> <a id="15167" class="Keyword">let</a> <a id="15171" href="Types.html#15171" class="Bound">h</a> <a id="15173" class="Symbol">=</a> <a id="15175" href="Types.html#9401" class="Generalizable">s</a> <a id="15177" href="Types.html#11592" class="Function Operator">∙curPlayer</a> <a id="15188" href="Types.html#7416" class="Function Operator">∙hand</a> <a id="15194" class="Keyword">in</a>
    <a id="15201" href="Data.Maybe.html#852" class="Function">Is-nothing</a> <a id="15212" class="Symbol">(</a><a id="15213" href="Types.html#9401" class="Generalizable">s</a> <a id="15215" href="Types.html#9818" class="Function Operator">∙outcome</a><a id="15223" class="Symbol">)</a> <a id="15225" class="Symbol">→</a>
    <a id="15231" class="Symbol">(</a><a id="15232" href="Types.html#9401" class="Generalizable">s</a> <a id="15234" href="Types.html#9618" class="Function Operator">∙curPhase</a> <a id="15244" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="15246" href="Types.html#8447" class="InductiveConstructor">main</a><a id="15250" class="Symbol">)</a> <a id="15252" class="Symbol">→</a>
    <a id="15258" href="Relation.Nullary.html#656" class="Function Operator">¬</a> <a id="15260" href="Data.Bool.Base.html#1451" class="Function">T</a> <a id="15262" class="Symbol">(</a><a id="15263" href="Types.html#9401" class="Generalizable">s</a> <a id="15265" href="Types.html#9745" class="Function Operator">∙hasPlayedLand</a><a id="15279" class="Symbol">)</a> <a id="15281" class="Symbol">→</a>
    <a id="15287" class="Symbol">(</a><a id="15288" href="Types.html#15288" class="Bound">c∈</a> <a id="15291" class="Symbol">:</a> <a id="15293" href="Types.html#4836" class="Generalizable">c</a> <a id="15295" href="Prelude.Membership.html#379" class="Field Operator">∈</a> <a id="15297" href="Types.html#15171" class="Bound">h</a><a id="15298" class="Symbol">)</a> <a id="15300" class="Symbol">→</a>
    <a id="15306" href="Types.html#5625" class="Function">IsLand</a> <a id="15313" href="Types.html#4836" class="Generalizable">c</a> <a id="15315" class="Symbol">→</a>
    <a id="15321" href="Prelude.InferenceRules.html#45114" class="Function Operator">─────────────────────────────────</a>
    <a id="15359" href="Types.html#9401" class="Generalizable">s</a> <a id="15361" href="Types.html#14590" class="Datatype Operator">↝</a> <a id="15363" href="Types.html#9401" class="Generalizable">s</a> <a id="15365" href="Types.html#11282" class="Function Operator">∘curPlayer↝</a> <a id="15377" class="Symbol">(</a> <a id="15379" href="Types.html#7637" class="Function Operator">_∙control↝</a> <a id="15390" class="Symbol">(</a><a id="15391" href="Types.html#14462" class="Function">defInstance</a> <a id="15403" href="Types.html#4836" class="Generalizable">c</a> <a id="15405" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷_</a><a id="15407" class="Symbol">)</a>
                      <a id="15431" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="15433" href="Types.html#7423" class="Function Operator">_∙hand=</a>    <a id="15444" href="Prelude.Lists.Indexed.html#792" class="Function">remove</a> <a id="15451" href="Types.html#15171" class="Bound">h</a> <a id="15453" class="Symbol">(</a><a id="15454" href="Data.List.Relation.Unary.Any.html#1817" class="Function">L.Any.index</a> <a id="15466" href="Types.html#15288" class="Bound">c∈</a><a id="15468" class="Symbol">)</a> <a id="15470" class="Symbol">)</a>
          <a id="15482" href="Types.html#9761" class="Function Operator">∙hasPlayedLand=</a> <a id="15498" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>

  <a id="_↝_.PlayCreature"></a><a id="15506" href="Types.html#15506" class="InductiveConstructor">PlayCreature</a> <a id="15519" class="Symbol">:</a> <a id="15521" class="Keyword">let</a> <a id="15525" href="Types.html#15525" class="Bound">h</a> <a id="15527" class="Symbol">=</a> <a id="15529" href="Types.html#9401" class="Generalizable">s</a> <a id="15531" href="Types.html#11592" class="Function Operator">∙curPlayer</a> <a id="15542" href="Types.html#7416" class="Function Operator">∙hand</a> <a id="15548" class="Keyword">in</a>
    <a id="15555" href="Data.Maybe.html#852" class="Function">Is-nothing</a> <a id="15566" class="Symbol">(</a><a id="15567" href="Types.html#9401" class="Generalizable">s</a> <a id="15569" href="Types.html#9818" class="Function Operator">∙outcome</a><a id="15577" class="Symbol">)</a> <a id="15579" class="Symbol">→</a>
    <a id="15585" class="Symbol">(</a><a id="15586" href="Types.html#9401" class="Generalizable">s</a> <a id="15588" href="Types.html#9618" class="Function Operator">∙curPhase</a> <a id="15598" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="15600" href="Types.html#8447" class="InductiveConstructor">main</a><a id="15604" class="Symbol">)</a> <a id="15606" class="Symbol">→</a>
    <a id="15612" class="Symbol">(</a><a id="15613" href="Types.html#15613" class="Bound">c∈</a> <a id="15616" class="Symbol">:</a> <a id="15618" href="Types.html#4836" class="Generalizable">c</a> <a id="15620" href="Prelude.Membership.html#379" class="Field Operator">∈</a> <a id="15622" href="Types.html#15525" class="Bound">h</a><a id="15623" class="Symbol">)</a> <a id="15625" class="Symbol">→</a>
    <a id="15631" href="Types.html#5632" class="Function">IsCreature</a> <a id="15642" href="Types.html#4836" class="Generalizable">c</a> <a id="15644" class="Symbol">→</a>
    <a id="15650" class="Symbol">(</a><a id="15651" href="Types.html#1325" class="Generalizable">mc</a> <a id="15654" href="Prelude.Sets.Concrete.html#1710" class="Function Operator">∈ˢ</a> <a id="15657" class="Symbol">(</a><a id="15658" href="Types.html#4836" class="Generalizable">c</a> <a id="15660" href="Types.html#4878" class="Function Operator">∙cost</a><a id="15665" class="Symbol">))</a> <a id="15668" class="Symbol">→</a>
    <a id="15674" class="Symbol">((</a><a id="15676" href="Types.html#9401" class="Generalizable">s</a> <a id="15678" href="Types.html#11592" class="Function Operator">∙curPlayer</a><a id="15688" class="Symbol">)</a> <a id="15690" href="Types.html#7671" class="Function Operator">∙manaPool</a><a id="15699" class="Symbol">)</a> <a id="15701" href="Types.html#1445" class="Function Operator">─ᵐ</a> <a id="15704" href="Types.html#1325" class="Generalizable">mc</a> <a id="15707" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="15709" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="15714" href="Types.html#1305" class="Generalizable">mp</a> <a id="15717" class="Symbol">→</a>
    <a id="15723" href="Prelude.InferenceRules.html#42306" class="Function Operator">─────────────────────────────────────────────────────────</a>
    <a id="15785" href="Types.html#9401" class="Generalizable">s</a> <a id="15787" href="Types.html#14590" class="Datatype Operator">↝</a> <a id="15789" href="Types.html#9401" class="Generalizable">s</a> <a id="15791" href="Types.html#11282" class="Function Operator">∘curPlayer↝</a> <a id="15803" class="Symbol">(</a> <a id="15805" href="Types.html#7637" class="Function Operator">_∙control↝</a>  <a id="15817" class="Symbol">(</a><a id="15818" href="Types.html#14462" class="Function">defInstance</a> <a id="15830" href="Types.html#4836" class="Generalizable">c</a> <a id="15832" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷_</a><a id="15834" class="Symbol">)</a>
                      <a id="15858" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="15860" href="Types.html#7423" class="Function Operator">_∙hand=</a>     <a id="15872" href="Prelude.Lists.Indexed.html#792" class="Function">remove</a> <a id="15879" href="Types.html#15525" class="Bound">h</a> <a id="15881" class="Symbol">(</a><a id="15882" href="Data.List.Relation.Unary.Any.html#1817" class="Function">L.Any.index</a> <a id="15894" href="Types.html#15613" class="Bound">c∈</a><a id="15896" class="Symbol">)</a>
                      <a id="15920" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="15922" href="Types.html#7682" class="Function Operator">_∙manaPool=</a> <a id="15934" href="Types.html#1305" class="Generalizable">mp</a> <a id="15937" class="Symbol">)</a>

  <a id="_↝_.TapLand"></a><a id="15942" href="Types.html#15942" class="InductiveConstructor">TapLand</a> <a id="15950" class="Symbol">:</a> <a id="15952" class="Keyword">let</a> <a id="15956" href="Types.html#15956" class="Bound">ctrl</a> <a id="15961" class="Symbol">=</a> <a id="15963" href="Types.html#9401" class="Generalizable">s</a> <a id="15965" href="Types.html#11592" class="Function Operator">∙curPlayer</a> <a id="15976" href="Types.html#7615" class="Function Operator">∙control</a> <a id="15985" class="Keyword">in</a>
    <a id="15992" href="Data.Maybe.html#852" class="Function">Is-nothing</a> <a id="16003" class="Symbol">(</a><a id="16004" href="Types.html#9401" class="Generalizable">s</a> <a id="16006" href="Types.html#9818" class="Function Operator">∙outcome</a><a id="16014" class="Symbol">)</a> <a id="16016" class="Symbol">→</a>
    <a id="16022" class="Symbol">(</a><a id="16023" href="Types.html#9401" class="Generalizable">s</a> <a id="16025" href="Types.html#9618" class="Function Operator">∙curPhase</a> <a id="16035" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="16037" href="Types.html#8447" class="InductiveConstructor">main</a><a id="16041" class="Symbol">)</a> <a id="16043" class="Symbol">→</a>
    <a id="16049" class="Symbol">(</a><a id="16050" href="Types.html#16050" class="Bound">c∈</a> <a id="16053" class="Symbol">:</a> <a id="16055" href="Types.html#6260" class="Generalizable">ci</a> <a id="16058" href="Prelude.Membership.html#379" class="Field Operator">∈</a> <a id="16060" href="Types.html#15956" class="Bound">ctrl</a><a id="16064" class="Symbol">)</a> <a id="16066" class="Symbol">→</a> <a id="16068" class="Keyword">let</a> <a id="16072" href="Types.html#16072" class="Bound">c</a> <a id="16074" class="Symbol">=</a> <a id="16076" href="Types.html#6260" class="Generalizable">ci</a> <a id="16079" href="Types.html#6111" class="Function Operator">∙card</a> <a id="16085" class="Keyword">in</a>
    <a id="16092" href="Types.html#5625" class="Function">IsLand</a> <a id="16099" href="Types.html#16072" class="Bound">c</a> <a id="16101" class="Symbol">→</a>
    <a id="16107" href="Prelude.InferenceRules.html#41253" class="Function Operator">──────────────────────────────────────────────────────────────────</a>
    <a id="16178" href="Types.html#9401" class="Generalizable">s</a> <a id="16180" href="Types.html#14590" class="Datatype Operator">↝</a> <a id="16182" href="Types.html#9401" class="Generalizable">s</a> <a id="16184" href="Types.html#11282" class="Function Operator">∘curPlayer↝</a> <a id="16196" class="Symbol">(</a> <a id="16198" href="Types.html#7625" class="Function Operator">_∙control=</a>  <a id="16210" class="Symbol">(</a><a id="16211" href="Types.html#15956" class="Bound">ctrl</a> <a id="16216" href="Data.List.Base.html#9308" class="Function Operator">[</a> <a id="16218" href="Data.List.Relation.Unary.Any.html#1817" class="Function">L.Any.index</a> <a id="16230" href="Types.html#16050" class="Bound">c∈</a> <a id="16233" href="Data.List.Base.html#9308" class="Function Operator">]%=</a> <a id="16237" href="Types.html#6283" class="Function Operator">_∙tap</a><a id="16242" class="Symbol">)</a>
                      <a id="16266" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="16268" href="Types.html#7695" class="Function Operator">_∙manaPool↝</a> <a id="16280" class="Symbol">(</a><a id="16281" href="Prelude.Semigroup.html#158" class="Field Operator">_◇</a> <a id="16284" class="Symbol">(</a><a id="16285" href="Types.html#16072" class="Bound">c</a> <a id="16287" href="Types.html#4969" class="Function Operator">∙mana</a><a id="16292" class="Symbol">))</a> <a id="16295" class="Symbol">)</a>

  <a id="_↝_.EndMain"></a><a id="16300" href="Types.html#16300" class="InductiveConstructor">EndMain</a> <a id="16308" class="Symbol">:</a>
    <a id="16314" class="Symbol">(</a><a id="16315" href="Types.html#9401" class="Generalizable">s</a> <a id="16317" href="Types.html#9618" class="Function Operator">∙curPhase</a> <a id="16327" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="16329" href="Types.html#8447" class="InductiveConstructor">main</a><a id="16333" class="Symbol">)</a> <a id="16335" class="Symbol">→</a>
    <a id="16341" href="Prelude.InferenceRules.html#46401" class="Function Operator">──────────────────────</a>
    <a id="16368" href="Types.html#9401" class="Generalizable">s</a> <a id="16370" href="Types.html#14590" class="Datatype Operator">↝</a> <a id="16372" href="Types.html#9401" class="Generalizable">s</a> <a id="16374" href="Types.html#12233" class="Function Operator">∙proceedPhase</a>

  <a id="16391" class="Comment">-- PHASE: attack</a>

  <a id="_↝_.DeclareAttackers"></a><a id="16411" href="Types.html#16411" class="InductiveConstructor">DeclareAttackers</a> <a id="16428" class="Symbol">:</a> <a id="16430" class="Symbol">∀</a> <a id="16432" class="Symbol">(</a><a id="16433" href="Types.html#16433" class="Bound">as</a> <a id="16436" class="Symbol">:</a> <a id="16438" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="16443" href="Types.html#6008" class="Record">CardInstance</a><a id="16455" class="Symbol">)</a> <a id="16457" class="Symbol">→</a>
    <a id="16463" href="Prelude.InferenceRules.html#56066" class="Function Operator">∙</a> <a id="16465" href="Types.html#9401" class="Generalizable">s</a> <a id="16467" href="Types.html#9618" class="Function Operator">∙curPhase</a> <a id="16477" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="16479" href="Types.html#8452" class="InductiveConstructor">attack</a>
    <a id="16490" href="Prelude.InferenceRules.html#56000" class="Function Operator">∙</a> <a id="16492" href="Data.Maybe.html#852" class="Function">Is-nothing</a> <a id="16503" class="Symbol">(</a><a id="16504" href="Types.html#9401" class="Generalizable">s</a> <a id="16506" href="Types.html#9875" class="Function Operator">∙attackers</a><a id="16516" class="Symbol">)</a>
    <a id="16522" href="Prelude.InferenceRules.html#56000" class="Function Operator">∙</a> <a id="16524" href="Types.html#16433" class="Bound">as</a> <a id="16527" href="Data.List.Relation.Binary.Sublist.Setoid.html#1349" class="Function Operator">⊑</a> <a id="16529" href="Types.html#9401" class="Generalizable">s</a> <a id="16531" href="Types.html#11592" class="Function Operator">∙curPlayer</a> <a id="16542" href="Types.html#7615" class="Function Operator">∙control</a>
    <a id="16555" href="Prelude.InferenceRules.html#56000" class="Function Operator">∙</a> <a id="16557" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="16561" class="Symbol">(</a><a id="16562" href="Types.html#5632" class="Function">IsCreature</a> <a id="16573" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="16575" href="Types.html#6046" class="Field">card</a><a id="16579" class="Symbol">)</a> <a id="16581" href="Types.html#16433" class="Bound">as</a>
    <a id="16588" href="Prelude.InferenceRules.html#56000" class="Function Operator">∙</a> <a id="16590" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="16594" href="Types.html#6401" class="Function">IsUntapped</a> <a id="16605" href="Types.html#16433" class="Bound">as</a>
      <a id="16614" href="Prelude.InferenceRules.html#13171" class="Function Operator">────────────────────────────────────────────</a>
      <a id="16665" href="Types.html#9401" class="Generalizable">s</a> <a id="16667" href="Types.html#14590" class="Datatype Operator">↝</a> <a id="16669" href="Types.html#9401" class="Generalizable">s</a> <a id="16671" href="Types.html#9887" class="Function Operator">∙attackers=</a> <a id="16683" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="16688" href="Types.html#16433" class="Bound">as</a>

  <a id="_↝_.DeclareBlockers"></a><a id="16694" href="Types.html#16694" class="InductiveConstructor">DeclareBlockers</a> <a id="16710" class="Symbol">:</a> <a id="16712" class="Symbol">∀</a> <a id="16714" class="Symbol">(</a><a id="16715" href="Types.html#16715" class="Bound">as</a> <a id="16718" href="Types.html#16718" class="Bound">bs</a> <a id="16721" class="Symbol">:</a> <a id="16723" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="16728" href="Types.html#6008" class="Record">CardInstance</a><a id="16740" class="Symbol">)</a> <a id="16742" class="Symbol">→</a>
    <a id="16748" href="Prelude.InferenceRules.html#56066" class="Function Operator">∙</a> <a id="16750" class="Symbol">(</a><a id="16751" href="Types.html#9401" class="Generalizable">s</a> <a id="16753" href="Types.html#9618" class="Function Operator">∙curPhase</a> <a id="16763" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="16765" href="Types.html#8452" class="InductiveConstructor">attack</a><a id="16771" class="Symbol">)</a>
    <a id="16777" href="Prelude.InferenceRules.html#56000" class="Function Operator">∙</a> <a id="16779" href="Types.html#9401" class="Generalizable">s</a> <a id="16781" href="Types.html#9875" class="Function Operator">∙attackers</a> <a id="16792" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="16794" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="16799" href="Types.html#16715" class="Bound">as</a>
    <a id="16806" href="Prelude.InferenceRules.html#56000" class="Function Operator">∙</a> <a id="16808" href="Data.Maybe.html#852" class="Function">Is-nothing</a> <a id="16819" class="Symbol">(</a><a id="16820" href="Types.html#9401" class="Generalizable">s</a> <a id="16822" href="Types.html#9937" class="Function Operator">∙blockers</a><a id="16831" class="Symbol">)</a>
    <a id="16837" href="Prelude.InferenceRules.html#56000" class="Function Operator">∙</a> <a id="16839" href="Types.html#16718" class="Bound">bs</a> <a id="16842" href="Data.List.Relation.Binary.Sublist.Setoid.html#1349" class="Function Operator">⊑</a> <a id="16844" href="Types.html#9401" class="Generalizable">s</a> <a id="16846" href="Types.html#11604" class="Function Operator">∙otherPlayer</a> <a id="16859" href="Types.html#7615" class="Function Operator">∙control</a>
    <a id="16872" href="Prelude.InferenceRules.html#56000" class="Function Operator">∙</a> <a id="16874" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="16878" class="Symbol">(</a><a id="16879" href="Types.html#5632" class="Function">IsCreature</a> <a id="16890" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="16892" href="Types.html#6046" class="Field">card</a><a id="16896" class="Symbol">)</a> <a id="16898" href="Types.html#16715" class="Bound">as</a>
    <a id="16905" href="Prelude.InferenceRules.html#56000" class="Function Operator">∙</a> <a id="16907" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="16911" href="Types.html#6401" class="Function">IsUntapped</a> <a id="16922" href="Types.html#16715" class="Bound">as</a>
    <a id="16929" href="Prelude.InferenceRules.html#56000" class="Function Operator">∙</a> <a id="16931" href="Types.html#16718" class="Bound">bs</a> <a id="16934" href="Data.List.Relation.Binary.Subset.Setoid.html#739" class="Function Operator">⊆</a> <a id="16936" href="Types.html#16715" class="Bound">as</a>
      <a id="16945" href="Prelude.InferenceRules.html#13171" class="Function Operator">────────────────────────────────────────────</a>
      <a id="16996" href="Types.html#9401" class="Generalizable">s</a> <a id="16998" href="Types.html#14590" class="Datatype Operator">↝</a> <a id="17000" href="Types.html#9401" class="Generalizable">s</a> <a id="17002" href="Types.html#9948" class="Function Operator">∙blockers=</a> <a id="17013" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="17018" href="Types.html#16718" class="Bound">bs</a>

<a id="17022" class="Comment">{-
  ToDamage : ∀ (as bs₀ bs : List CardInstance) →
    -- TODO: battle assignment has been lost in previous rule
    (bs↭ : bs ↭ bs₀)
    (as⊑ : as ⊑ s ∙curPlayer ∙control)
    (bs⊑ : bs ⊑ s ∙otherPlayer ∙control)
    (s ∙curPhase ≡ attack) →
    (s ∙attackers) ≡ just as →
    (s ∙blockers) ≡ just bs →
    -- [T0D0]
    -- ∙ calculate damage
    -- ∙ send dead creatures to graveyard

    -- TODO: switch to an event-driven architecture
    -- s ↝ s ∙effects↝ (_++ calcCombatEffects as bs...)
    --                e.g. recalculate indices/references
    let dead-cs , as′ , bs′ =
      executeCombat (s ∙curPlayer ∙control)
                    (s ∙otherPlayer ∙control)
                    as bs
    ─────────────────────────────────────
    s ↝ s ∙graveyard↝ (_◇ dead-cs)
          ∙curPlayer↝   ∙control↝
            (λ c → remove⊑ as⊑ c ++ as′)
            -- T0D0: this is not structure-preserving
          ∙otherPlayer↝ ∙control↝
            (λ c → remove⊑ bs⊑ c ++ bs′)
-}</a>

  <a id="_↝_.EndAttack"></a><a id="18009" href="Types.html#18009" class="InductiveConstructor">EndAttack</a> <a id="18019" class="Symbol">:</a>
    <a id="18025" class="Symbol">(</a><a id="18026" href="Types.html#9401" class="Generalizable">s</a> <a id="18028" href="Types.html#9618" class="Function Operator">∙curPhase</a> <a id="18038" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="18040" href="Types.html#8452" class="InductiveConstructor">attack</a><a id="18046" class="Symbol">)</a> <a id="18048" class="Symbol">→</a>
    <a id="18054" href="Prelude.InferenceRules.html#46401" class="Function Operator">──────────────────────</a>
    <a id="18081" href="Types.html#9401" class="Generalizable">s</a> <a id="18083" href="Types.html#14590" class="Datatype Operator">↝</a> <a id="18085" href="Types.html#9401" class="Generalizable">s</a> <a id="18087" href="Types.html#12233" class="Function Operator">∙proceedPhase</a>

  <a id="18104" class="Comment">-- PHASE: end</a>

  <a id="_↝_.EndTurn"></a><a id="18121" href="Types.html#18121" class="InductiveConstructor">EndTurn</a> <a id="18129" class="Symbol">:</a>
    <a id="18135" href="Prelude.InferenceRules.html#56066" class="Function Operator">∙</a> <a id="18137" href="Data.Maybe.html#852" class="Function">Is-nothing</a> <a id="18148" class="Symbol">(</a><a id="18149" href="Types.html#9401" class="Generalizable">s</a> <a id="18151" href="Types.html#9818" class="Function Operator">∙outcome</a><a id="18159" class="Symbol">)</a>
    <a id="18165" href="Prelude.InferenceRules.html#56000" class="Function Operator">∙</a> <a id="18167" class="Symbol">(</a><a id="18168" href="Types.html#9401" class="Generalizable">s</a> <a id="18170" href="Types.html#9618" class="Function Operator">∙curPhase</a> <a id="18180" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="18182" href="Types.html#8459" class="InductiveConstructor">end</a><a id="18185" class="Symbol">)</a>
      <a id="18193" href="Prelude.InferenceRules.html#13655" class="Function Operator">─────────────────────────────────</a>
      <a id="18233" href="Types.html#9401" class="Generalizable">s</a> <a id="18235" href="Types.html#14590" class="Datatype Operator">↝</a> <a id="18237" class="Symbol">(</a><a id="18238" href="Types.html#9401" class="Generalizable">s</a> <a id="18240" href="Types.html#12233" class="Function Operator">∙proceedPhase</a><a id="18253" class="Symbol">)</a> <a id="18255" href="Types.html#11839" class="Function Operator">∙proceedTurn</a>

<a id="18269" class="Keyword">open</a> <a id="18274" href="Prelude.Closures.html#8217" class="Module">ReflexiveTransitiveClosure</a> <a id="18301" href="Types.html#14590" class="Datatype Operator">_↝_</a> <a id="18305" class="Keyword">public</a>
  <a id="18314" class="Keyword">using</a> <a id="18320" class="Symbol">(</a><a id="18321" href="Prelude.Closures.html#8395" class="InductiveConstructor Operator">begin_</a><a id="18327" class="Symbol">;</a> <a id="18329" href="Prelude.Closures.html#8462" class="InductiveConstructor Operator">_∎</a><a id="18331" class="Symbol">)</a>
  <a id="18335" class="Keyword">renaming</a> <a id="18344" class="Symbol">(</a><a id="18345" href="Prelude.Closures.html#8484" class="InductiveConstructor Operator">_—→⟨_⟩_</a> <a id="18353" class="Symbol">to</a> <a id="18356" class="InductiveConstructor Operator">_↝⟨_⟩_</a><a id="18362" class="Symbol">;</a> <a id="18364" href="Prelude.Closures.html#8437" class="Datatype Operator">_—↠_</a> <a id="18369" class="Symbol">to</a> <a id="18372" class="Datatype Operator">_↝∗_</a><a id="18376" class="Symbol">)</a>

<a id="18379" class="Keyword">private</a>
  <a id="S"></a><a id="18389" href="Types.html#18389" class="Function">S</a>  <a id="18392" class="Symbol">=</a> <a id="18394" href="Prelude.Default.html#736" class="Field">def</a> <a id="18398" href="Types.html#9446" class="Function Operator">∙l↝</a> <a id="18402" class="Symbol">(</a> <a id="18404" href="Types.html#7325" class="Function Operator">_∙name=</a> <a id="18412" class="String">&quot;Orestis&quot;</a>
               <a id="18437" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="18439" href="Types.html#7374" class="Function Operator">_∙library=</a> <a id="18450" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="18452" href="Types.html#5063" class="Function">Mountain</a> <a id="18461" href="Data.List.Base.html#5025" class="Function Operator">]</a>
               <a id="18478" class="Symbol">)</a>
           <a id="18491" href="Types.html#9476" class="Function Operator">∙r↝</a> <a id="18495" class="Symbol">(</a><a id="18496" href="Types.html#7325" class="Function Operator">_∙name=</a> <a id="18504" class="String">&quot;Kokos&quot;</a>
               <a id="18527" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="18529" href="Types.html#7374" class="Function Operator">_∙library=</a> <a id="18540" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="18542" href="Types.html#5088" class="Function">Forest</a> <a id="18549" href="Data.List.Base.html#5025" class="Function Operator">]</a>
               <a id="18566" class="Symbol">)</a>
  <a id="S′"></a><a id="18570" href="Types.html#18570" class="Function">S′</a> <a id="18573" class="Symbol">=</a> <a id="18575" href="Prelude.Default.html#736" class="Field">def</a> <a id="18579" href="Types.html#9828" class="Function Operator">∙outcome=</a> <a id="18589" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="18594" href="Types.html#8512" class="InductiveConstructor">𝟚-WINS</a>
           <a id="18612" href="Types.html#9446" class="Function Operator">∙l↝</a> <a id="18616" class="Symbol">(</a> <a id="18618" href="Types.html#7325" class="Function Operator">_∙name=</a> <a id="18626" class="String">&quot;Orestis&quot;</a>
               <a id="18651" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="18653" href="Types.html#7625" class="Function Operator">_∙control=</a> <a id="18664" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="18666" href="Types.html#14462" class="Function">defInstance</a> <a id="18678" href="Types.html#5063" class="Function">Mountain</a> <a id="18687" href="Data.List.Base.html#5025" class="Function Operator">]</a>
               <a id="18704" class="Symbol">)</a>
           <a id="18717" href="Types.html#9476" class="Function Operator">∙r↝</a> <a id="18721" class="Symbol">(</a><a id="18722" href="Types.html#7325" class="Function Operator">_∙name=</a> <a id="18730" class="String">&quot;Kokos&quot;</a>
               <a id="18753" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="18755" href="Types.html#7625" class="Function Operator">_∙control=</a> <a id="18766" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="18768" href="Types.html#14462" class="Function">defInstance</a> <a id="18780" href="Types.html#5088" class="Function">Forest</a> <a id="18787" href="Data.List.Base.html#5025" class="Function Operator">]</a>
               <a id="18804" class="Symbol">)</a>

  <a id="18809" href="Types.html#18809" class="Function">_</a> <a id="18811" class="Symbol">:</a> <a id="18813" href="Types.html#18389" class="Function">S</a> <a id="18815" href="Types.html#18372" class="Datatype Operator">↝∗</a> <a id="18818" href="Types.html#18570" class="Function">S′</a>
  <a id="18823" class="Symbol">_</a> <a id="18825" class="Symbol">=</a> <a id="18827" href="Prelude.Closures.html#8395" class="InductiveConstructor Operator">begin</a>
      <a id="18839" href="Types.html#18389" class="Function">S</a>
    <a id="18845" href="Types.html#18356" class="InductiveConstructor Operator">↝⟨</a> <a id="18848" href="Types.html#14833" class="InductiveConstructor">Draw</a> <a id="18853" href="Prelude.Decidable.html#212" class="Function">auto</a> <a id="18858" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="18863" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="18868" href="Types.html#18356" class="InductiveConstructor Operator">⟩</a>
      <a id="18876" class="Symbol">(</a><a id="18877" href="Types.html#18389" class="Function">S</a> <a id="18879" href="Types.html#9446" class="Function Operator">∙l↝</a> <a id="18883" class="Symbol">(</a> <a id="18885" href="Types.html#7374" class="Function Operator">_∙library=</a> <a id="18896" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
             <a id="18912" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="18914" href="Types.html#7423" class="Function Operator">_∙hand=</a>    <a id="18925" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="18927" href="Types.html#5063" class="Function">Mountain</a> <a id="18936" href="Data.List.Base.html#5025" class="Function Operator">]</a> <a id="18938" class="Symbol">)</a>
         <a id="18949" href="Types.html#9629" class="Function Operator">∙curPhase=</a> <a id="18960" href="Types.html#8447" class="InductiveConstructor">main</a>
      <a id="18971" class="Symbol">)</a>
    <a id="18977" href="Types.html#18356" class="InductiveConstructor Operator">↝⟨</a> <a id="18980" href="Types.html#15156" class="InductiveConstructor">PlayLand</a> <a id="18989" href="Prelude.Decidable.html#212" class="Function">auto</a> <a id="18994" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="18999" href="Prelude.Decidable.html#212" class="Function">auto</a> <a id="19004" href="Prelude.Decidable.html#212" class="Function">auto</a> <a id="19009" href="Prelude.Decidable.html#212" class="Function">auto</a> <a id="19014" href="Types.html#18356" class="InductiveConstructor Operator">⟩</a>
      <a id="19022" class="Symbol">(</a><a id="19023" href="Types.html#18389" class="Function">S</a> <a id="19025" href="Types.html#9446" class="Function Operator">∙l↝</a> <a id="19029" class="Symbol">(</a> <a id="19031" href="Types.html#7374" class="Function Operator">_∙library=</a> <a id="19042" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
             <a id="19058" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="19060" href="Types.html#7625" class="Function Operator">_∙control=</a> <a id="19071" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="19073" href="Types.html#14462" class="Function">defInstance</a> <a id="19085" href="Types.html#5063" class="Function">Mountain</a> <a id="19094" href="Data.List.Base.html#5025" class="Function Operator">]</a>
             <a id="19109" class="Symbol">)</a>
         <a id="19120" href="Types.html#9629" class="Function Operator">∙curPhase=</a> <a id="19131" href="Types.html#8447" class="InductiveConstructor">main</a>
         <a id="19145" href="Types.html#9761" class="Function Operator">∙hasPlayedLand=</a> <a id="19161" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>
      <a id="19172" class="Symbol">)</a>
    <a id="19178" href="Types.html#18356" class="InductiveConstructor Operator">↝⟨</a> <a id="19181" href="Types.html#16300" class="InductiveConstructor">EndMain</a> <a id="19189" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="19194" href="Types.html#18356" class="InductiveConstructor Operator">⟩</a>
      <a id="19202" class="Symbol">_</a>
    <a id="19208" href="Types.html#18356" class="InductiveConstructor Operator">↝⟨</a> <a id="19211" href="Types.html#18009" class="InductiveConstructor">EndAttack</a> <a id="19221" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="19226" href="Types.html#18356" class="InductiveConstructor Operator">⟩</a>
      <a id="19234" class="Symbol">_</a>
    <a id="19240" href="Types.html#18356" class="InductiveConstructor Operator">↝⟨</a> <a id="19243" href="Types.html#18121" class="InductiveConstructor">EndTurn</a> <a id="19251" href="Prelude.Decidable.html#212" class="Function">auto</a> <a id="19256" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="19261" href="Types.html#18356" class="InductiveConstructor Operator">⟩</a>
      <a id="19269" class="Symbol">(</a><a id="19270" href="Types.html#18389" class="Function">S</a> <a id="19272" href="Types.html#9446" class="Function Operator">∙l↝</a> <a id="19276" class="Symbol">(</a> <a id="19278" href="Types.html#7374" class="Function Operator">_∙library=</a> <a id="19289" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
             <a id="19305" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="19307" href="Types.html#7625" class="Function Operator">_∙control=</a> <a id="19318" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="19320" href="Types.html#14462" class="Function">defInstance</a> <a id="19332" href="Types.html#5063" class="Function">Mountain</a> <a id="19341" href="Data.List.Base.html#5025" class="Function Operator">]</a> <a id="19343" class="Symbol">)</a>
         <a id="19354" href="Types.html#9513" class="Function Operator">∙curTurn=</a>  <a id="19365" href="Types.html#8396" class="InductiveConstructor">on-the-draw</a>
         <a id="19386" href="Types.html#9629" class="Function Operator">∙curPhase=</a> <a id="19397" href="Types.html#8442" class="InductiveConstructor">draw</a>
      <a id="19408" class="Symbol">)</a>
    <a id="19414" href="Types.html#18356" class="InductiveConstructor Operator">↝⟨</a> <a id="19417" href="Types.html#14833" class="InductiveConstructor">Draw</a> <a id="19422" href="Prelude.Decidable.html#212" class="Function">auto</a> <a id="19427" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="19432" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="19437" href="Types.html#18356" class="InductiveConstructor Operator">⟩</a>
      <a id="19445" class="Symbol">(</a><a id="19446" href="Types.html#18389" class="Function">S</a> <a id="19448" href="Types.html#9446" class="Function Operator">∙l↝</a> <a id="19452" class="Symbol">(</a> <a id="19454" href="Types.html#7374" class="Function Operator">_∙library=</a> <a id="19465" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
             <a id="19481" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="19483" href="Types.html#7625" class="Function Operator">_∙control=</a> <a id="19494" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="19496" href="Types.html#14462" class="Function">defInstance</a> <a id="19508" href="Types.html#5063" class="Function">Mountain</a> <a id="19517" href="Data.List.Base.html#5025" class="Function Operator">]</a> <a id="19519" class="Symbol">)</a>
         <a id="19530" href="Types.html#9476" class="Function Operator">∙r↝</a> <a id="19534" class="Symbol">(</a> <a id="19536" href="Types.html#7374" class="Function Operator">_∙library=</a> <a id="19547" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
             <a id="19563" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="19565" href="Types.html#7423" class="Function Operator">_∙hand=</a> <a id="19573" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="19575" href="Types.html#5088" class="Function">Forest</a> <a id="19582" href="Data.List.Base.html#5025" class="Function Operator">]</a> <a id="19584" class="Symbol">)</a>
         <a id="19595" href="Types.html#9513" class="Function Operator">∙curTurn=</a>  <a id="19606" href="Types.html#8396" class="InductiveConstructor">on-the-draw</a>
         <a id="19627" href="Types.html#9629" class="Function Operator">∙curPhase=</a> <a id="19638" href="Types.html#8447" class="InductiveConstructor">main</a>
      <a id="19649" class="Symbol">)</a>
    <a id="19655" href="Types.html#18356" class="InductiveConstructor Operator">↝⟨</a> <a id="19658" href="Types.html#15156" class="InductiveConstructor">PlayLand</a> <a id="19667" href="Prelude.Decidable.html#212" class="Function">auto</a> <a id="19672" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="19677" href="Prelude.Decidable.html#212" class="Function">auto</a> <a id="19682" href="Prelude.Decidable.html#212" class="Function">auto</a> <a id="19687" href="Prelude.Decidable.html#212" class="Function">auto</a> <a id="19692" href="Types.html#18356" class="InductiveConstructor Operator">⟩</a>
      <a id="19700" class="Symbol">(</a><a id="19701" href="Types.html#18389" class="Function">S</a> <a id="19703" href="Types.html#9446" class="Function Operator">∙l↝</a> <a id="19707" class="Symbol">(</a> <a id="19709" href="Types.html#7374" class="Function Operator">_∙library=</a> <a id="19720" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
             <a id="19736" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="19738" href="Types.html#7423" class="Function Operator">_∙hand=</a> <a id="19746" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
             <a id="19762" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="19764" href="Types.html#7625" class="Function Operator">_∙control=</a> <a id="19775" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="19777" href="Types.html#14462" class="Function">defInstance</a> <a id="19789" href="Types.html#5063" class="Function">Mountain</a> <a id="19798" href="Data.List.Base.html#5025" class="Function Operator">]</a> <a id="19800" class="Symbol">)</a>
         <a id="19811" href="Types.html#9476" class="Function Operator">∙r↝</a> <a id="19815" class="Symbol">(</a> <a id="19817" href="Types.html#7374" class="Function Operator">_∙library=</a> <a id="19828" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
             <a id="19844" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="19846" href="Types.html#7625" class="Function Operator">_∙control=</a> <a id="19857" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="19859" href="Types.html#14462" class="Function">defInstance</a> <a id="19871" href="Types.html#5088" class="Function">Forest</a> <a id="19878" href="Data.List.Base.html#5025" class="Function Operator">]</a> <a id="19880" class="Symbol">)</a>
         <a id="19891" href="Types.html#9513" class="Function Operator">∙curTurn=</a>  <a id="19902" href="Types.html#8396" class="InductiveConstructor">on-the-draw</a>
         <a id="19923" href="Types.html#9629" class="Function Operator">∙curPhase=</a> <a id="19934" href="Types.html#8447" class="InductiveConstructor">main</a>
         <a id="19948" href="Types.html#9761" class="Function Operator">∙hasPlayedLand=</a> <a id="19964" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>
      <a id="19975" class="Symbol">)</a>
    <a id="19981" href="Types.html#18356" class="InductiveConstructor Operator">↝⟨</a> <a id="19984" href="Types.html#15942" class="InductiveConstructor">TapLand</a> <a id="19992" href="Prelude.Decidable.html#212" class="Function">auto</a> <a id="19997" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="20002" class="Symbol">(</a><a id="20003" href="Data.List.Relation.Unary.Any.html#1219" class="InductiveConstructor">here</a> <a id="20008" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="20012" class="Symbol">)</a> <a id="20014" href="Prelude.Decidable.html#212" class="Function">auto</a> <a id="20019" href="Types.html#18356" class="InductiveConstructor Operator">⟩</a>
      <a id="20027" class="Symbol">(</a><a id="20028" href="Types.html#18389" class="Function">S</a> <a id="20030" href="Types.html#9446" class="Function Operator">∙l↝</a> <a id="20034" class="Symbol">(</a> <a id="20036" href="Types.html#7374" class="Function Operator">_∙library=</a> <a id="20047" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
             <a id="20063" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="20065" href="Types.html#7423" class="Function Operator">_∙hand=</a> <a id="20073" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
             <a id="20089" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="20091" href="Types.html#7625" class="Function Operator">_∙control=</a> <a id="20102" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="20104" href="Types.html#14462" class="Function">defInstance</a> <a id="20116" href="Types.html#5063" class="Function">Mountain</a> <a id="20125" href="Data.List.Base.html#5025" class="Function Operator">]</a> <a id="20127" class="Symbol">)</a>
         <a id="20138" href="Types.html#9476" class="Function Operator">∙r↝</a> <a id="20142" class="Symbol">(</a> <a id="20144" href="Types.html#7374" class="Function Operator">_∙library=</a> <a id="20155" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
             <a id="20171" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="20173" href="Types.html#7625" class="Function Operator">_∙control=</a> <a id="20184" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="20186" href="Types.html#14462" class="Function">defInstance</a> <a id="20198" href="Types.html#5088" class="Function">Forest</a> <a id="20205" href="Types.html#6283" class="Function Operator">∙tap</a> <a id="20210" href="Data.List.Base.html#5025" class="Function Operator">]</a>
             <a id="20225" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="20227" href="Types.html#7682" class="Function Operator">_∙manaPool=</a> <a id="20239" class="Symbol">(</a><a id="20240" href="Types.html#1034" class="InductiveConstructor">G</a> <a id="20242" href="Types.html#1507" class="Function Operator">↦</a> <a id="20244" class="Number">1</a><a id="20245" class="Symbol">)</a> <a id="20247" class="Symbol">)</a>
         <a id="20258" href="Types.html#9513" class="Function Operator">∙curTurn=</a>  <a id="20269" href="Types.html#8396" class="InductiveConstructor">on-the-draw</a>
         <a id="20290" href="Types.html#9629" class="Function Operator">∙curPhase=</a> <a id="20301" href="Types.html#8447" class="InductiveConstructor">main</a>
         <a id="20315" href="Types.html#9761" class="Function Operator">∙hasPlayedLand=</a> <a id="20331" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>
      <a id="20342" class="Symbol">)</a>
    <a id="20348" href="Types.html#18356" class="InductiveConstructor Operator">↝⟨</a> <a id="20351" href="Types.html#16300" class="InductiveConstructor">EndMain</a> <a id="20359" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="20364" href="Types.html#18356" class="InductiveConstructor Operator">⟩</a>
      <a id="20372" class="Symbol">(</a><a id="20373" href="Types.html#18389" class="Function">S</a> <a id="20375" href="Types.html#9446" class="Function Operator">∙l↝</a> <a id="20379" class="Symbol">(</a> <a id="20381" href="Types.html#7374" class="Function Operator">_∙library=</a> <a id="20392" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
             <a id="20408" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="20410" href="Types.html#7423" class="Function Operator">_∙hand=</a> <a id="20418" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
             <a id="20434" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="20436" href="Types.html#7625" class="Function Operator">_∙control=</a> <a id="20447" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="20449" href="Types.html#14462" class="Function">defInstance</a> <a id="20461" href="Types.html#5063" class="Function">Mountain</a> <a id="20470" href="Data.List.Base.html#5025" class="Function Operator">]</a> <a id="20472" class="Symbol">)</a>
         <a id="20483" href="Types.html#9476" class="Function Operator">∙r↝</a> <a id="20487" class="Symbol">(</a> <a id="20489" href="Types.html#7374" class="Function Operator">_∙library=</a> <a id="20500" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
             <a id="20516" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="20518" href="Types.html#7625" class="Function Operator">_∙control=</a> <a id="20529" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="20531" href="Types.html#14462" class="Function">defInstance</a> <a id="20543" href="Types.html#5088" class="Function">Forest</a> <a id="20550" href="Types.html#6283" class="Function Operator">∙tap</a> <a id="20555" href="Data.List.Base.html#5025" class="Function Operator">]</a>
             <a id="20570" class="Symbol">)</a>
         <a id="20581" href="Types.html#9513" class="Function Operator">∙curTurn=</a>  <a id="20592" href="Types.html#8396" class="InductiveConstructor">on-the-draw</a>
         <a id="20613" href="Types.html#9629" class="Function Operator">∙curPhase=</a> <a id="20624" href="Types.html#8452" class="InductiveConstructor">attack</a>
         <a id="20640" href="Types.html#9761" class="Function Operator">∙hasPlayedLand=</a> <a id="20656" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>
      <a id="20667" class="Symbol">)</a>
    <a id="20673" href="Types.html#18356" class="InductiveConstructor Operator">↝⟨</a> <a id="20676" href="Types.html#18009" class="InductiveConstructor">EndAttack</a> <a id="20686" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="20691" href="Types.html#18356" class="InductiveConstructor Operator">⟩</a>
      <a id="20699" class="Symbol">_</a>
    <a id="20705" href="Types.html#18356" class="InductiveConstructor Operator">↝⟨</a> <a id="20708" href="Types.html#18121" class="InductiveConstructor">EndTurn</a> <a id="20716" href="Prelude.Decidable.html#212" class="Function">auto</a> <a id="20721" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="20726" href="Types.html#18356" class="InductiveConstructor Operator">⟩</a>
      <a id="20734" class="Symbol">(</a><a id="20735" href="Types.html#18389" class="Function">S</a> <a id="20737" href="Types.html#9446" class="Function Operator">∙l↝</a> <a id="20741" class="Symbol">(</a> <a id="20743" href="Types.html#7374" class="Function Operator">_∙library=</a> <a id="20754" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
             <a id="20770" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="20772" href="Types.html#7423" class="Function Operator">_∙hand=</a> <a id="20780" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
             <a id="20796" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="20798" href="Types.html#7625" class="Function Operator">_∙control=</a> <a id="20809" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="20811" href="Types.html#14462" class="Function">defInstance</a> <a id="20823" href="Types.html#5063" class="Function">Mountain</a> <a id="20832" href="Data.List.Base.html#5025" class="Function Operator">]</a> <a id="20834" class="Symbol">)</a>
         <a id="20845" href="Types.html#9476" class="Function Operator">∙r↝</a> <a id="20849" class="Symbol">(</a> <a id="20851" href="Types.html#7374" class="Function Operator">_∙library=</a> <a id="20862" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
             <a id="20878" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="20880" href="Types.html#7625" class="Function Operator">_∙control=</a> <a id="20891" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="20893" href="Types.html#14462" class="Function">defInstance</a> <a id="20905" href="Types.html#5088" class="Function">Forest</a> <a id="20912" href="Data.List.Base.html#5025" class="Function Operator">]</a> <a id="20914" class="Symbol">)</a>
         <a id="20925" href="Types.html#9513" class="Function Operator">∙curTurn=</a>  <a id="20936" href="Types.html#8384" class="InductiveConstructor">on-the-play</a>
         <a id="20957" href="Types.html#9629" class="Function Operator">∙curPhase=</a> <a id="20968" href="Types.html#8442" class="InductiveConstructor">draw</a>
      <a id="20979" class="Symbol">)</a>
    <a id="20985" href="Types.html#18356" class="InductiveConstructor Operator">↝⟨</a> <a id="20988" href="Types.html#14638" class="InductiveConstructor">DrawLose</a> <a id="20997" href="Prelude.Decidable.html#212" class="Function">auto</a> <a id="21002" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="21007" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="21012" href="Types.html#18356" class="InductiveConstructor Operator">⟩</a>
      <a id="21020" href="Types.html#18570" class="Function">S′</a>
    <a id="21027" href="Prelude.Closures.html#8462" class="InductiveConstructor Operator">∎</a>

<a id="21030" class="Comment">{-

removeSummoningSickness : Player → Player
removeSummoningSickness p = p {control = go &lt;$&gt; p .control}
  where
    goProps : Op₁ CreatureProperties
    goProps ps = record ps {summoningSickness = false}

    go : Op₁ CardInstance
    go ci@(record {card = c; properties = ps})
      with ci .card
    ... | BasicLand _    = ci
    ... | Creature _ _ _ = ? -- record ci {properties = goProps ps}
-}</a>

<a id="21432" class="Comment">-- data DRAW⟨_↝_⟩ : Player → Maybe Player → Type where</a>

<a id="21488" class="Comment">--   drawFail :</a>

<a id="21505" class="Comment">--     p .library ≡ []</a>
<a id="21528" class="Comment">--     ───────────────────</a>
<a id="21555" class="Comment">--     DRAW⟨ p ↝ nothing ⟩</a>

<a id="21583" class="Comment">--   drawSuccess :</a>

<a id="21603" class="Comment">--     p .library ≡ c ∷ cs</a>
<a id="21630" class="Comment">--     ─────────────────────────────────────────────────────────</a>
<a id="21695" class="Comment">--     DRAW⟨ p ↝ just (p { library = cs; hand = c ∷ p .hand } ⟩</a>

<a id="21760" class="Comment">-- data MAIN⟨_↝_⟩ : Player → Maybe Player → Type where</a>

<a id="21816" class="Comment">--    curState .players ≡ p ∷ ps</a>
<a id="21849" class="Comment">--   DRAW⟨ p ↝ nothing ⟩</a>
<a id="21874" class="Comment">--   ─────────────────────────────────────────────────────────</a>
<a id="21937" class="Comment">--   FinalState</a>

<a id="21954" class="Comment">-- prepare : GameState → GameState</a>
<a id="21989" class="Comment">-- prepare st = st {players = removeSummoningSickness &lt;$&gt; st .players}</a>

<a id="22061" class="Comment">--   executeAllPhases :</a>
<a id="22085" class="Comment">--     ∙ DRAW⟨ st₀ ↝ st₁ ⟩</a>
<a id="22112" class="Comment">--     ∙ MAIN⟨ st₁ ↝ st₂ ⟩</a>
<a id="22139" class="Comment">--     ∙ ATTACK⟨ st₂ ↝ st₃ ⟩</a>
<a id="22168" class="Comment">--     -- ∙ POST⟨ st₃ ↝ st₄ ⟩</a>
<a id="22198" class="Comment">--     -- ∙ END⟨  ⟩</a>
<a id="22218" class="Comment">--       ─────────────────</a>
<a id="22245" class="Comment">--       st₀ ↝ st₄</a>

<a id="22265" class="Comment">{- ** Parsing/pretty-printing: interface to the outside world.
  instance
    Parser ManaCost : String → Maybe ManaCost
    Show ManaCost : ManaCost → String

  Input —— parse ——→ Semiring/Monoid
                          ∣
                     -—  show
                       \  ∣
                        \ ↓
                          String

  0) Input: 5W(U|B)
  1) Parse: 5*Any ◇ 1*W ◇ 1*(U|B)
  2) ... analysis ...
  3) Show: 5W(U|B)

  1) Given a cost, 5*Any ◇ 1*W ◇ 1*(U|B) ◇ 1*W
  2) ... analysis ...
  3) Show: 5W(U|B)W or Show⁺⁺: 5W(U|B)----
-}</a>
</pre></body></html>