<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Types</title><link rel="stylesheet" href="css/Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="Types.html" class="Module">Types</a> <a id="14" class="Keyword">where</a>

<a id="21" class="Keyword">open</a> <a id="26" class="Keyword">import</a> <a id="33" href="Agda.Primitive.html" class="Module">Agda.Primitive</a> <a id="48" class="Keyword">using</a> <a id="54" class="Symbol">()</a> <a id="57" class="Keyword">renaming</a> <a id="66" class="Symbol">(</a><a id="67" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="71" class="Symbol">to</a> <a id="74" class="Primitive">Type</a><a id="78" class="Symbol">)</a>
<a id="80" class="Keyword">open</a> <a id="85" class="Keyword">import</a> <a id="92" href="Prelude.Init.html" class="Module">Prelude.Init</a>
<a id="105" class="Keyword">open</a> <a id="110" class="Keyword">import</a> <a id="117" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="131" class="Keyword">open</a> <a id="136" class="Keyword">import</a> <a id="143" href="Prelude.Semigroup.html" class="Module">Prelude.Semigroup</a>
<a id="161" class="Keyword">import</a> <a id="168" href="Prelude.Maps.Concrete.html" class="Module">Prelude.Maps.Concrete</a> <a id="190" class="Symbol">as</a> <a id="193" class="Module">M</a>
<a id="195" class="Keyword">open</a> <a id="200" class="Keyword">import</a> <a id="207" href="Prelude.Maps.Concrete.html" class="Module">Prelude.Maps.Concrete</a>
<a id="229" class="Keyword">import</a> <a id="236" href="Prelude.Sets.Concrete.html" class="Module">Prelude.Sets.Concrete</a> <a id="258" class="Symbol">as</a> <a id="261" class="Module">S</a>
<a id="263" class="Keyword">open</a> <a id="268" class="Keyword">import</a> <a id="275" href="Prelude.Sets.Concrete.html" class="Module">Prelude.Sets.Concrete</a>

<a id="298" class="Keyword">data</a> <a id="Colour"></a><a id="303" href="Types.html#303" class="Datatype">Colour</a> <a id="310" class="Symbol">:</a> <a id="312" href="Types.html#74" class="Primitive">Type</a> <a id="317" class="Keyword">where</a>
  <a id="Colour.Red"></a><a id="325" href="Types.html#325" class="InductiveConstructor">Red</a> <a id="Colour.Green"></a><a id="329" href="Types.html#329" class="InductiveConstructor">Green</a> <a id="Colour.White"></a><a id="335" href="Types.html#335" class="InductiveConstructor">White</a> <a id="Colour.Blue"></a><a id="341" href="Types.html#341" class="InductiveConstructor">Blue</a> <a id="Colour.Black"></a><a id="346" href="Types.html#346" class="InductiveConstructor">Black</a> <a id="352" class="Symbol">:</a> <a id="354" href="Types.html#303" class="Datatype">Colour</a>
<a id="361" class="Keyword">unquoteDecl</a> <a id="DecEq-Colour"></a><a id="373" href="Types.html#373" class="Function">DecEq-Colour</a> <a id="386" class="Symbol">=</a> <a id="388" href="Prelude.Generics.html#9474" class="Function">DERIVE</a> <a id="395" href="Prelude.DecEq.Core.html#97" class="Record">DecEq</a> <a id="401" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="403" class="Keyword">quote</a> <a id="409" href="Types.html#303" class="Datatype">Colour</a> <a id="416" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="418" href="Types.html#373" class="Function">DecEq-Colour</a> <a id="431" href="Data.List.Base.html#5025" class="Function Operator">]</a>

<a id="434" class="Comment">-- Colour⁇ = Maybe Colour</a>

<a id="461" class="Keyword">pattern</a> <a id="colorless"></a><a id="469" href="Types.html#469" class="InductiveConstructor">colorless</a> <a id="479" class="Symbol">=</a> <a id="481" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
<a id="489" class="Keyword">pattern</a> <a id="colored"></a><a id="497" href="Types.html#497" class="InductiveConstructor">colored</a> <a id="505" href="Types.html#514" class="Bound">x</a> <a id="507" class="Symbol">=</a> <a id="509" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="514" href="Types.html#514" class="Bound">x</a>
<a id="516" class="Keyword">pattern</a> <a id="R"></a><a id="524" href="Types.html#524" class="InductiveConstructor">R</a> <a id="526" class="Symbol">=</a> <a id="528" href="Types.html#497" class="InductiveConstructor">colored</a> <a id="536" href="Types.html#325" class="InductiveConstructor">Red</a>
<a id="540" class="Keyword">pattern</a> <a id="G"></a><a id="548" href="Types.html#548" class="InductiveConstructor">G</a> <a id="550" class="Symbol">=</a> <a id="552" href="Types.html#497" class="InductiveConstructor">colored</a> <a id="560" href="Types.html#329" class="InductiveConstructor">Green</a>
<a id="566" class="Keyword">pattern</a> <a id="W"></a><a id="574" href="Types.html#574" class="InductiveConstructor">W</a> <a id="576" class="Symbol">=</a> <a id="578" href="Types.html#497" class="InductiveConstructor">colored</a> <a id="586" href="Types.html#335" class="InductiveConstructor">White</a>
<a id="592" class="Keyword">pattern</a> <a id="U"></a><a id="600" href="Types.html#600" class="InductiveConstructor">U</a> <a id="602" class="Symbol">=</a> <a id="604" href="Types.html#497" class="InductiveConstructor">colored</a> <a id="612" href="Types.html#341" class="InductiveConstructor">Blue</a>
<a id="617" class="Keyword">pattern</a> <a id="B"></a><a id="625" href="Types.html#625" class="InductiveConstructor">B</a> <a id="627" class="Symbol">=</a> <a id="629" href="Types.html#497" class="InductiveConstructor">colored</a> <a id="637" href="Types.html#346" class="InductiveConstructor">Black</a>
<a id="643" class="Keyword">pattern</a> <a id="C"></a><a id="651" href="Types.html#651" class="InductiveConstructor">C</a> <a id="653" class="Symbol">=</a> <a id="655" href="Types.html#469" class="InductiveConstructor">colorless</a>

<a id="Mana"></a><a id="666" href="Types.html#666" class="Function">Mana</a> <a id="671" class="Symbol">=</a> <a id="673" href="Prelude.Maps.Concrete.html#487" class="Record">Map⟨</a> <a id="678" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="684" href="Types.html#303" class="Datatype">Colour</a> <a id="691" href="Prelude.Maps.Concrete.html#487" class="Record">↦</a> <a id="693" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="695" href="Prelude.Maps.Concrete.html#487" class="Record">⟩</a>
<a id="ManaPool"></a><a id="697" href="Types.html#697" class="Function">ManaPool</a> <a id="706" class="Symbol">=</a> <a id="708" href="Types.html#666" class="Function">Mana</a>
<a id="ManaCost"></a><a id="713" href="Types.html#713" class="Function">ManaCost</a> <a id="722" class="Symbol">=</a> <a id="724" href="Types.html#666" class="Function">Mana</a>
<a id="CardCost"></a><a id="729" href="Types.html#729" class="Function">CardCost</a> <a id="738" class="Symbol">=</a> <a id="740" href="Prelude.Sets.Concrete.html#5928" class="Record">Set⁺⟨</a> <a id="746" href="Types.html#713" class="Function">ManaCost</a> <a id="755" href="Prelude.Sets.Concrete.html#5928" class="Record">⟩</a>
<a id="ManaCostChoices"></a><a id="757" href="Types.html#757" class="Function">ManaCostChoices</a> <a id="773" class="Symbol">=</a> <a id="775" href="Prelude.Maps.Concrete.html#487" class="Record">Map⟨</a> <a id="780" href="Prelude.Sets.Concrete.html#898" class="Record">Set⟨</a> <a id="785" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="791" href="Types.html#303" class="Datatype">Colour</a> <a id="798" href="Prelude.Sets.Concrete.html#898" class="Record">⟩</a> <a id="800" href="Prelude.Maps.Concrete.html#487" class="Record">↦</a> <a id="802" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="804" href="Prelude.Maps.Concrete.html#487" class="Record">⟩</a>
<a id="806" class="Keyword">private</a>
  <a id="816" class="Keyword">instance</a> <a id="825" href="Types.html#825" class="Function">_</a> <a id="827" class="Symbol">=</a> <a id="829" href="Prelude.Semigroup.html#2075" class="Function">Semigroup-ℕ-+</a>

  <a id="m"></a><a id="846" href="Types.html#846" class="Function">m</a> <a id="848" class="Symbol">:</a> <a id="850" href="Types.html#666" class="Function">Mana</a>
  <a id="857" href="Types.html#846" class="Function">m</a> <a id="859" class="Symbol">=</a> <a id="861" href="Prelude.Maps.Concrete.html#900" class="Function">M.singleton</a> <a id="873" class="Symbol">(</a><a id="874" href="Types.html#651" class="InductiveConstructor">C</a> <a id="876" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="878" class="Number">2</a><a id="879" class="Symbol">)</a>
    <a id="885" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="887" href="Prelude.Maps.Concrete.html#900" class="Function">M.singleton</a> <a id="899" class="Symbol">(</a><a id="900" href="Types.html#574" class="InductiveConstructor">W</a> <a id="902" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="904" class="Number">2</a><a id="905" class="Symbol">)</a>

  <a id="m′"></a><a id="910" href="Types.html#910" class="Function">m′</a> <a id="913" class="Symbol">:</a> <a id="915" href="Types.html#666" class="Function">Mana</a>
  <a id="922" href="Types.html#910" class="Function">m′</a> <a id="925" class="Symbol">=</a> <a id="927" href="Prelude.Maps.Concrete.html#900" class="Function">M.singleton</a> <a id="939" class="Symbol">(</a><a id="940" href="Types.html#651" class="InductiveConstructor">C</a> <a id="942" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="944" class="Number">4</a><a id="945" class="Symbol">)</a>
     <a id="952" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="954" href="Prelude.Maps.Concrete.html#900" class="Function">M.singleton</a> <a id="966" class="Symbol">(</a><a id="967" href="Types.html#574" class="InductiveConstructor">W</a> <a id="969" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="971" class="Number">2</a><a id="972" class="Symbol">)</a>

  <a id="977" class="Comment">-- _ : m ◇ M.singleton (C , 2) ≡ m′</a>
  <a id="1015" class="Comment">-- _ = ?</a>

  <a id="1027" href="Types.html#1027" class="Function">_</a> <a id="1029" class="Symbol">:</a> <a id="1031" href="Types.html#697" class="Function">ManaPool</a>
  <a id="1042" class="Symbol">_</a> <a id="1044" class="Symbol">=</a> <a id="1046" href="Prelude.Maps.Concrete.html#900" class="Function">M.singleton</a> <a id="1058" class="Symbol">(</a><a id="1059" href="Types.html#651" class="InductiveConstructor">C</a> <a id="1061" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1063" class="Number">2</a><a id="1064" class="Symbol">)</a>
    <a id="1070" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="1072" href="Prelude.Maps.Concrete.html#900" class="Function">M.singleton</a> <a id="1084" class="Symbol">(</a><a id="1085" href="Types.html#574" class="InductiveConstructor">W</a> <a id="1087" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1089" class="Number">2</a><a id="1090" class="Symbol">)</a>
    <a id="1096" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="1098" href="Prelude.Maps.Concrete.html#900" class="Function">M.singleton</a> <a id="1110" class="Symbol">(</a><a id="1111" href="Types.html#524" class="InductiveConstructor">R</a> <a id="1113" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1115" class="Number">1</a><a id="1116" class="Symbol">)</a>

  <a id="1121" class="Comment">-- 1BBB = ManaCost -- 1BBB</a>
  <a id="1150" class="Comment">--   ∋ singletonᵐ (C , 1) ∪ᵐ singletonᵐ (B , 3)</a>
  <a id="1200" class="Comment">-- 2WW = ManaCost -- 2WW</a>
  <a id="1227" class="Comment">--   ∋ singletonᵐ (C , 2) ∪ᵐ singletonᵐ (W , 2)</a>
  <a id="1277" class="Comment">-- 2WW/1BBB = CardCost -- 2WW/1BBB</a>
  <a id="1314" class="Comment">--   ∋ singleton 2WW ∪ singleton 1BBB</a>
  <a id="1354" class="Comment">--   , ?</a>
  <a id="1365" class="Comment">-- _ = CardCost -- 2WW(R|G)</a>
  <a id="1395" class="Comment">--   ∋ singleton (singleton (C , 2) ∪ singleton (W , 2) ∪ singleton (R , 1))</a>
  <a id="1474" class="Comment">--   ∪ singleton (singleton (C , 2) ∪ singleton (W , 2) ∪ singleton (G , 1))</a>

<a id="1552" class="Comment">-- unfold : ManaCostChoices →</a>

<a id="1583" class="Comment">-- Cost = ManaCost ⊎ SacrificeCost</a>

<a id="1619" class="Comment">-- data CardType : Type where</a>
<a id="1649" class="Comment">--   LandType CreatureType : CardType</a>

<a id="1688" class="Comment">-- data Card : Type where</a>
<a id="1714" class="Comment">--   Land : Colour → Card</a>
<a id="1740" class="Comment">--   Creature : ManaCost →  → Card</a>

<a id="1776" class="Comment">-- record Card : Type where</a>
<a id="1804" class="Comment">--   field</a>
<a id="1815" class="Comment">--     type : Set⁺⟨ CardType ⟩</a>
<a id="1846" class="Comment">--     manaCost</a>

<a id="1863" class="Comment">{- ** Parsing/pretty-printing: interface to the outside world.
  instance
    Parser ManaCost : String → Maybe ManaCost
    Show ManaCost : ManaCost → String

  -- Input —— parse ——→ Semiring/Monoid
  --                         ∣
  --                    -—  show
  --                      \  ∣
  --                       \ ↓
  --                         String

  0) Input: 5W(U|B)
  1) Parse: 5*Any ◇ 1*W ◇ 1*(U|B)
  2) ... analysis ...
  3) Show: 5W(U|B)

  1) Given a cost, 5*Any ◇ 1*W ◇ 1*(U|B) ◇ 1*W
  2) ... analysis ...
  3) Show: 5W(U|B)W or Show⁺⁺: 5W(U|B)
-}</a>
</pre></body></html>